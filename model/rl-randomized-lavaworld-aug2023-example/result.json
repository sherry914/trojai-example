{"evaluation": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28820265320448474, "mean_inference_ms": 0.9304899257404557, "mean_action_processing_ms": 0.09628574522314558, "mean_env_wait_ms": 0.2890356723550346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004135847091674805, "ViewRequirementAgentConnector_ms": 0.10935187339782715}, "clean_success_rate": 0.0, "poison_episode_reward_max": 0.9964, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.108452, "poison_episode_len_mean": 222.99, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9856, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9928, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9676, 0.9964, 0.0, 0.0, 0.0, 0.0, 0.9928, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9928, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9856, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9964, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 4, 250, 250, 250, 250, 250, 6, 250, 250, 250, 250, 250, 6, 250, 250, 250, 250, 250, 6, 250, 250, 250, 250, 250, 2, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 9, 1, 250, 250, 250, 250, 2, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 2, 250, 250, 250, 250, 250, 4, 250, 250, 250, 250, 250, 250, 1, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.28347969813136364, "mean_inference_ms": 0.9012891598750917, "mean_action_processing_ms": 0.09396095540252675, "mean_env_wait_ms": 0.30104497606590036, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004955291748046875, "ViewRequirementAgentConnector_ms": 0.11793184280395508}, "poison_success_rate": 0.11, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.34082435324788096, "cur_kl_coeff": 0.19999999999999996, "cur_lr": 0.0010000000000000002, "total_loss": 0.010122062762578328, "policy_loss": -0.025097747842470805, "vf_loss": 0.03330092486212379, "vf_explained_var": -0.34503194332122805, "kl": 0.009594417413814458, "entropy": 1.0873508207003275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 1280, "num_env_steps_trained": 1280, "num_agent_steps_sampled": 1280, "num_agent_steps_trained": 1280}, "sampler_results": {"episode_reward_max": 0.7048, "episode_reward_min": 0.0, "episode_reward_mean": 0.2789142857142857, "episode_len_mean": 78.42857142857143, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0], "episode_lengths": [107, 109, 46, 82, 2, 102, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.601248091637494, "mean_inference_ms": 1.4678103847229074, "mean_action_processing_ms": 0.16619543960588187, "mean_env_wait_ms": 0.37200875984605897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.021146592639741446, "ViewRequirementAgentConnector_ms": 0.47261260804675864}}, "episode_reward_max": 0.7048, "episode_reward_min": 0.0, "episode_reward_mean": 0.2789142857142857, "episode_len_mean": 78.42857142857143, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0], "episode_lengths": [107, 109, 46, 82, 2, 102, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.601248091637494, "mean_inference_ms": 1.4678103847229074, "mean_action_processing_ms": 0.16619543960588187, "mean_env_wait_ms": 0.37200875984605897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.021146592639741446, "ViewRequirementAgentConnector_ms": 0.47261260804675864}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280, "num_agent_steps_trained": 1280, "num_env_steps_sampled": 1280, "num_env_steps_trained": 1280, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 1280, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 1280, "timers": {"training_iteration_time_ms": 3077.053, "sample_time_ms": 411.249, "load_time_ms": 0.708, "load_throughput": 1808864.259, "learn_time_ms": 2639.082, "learn_throughput": 485.017, "synch_weights_time_ms": 25.495}, "counters": {"num_env_steps_sampled": 1280, "num_env_steps_trained": 1280, "num_agent_steps_sampled": 1280, "num_agent_steps_trained": 1280}, "done": false, "episodes_total": 7, "training_iteration": 1, "trial_id": "7d771_00000", "date": "2023-08-04_22-34-26", "timestamp": 1691202866, "time_this_iter_s": 27.613358736038208, "time_total_s": 27.613358736038208, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 27.613358736038208, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 70.63250000000001, "ram_util_percent": 19.432499999999997}}
{"evaluation": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 240.1, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 1, 250, 250, 250, 1, 250, 250, 250, 1, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 1, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28319235387885106, "mean_inference_ms": 0.8934933456110382, "mean_action_processing_ms": 0.09321353908539154, "mean_env_wait_ms": 0.30335864817102215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004190921783447266, "ViewRequirementAgentConnector_ms": 0.13001418113708496}, "clean_success_rate": 0.0, "poison_episode_reward_max": 0.9964, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.079064, "poison_episode_len_mean": 230.32, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9892, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9892, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9964, 0.0, 0.0, 0.0, 0.0, 0.9892, 0.0, 0.9676, 0.9892, 0.0, 0.0, 0.0, 0.0, 0.9928, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9928, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 3, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 3, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 1, 250, 250, 250, 250, 3, 250, 9, 3, 250, 250, 250, 250, 2, 250, 250, 250, 250, 250, 250, 250, 250, 2, 250, 250, 250, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2820553672799303, "mean_inference_ms": 0.8829716177449365, "mean_action_processing_ms": 0.09246610044569965, "mean_env_wait_ms": 0.29851788837317506, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004483699798583984, "ViewRequirementAgentConnector_ms": 0.12115359306335449}, "poison_success_rate": 0.08, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2783441096544266, "cur_kl_coeff": 0.19999999999999996, "cur_lr": 0.0010000000000000002, "total_loss": -0.03763723822931449, "policy_loss": -0.04691365722566843, "vf_loss": 0.005943186921843638, "vf_explained_var": -0.02834252913792928, "kl": 0.016666161709460236, "entropy": 1.064385227362315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "sampler_results": {"episode_reward_max": 0.7048, "episode_reward_min": 0.0, "episode_reward_mean": 0.1824705882352941, "episode_len_mean": 101.82352941176471, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5257223137059546, "mean_inference_ms": 1.3710640419877296, "mean_action_processing_ms": 0.1587852173644011, "mean_env_wait_ms": 0.39144951546832274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.01182369157379749, "ViewRequirementAgentConnector_ms": 0.2937522588991651}}, "episode_reward_max": 0.7048, "episode_reward_min": 0.0, "episode_reward_mean": 0.1824705882352941, "episode_len_mean": 101.82352941176471, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5257223137059546, "mean_inference_ms": 1.3710640419877296, "mean_action_processing_ms": 0.1587852173644011, "mean_env_wait_ms": 0.39144951546832274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.01182369157379749, "ViewRequirementAgentConnector_ms": 0.2937522588991651}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 2560, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 3092.971, "sample_time_ms": 372.67, "load_time_ms": 0.608, "load_throughput": 2105376.125, "learn_time_ms": 2696.588, "learn_throughput": 474.674, "synch_weights_time_ms": 22.532}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "done": false, "episodes_total": 17, "training_iteration": 2, "trial_id": "7d771_00000", "date": "2023-08-04_22-34-52", "timestamp": 1691202892, "time_this_iter_s": 26.414406299591064, "time_total_s": 54.02776503562927, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 54.02776503562927, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 68.8108108108108, "ram_util_percent": 18.686486486486487}}
{"evaluation": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 250.06, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28371925908493956, "mean_inference_ms": 0.8870961550136996, "mean_action_processing_ms": 0.09302364014971434, "mean_env_wait_ms": 0.3059539014129545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0042111873626708984, "ViewRequirementAgentConnector_ms": 0.12034201622009277}, "clean_success_rate": 0.0, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 250.06, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2838396987461962, "mean_inference_ms": 0.8866264399624734, "mean_action_processing_ms": 0.09305078567453266, "mean_env_wait_ms": 0.3075385613707077, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004004001617431641, "ViewRequirementAgentConnector_ms": 0.11410665512084961}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37299351453781127, "cur_kl_coeff": 0.19999999999999996, "cur_lr": 0.0010000000000000002, "total_loss": -0.04018729334076246, "policy_loss": -0.049005551487207415, "vf_loss": 0.004588308436019967, "vf_explained_var": -0.282390239238739, "kl": 0.021149734602222452, "entropy": 1.0490794849395753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 3840, "num_env_steps_trained": 3840, "num_agent_steps_sampled": 3840, "num_agent_steps_trained": 3840}, "sampler_results": {"episode_reward_max": 0.7048, "episode_reward_min": 0.0, "episode_reward_mean": 0.13245714285714286, "episode_len_mean": 115.10714285714286, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5004509390036757, "mean_inference_ms": 1.3641868262205783, "mean_action_processing_ms": 0.15304405473414087, "mean_env_wait_ms": 0.3996827909258217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00924780255272275, "ViewRequirementAgentConnector_ms": 0.2625718003227597}}, "episode_reward_max": 0.7048, "episode_reward_min": 0.0, "episode_reward_mean": 0.13245714285714286, "episode_len_mean": 115.10714285714286, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5004509390036757, "mean_inference_ms": 1.3641868262205783, "mean_action_processing_ms": 0.15304405473414087, "mean_env_wait_ms": 0.3996827909258217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00924780255272275, "ViewRequirementAgentConnector_ms": 0.2625718003227597}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840, "num_agent_steps_trained": 3840, "num_env_steps_sampled": 3840, "num_env_steps_trained": 3840, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 3840, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 3840, "timers": {"training_iteration_time_ms": 3005.864, "sample_time_ms": 376.938, "load_time_ms": 0.713, "load_throughput": 1795154.632, "learn_time_ms": 2608.142, "learn_throughput": 490.771, "synch_weights_time_ms": 19.462}, "counters": {"num_env_steps_sampled": 3840, "num_env_steps_trained": 3840, "num_agent_steps_sampled": 3840, "num_agent_steps_trained": 3840}, "done": false, "episodes_total": 28, "training_iteration": 3, "trial_id": "7d771_00000", "date": "2023-08-04_22-35-21", "timestamp": 1691202921, "time_this_iter_s": 28.41105008125305, "time_total_s": 82.43881511688232, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 82.43881511688232, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 70.28780487804879, "ram_util_percent": 19.336585365853658}}
{"evaluation": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 250.06, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2843737794172762, "mean_inference_ms": 0.8896785431128886, "mean_action_processing_ms": 0.09343562881520215, "mean_env_wait_ms": 0.3080097927515124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00400543212890625, "ViewRequirementAgentConnector_ms": 0.11263847351074219}, "clean_success_rate": 0.0, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 250.06, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.28429122281127217, "mean_inference_ms": 0.8908938152288087, "mean_action_processing_ms": 0.09376763907803742, "mean_env_wait_ms": 0.30884656270041566, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004189014434814453, "ViewRequirementAgentConnector_ms": 0.10817885398864746}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37203164597352345, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 0.0010000000000000002, "total_loss": -0.021026003472507, "policy_loss": -0.05017212857802709, "vf_loss": 0.023973143209392825, "vf_explained_var": -0.1521462082862854, "kl": 0.017243269756096802, "entropy": 1.0274120716253916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "sampler_results": {"episode_reward_max": 0.892, "episode_reward_min": 0.0, "episode_reward_mean": 0.18396842105263156, "episode_len_mean": 114.55263157894737, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48615754686984225, "mean_inference_ms": 1.3537971237256252, "mean_action_processing_ms": 0.14957408007775697, "mean_env_wait_ms": 0.398925236617645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008232133430347108, "ViewRequirementAgentConnector_ms": 0.22782003670408013}}, "episode_reward_max": 0.892, "episode_reward_min": 0.0, "episode_reward_mean": 0.18396842105263156, "episode_len_mean": 114.55263157894737, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48615754686984225, "mean_inference_ms": 1.3537971237256252, "mean_action_processing_ms": 0.14957408007775697, "mean_env_wait_ms": 0.398925236617645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008232133430347108, "ViewRequirementAgentConnector_ms": 0.22782003670408013}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 5120, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 2981.199, "sample_time_ms": 375.247, "load_time_ms": 0.704, "load_throughput": 1818206.458, "learn_time_ms": 2581.671, "learn_throughput": 495.803, "synch_weights_time_ms": 22.97}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "episodes_total": 38, "training_iteration": 4, "trial_id": "7d771_00000", "date": "2023-08-04_22-35-49", "timestamp": 1691202949, "time_this_iter_s": 27.94378089904785, "time_total_s": 110.38259601593018, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 110.38259601593018, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 69.52564102564101, "ram_util_percent": 19.399999999999995}}
{"evaluation": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 250.06, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28477013896535386, "mean_inference_ms": 0.8921424287703158, "mean_action_processing_ms": 0.0938732123886366, "mean_env_wait_ms": 0.31067595098463546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0040683746337890625, "ViewRequirementAgentConnector_ms": 0.1111609935760498}, "clean_success_rate": 0.0, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 250.06, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2843011637246802, "mean_inference_ms": 0.8893276753122069, "mean_action_processing_ms": 0.0936600890611897, "mean_env_wait_ms": 0.31037264382813684, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004136562347412109, "ViewRequirementAgentConnector_ms": 0.11017608642578125}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3833808888991674, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 0.0010000000000000002, "total_loss": -0.02934629370768865, "policy_loss": -0.053558830618858334, "vf_loss": 0.018482251114522417, "vf_explained_var": 0.2441007427374522, "kl": 0.01910096880058215, "entropy": 1.017168457110723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "sampler_results": {"episode_reward_max": 0.892, "episode_reward_min": 0.0, "episode_reward_mean": 0.21418823529411765, "episode_len_mean": 111.66666666666667, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47434696853883795, "mean_inference_ms": 1.335991422791139, "mean_action_processing_ms": 0.14459041705119527, "mean_env_wait_ms": 0.39398595213093984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.007553505741692837, "ViewRequirementAgentConnector_ms": 0.20478270412270538}}, "episode_reward_max": 0.892, "episode_reward_min": 0.0, "episode_reward_mean": 0.21418823529411765, "episode_len_mean": 111.66666666666667, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47434696853883795, "mean_inference_ms": 1.335991422791139, "mean_action_processing_ms": 0.14459041705119527, "mean_env_wait_ms": 0.39398595213093984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.007553505741692837, "ViewRequirementAgentConnector_ms": 0.20478270412270538}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 6400, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 6400, "timers": {"training_iteration_time_ms": 3011.761, "sample_time_ms": 369.211, "load_time_ms": 0.747, "load_throughput": 1713490.719, "learn_time_ms": 2616.188, "learn_throughput": 489.261, "synch_weights_time_ms": 25.007}, "counters": {"num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "done": false, "episodes_total": 51, "training_iteration": 5, "trial_id": "7d771_00000", "date": "2023-08-04_22-36-17", "timestamp": 1691202977, "time_this_iter_s": 27.89451026916504, "time_total_s": 138.27710628509521, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 138.27710628509521, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 70.425, "ram_util_percent": 19.4}}
{"evaluation": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 250.06, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847039685924598, "mean_inference_ms": 0.8903012515367935, "mean_action_processing_ms": 0.09389072503715623, "mean_env_wait_ms": 0.30965417237498694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004092216491699219, "ViewRequirementAgentConnector_ms": 0.11511921882629395}, "clean_success_rate": 0.0, "poison_episode_reward_max": 0.9892, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.078848, "poison_episode_len_mean": 230.38, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9892, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9892, 0.982, 0.0, 0.0, 0.0, 0.982, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9856, 0.0, 0.0, 0.0, 0.0, 0.982, 0.9892, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9856], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 3, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 3, 5, 250, 250, 250, 5, 250, 250, 250, 250, 250, 250, 250, 250, 4, 250, 250, 250, 250, 5, 3, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 4]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.28499273405836884, "mean_inference_ms": 0.8911419929687454, "mean_action_processing_ms": 0.09407179485749012, "mean_env_wait_ms": 0.30878858359017153, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0045168399810791016, "ViewRequirementAgentConnector_ms": 0.12007856369018555}, "poison_success_rate": 0.08, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3960614999135335, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 0.0010000000000000002, "total_loss": -0.0276321512957414, "policy_loss": -0.05622431352734566, "vf_loss": 0.022008942123502493, "vf_explained_var": 0.3411965652306875, "kl": 0.021944066199163597, "entropy": 1.0013158631324768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "sampler_results": {"episode_reward_max": 0.892, "episode_reward_min": 0.0, "episode_reward_mean": 0.21854666666666664, "episode_len_mean": 114.21666666666667, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312, 0.0, 0.0, 0.0, 0.0, 0.5571999999999999, 0.4132, 0.5751999999999999, 0.0, 0.6436], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158, 250, 64, 61, 250, 123, 163, 118, 30, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.469293472120716, "mean_inference_ms": 1.328139574524034, "mean_action_processing_ms": 0.1426365674158359, "mean_env_wait_ms": 0.392269577435076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.007221566306220161, "ViewRequirementAgentConnector_ms": 0.1958718564775255}}, "episode_reward_max": 0.892, "episode_reward_min": 0.0, "episode_reward_mean": 0.21854666666666664, "episode_len_mean": 114.21666666666667, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312, 0.0, 0.0, 0.0, 0.0, 0.5571999999999999, 0.4132, 0.5751999999999999, 0.0, 0.6436], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158, 250, 64, 61, 250, 123, 163, 118, 30, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.469293472120716, "mean_inference_ms": 1.328139574524034, "mean_action_processing_ms": 0.1426365674158359, "mean_env_wait_ms": 0.392269577435076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.007221566306220161, "ViewRequirementAgentConnector_ms": 0.1958718564775255}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 7680, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 3016.023, "sample_time_ms": 360.284, "load_time_ms": 0.766, "load_throughput": 1671366.924, "learn_time_ms": 2631.657, "learn_throughput": 486.386, "synch_weights_time_ms": 22.706}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "7d771_00000", "date": "2023-08-04_22-36-44", "timestamp": 1691203004, "time_this_iter_s": 27.748149871826172, "time_total_s": 166.0252561569214, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 166.0252561569214, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 69.11794871794872, "ram_util_percent": 19.399999999999995}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.5527120000000001, "episode_len_mean": 76.14, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0], "episode_lengths": [14, 14, 14, 18, 14, 14, 13, 250, 9, 250, 250, 13, 5, 4, 250, 13, 13, 250, 13, 250, 250, 250, 13, 13, 6, 13, 250, 13, 13, 12, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 4, 250, 13, 13, 250, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 12, 13, 9, 13, 13, 13, 13, 250, 250, 13, 3, 250, 13, 13, 250, 250, 1, 13, 13, 13, 13, 13, 13, 13, 11, 250, 13, 250, 13, 3, 250, 6, 4, 250, 250, 11, 13, 13, 13, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28555137875089226, "mean_inference_ms": 0.8919779573939728, "mean_action_processing_ms": 0.09418518379406579, "mean_env_wait_ms": 0.30892146834821477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005335569381713867, "ViewRequirementAgentConnector_ms": 0.1346874237060547}, "clean_success_rate": 0.58, "poison_episode_reward_max": 0.9964, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.07809200000000001, "poison_episode_len_mean": 90.76, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9892, 0.0, 0.0, 0.0, 0.0, 0.9964, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9604, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9892, 0.0, 0.0, 0.0, 0.0, 0.9568, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9892, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9676, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9604, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 250, 3, 13, 13, 13, 250, 1, 13, 250, 13, 13, 250, 13, 250, 250, 250, 13, 13, 11, 13, 250, 13, 13, 250, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 250, 250, 13, 250, 250, 13, 250, 13, 13, 3, 13, 250, 13, 13, 12, 250, 250, 13, 250, 13, 13, 13, 250, 13, 250, 13, 250, 13, 250, 3, 250, 13, 13, 13, 13, 9, 13, 250, 13, 13, 250, 250, 13, 13, 13, 11, 13, 13, 13, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.28608916921570343, "mean_inference_ms": 0.8924345255196873, "mean_action_processing_ms": 0.09429349557224485, "mean_env_wait_ms": 0.3091628645209554, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004851579666137695, "ViewRequirementAgentConnector_ms": 0.1512749195098877}, "poison_success_rate": 0.08, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4381942667563756, "cur_kl_coeff": 0.4500000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.029680386732021967, "policy_loss": -0.06425522093971571, "vf_loss": 0.024829301315670214, "vf_explained_var": 0.49307612458864847, "kl": 0.021656734620046338, "entropy": 0.9767182648181916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 975.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 8960, "num_agent_steps_sampled": 8960, "num_agent_steps_trained": 8960}, "sampler_results": {"episode_reward_max": 0.9279999999999999, "episode_reward_min": 0.0, "episode_reward_mean": 0.2548533333333333, "episode_len_mean": 111.16, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312, 0.0, 0.0, 0.0, 0.0, 0.5571999999999999, 0.4132, 0.5751999999999999, 0.0, 0.6436, 0.4852000000000001, 0.4132, 0.8308, 0.7083999999999999, 0.0, 0.41679999999999995, 0.0, 0.7515999999999999, 0.7228, 0.0, 0.0, 0.0, 0.7444, 0.0, 0.9279999999999999], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158, 250, 64, 61, 250, 123, 163, 118, 30, 99, 143, 163, 47, 81, 10, 162, 250, 69, 77, 141, 80, 20, 71, 150, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45954872836569594, "mean_inference_ms": 1.3104857009771576, "mean_action_processing_ms": 0.13892920390742905, "mean_env_wait_ms": 0.38751834904179483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.006938192579481338, "ViewRequirementAgentConnector_ms": 0.1842879189385308}}, "episode_reward_max": 0.9279999999999999, "episode_reward_min": 0.0, "episode_reward_mean": 0.2548533333333333, "episode_len_mean": 111.16, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312, 0.0, 0.0, 0.0, 0.0, 0.5571999999999999, 0.4132, 0.5751999999999999, 0.0, 0.6436, 0.4852000000000001, 0.4132, 0.8308, 0.7083999999999999, 0.0, 0.41679999999999995, 0.0, 0.7515999999999999, 0.7228, 0.0, 0.0, 0.0, 0.7444, 0.0, 0.9279999999999999], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158, 250, 64, 61, 250, 123, 163, 118, 30, 99, 143, 163, 47, 81, 10, 162, 250, 69, 77, 141, 80, 20, 71, 150, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45954872836569594, "mean_inference_ms": 1.3104857009771576, "mean_action_processing_ms": 0.13892920390742905, "mean_env_wait_ms": 0.38751834904179483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.006938192579481338, "ViewRequirementAgentConnector_ms": 0.1842879189385308}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8960, "num_agent_steps_trained": 8960, "num_env_steps_sampled": 8960, "num_env_steps_trained": 8960, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 8960, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 8960, "timers": {"training_iteration_time_ms": 2898.039, "sample_time_ms": 348.263, "load_time_ms": 0.78, "load_throughput": 1640660.257, "learn_time_ms": 2527.106, "learn_throughput": 506.508, "synch_weights_time_ms": 21.288}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 8960, "num_agent_steps_sampled": 8960, "num_agent_steps_trained": 8960}, "done": false, "episodes_total": 75, "training_iteration": 7, "trial_id": "7d771_00000", "date": "2023-08-04_22-36-58", "timestamp": 1691203018, "time_this_iter_s": 13.99044919013977, "time_total_s": 180.01570534706116, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 180.01570534706116, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 69.35, "ram_util_percent": 19.399999999999995}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.58138, "episode_len_mean": 83.79, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0], "episode_lengths": [14, 14, 14, 14, 16, 14, 13, 250, 13, 13, 13, 12, 13, 13, 13, 12, 13, 250, 250, 13, 13, 13, 250, 250, 250, 4, 13, 13, 13, 250, 13, 13, 250, 250, 250, 13, 13, 250, 13, 4, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 13, 13, 13, 12, 250, 13, 13, 250, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 13, 250, 12, 4, 13, 250, 13, 250, 13, 6, 250, 13, 12, 13, 13, 250, 13, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28667104043930364, "mean_inference_ms": 0.8931031937607272, "mean_action_processing_ms": 0.09432163431771827, "mean_env_wait_ms": 0.3095658225639917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049016475677490234, "ViewRequirementAgentConnector_ms": 0.14828181266784668}, "clean_success_rate": 0.61, "poison_episode_reward_max": 0.9856, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.048704, "poison_episode_len_mean": 95.72, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9856, 0.0, 0.0, 0.9856, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9568, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9856, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9568, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 251, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 4, 13, 250, 4, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 250, 250, 13, 250, 13, 250, 12, 13, 250, 13, 13, 13, 250, 13, 250, 13, 250, 250, 250, 250, 13, 250, 250, 250, 250, 250, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 4, 13, 250, 250, 13, 13, 250, 13, 13, 250, 13, 13, 250, 12, 13, 250, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.28705975264744227, "mean_inference_ms": 0.8931942859295029, "mean_action_processing_ms": 0.09433645268492931, "mean_env_wait_ms": 0.3094867884501107, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.00467371940612793, "ViewRequirementAgentConnector_ms": 0.12269997596740723}, "poison_success_rate": 0.05, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43195179949204127, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0010000000000000002, "total_loss": -0.01564090291659037, "policy_loss": -0.06047964859443406, "vf_loss": 0.03339958338687817, "vf_explained_var": 0.5103486053148906, "kl": 0.016946907409098155, "entropy": 0.9320048181215922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "sampler_results": {"episode_reward_max": 0.9388, "episode_reward_min": 0.0, "episode_reward_mean": 0.3457090909090909, "episode_len_mean": 99.8989898989899, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312, 0.0, 0.0, 0.0, 0.0, 0.5571999999999999, 0.4132, 0.5751999999999999, 0.0, 0.6436, 0.4852000000000001, 0.4132, 0.8308, 0.7083999999999999, 0.0, 0.41679999999999995, 0.0, 0.7515999999999999, 0.7228, 0.0, 0.0, 0.0, 0.7444, 0.0, 0.9279999999999999, 0.784, 0.7372000000000001, 0.9136, 0.12519999999999998, 0.8956, 0.0, 0.766, 0.8992, 0.6399999999999999, 0.6255999999999999, 0.8596, 0.9388, 0.514, 0.8308, 0.7876, 0.0, 0.8848, 0.6544, 0.9352, 0.6616, 0.0, 0.7732, 0.8848, 0.0], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158, 250, 64, 61, 250, 123, 163, 118, 30, 99, 143, 163, 47, 81, 10, 162, 250, 69, 77, 141, 80, 20, 71, 150, 20, 60, 73, 24, 243, 29, 63, 65, 28, 100, 104, 39, 17, 135, 47, 59, 43, 32, 96, 18, 94, 38, 63, 32, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4507793161343277, "mean_inference_ms": 1.2892910440304814, "mean_action_processing_ms": 0.1358871018056693, "mean_env_wait_ms": 0.38282927849385223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.006665525211629644, "ViewRequirementAgentConnector_ms": 0.17515280431368532}}, "episode_reward_max": 0.9388, "episode_reward_min": 0.0, "episode_reward_mean": 0.3457090909090909, "episode_len_mean": 99.8989898989899, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6148, 0.0, 0.0, 0.7048, 0.0, 0.6328, 0.0, 0.0, 0.0, 0.39879999999999993, 0.0, 0.0, 0.0, 0.0, 0.4959999999999999, 0.2548, 0.0, 0.0, 0.0, 0.0, 0.30879999999999996, 0.29799999999999993, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312, 0.0, 0.0, 0.0, 0.0, 0.5571999999999999, 0.4132, 0.5751999999999999, 0.0, 0.6436, 0.4852000000000001, 0.4132, 0.8308, 0.7083999999999999, 0.0, 0.41679999999999995, 0.0, 0.7515999999999999, 0.7228, 0.0, 0.0, 0.0, 0.7444, 0.0, 0.9279999999999999, 0.784, 0.7372000000000001, 0.9136, 0.12519999999999998, 0.8956, 0.0, 0.766, 0.8992, 0.6399999999999999, 0.6255999999999999, 0.8596, 0.9388, 0.514, 0.8308, 0.7876, 0.0, 0.8848, 0.6544, 0.9352, 0.6616, 0.0, 0.7732, 0.8848, 0.0], "episode_lengths": [107, 109, 46, 82, 2, 102, 101, 188, 47, 167, 181, 61, 48, 13, 140, 207, 130, 101, 37, 134, 192, 195, 198, 141, 65, 67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158, 250, 64, 61, 250, 123, 163, 118, 30, 99, 143, 163, 47, 81, 10, 162, 250, 69, 77, 141, 80, 20, 71, 150, 20, 60, 73, 24, 243, 29, 63, 65, 28, 100, 104, 39, 17, 135, 47, 59, 43, 32, 96, 18, 94, 38, 63, 32, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4507793161343277, "mean_inference_ms": 1.2892910440304814, "mean_action_processing_ms": 0.1358871018056693, "mean_env_wait_ms": 0.38282927849385223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.006665525211629644, "ViewRequirementAgentConnector_ms": 0.17515280431368532}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 10240, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 2869.017, "sample_time_ms": 340.52, "load_time_ms": 0.756, "load_throughput": 1692531.248, "learn_time_ms": 2507.181, "learn_throughput": 510.534, "synch_weights_time_ms": 19.954}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "episodes_total": 99, "training_iteration": 8, "trial_id": "7d771_00000", "date": "2023-08-04_22-37-14", "timestamp": 1691203034, "time_this_iter_s": 15.914963483810425, "time_total_s": 195.93066883087158, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 195.93066883087158, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 69.51304347826085, "ram_util_percent": 19.39999999999999}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.610048, "episode_len_mean": 86.22, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 250, 250, 250, 13, 250, 13, 13, 250, 13, 5, 12, 250, 13, 13, 13, 6, 250, 13, 13, 13, 250, 250, 13, 250, 13, 250, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 6, 250, 5, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 250, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28740469579427835, "mean_inference_ms": 0.8933667561193275, "mean_action_processing_ms": 0.09433736408283132, "mean_env_wait_ms": 0.30933199471371287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005179882049560547, "ViewRequirementAgentConnector_ms": 0.1493687629699707}, "clean_success_rate": 0.64, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.06787599999999999, "poison_episode_len_mean": 105.17, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.9568, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9604, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9568, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 6, 13, 13, 13, 13, 250, 6, 13, 250, 13, 250, 12, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 250, 13, 13, 13, 11, 13, 250, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 13, 250, 13, 250, 250, 13, 13, 250, 250, 250, 13, 250, 13, 250, 250, 13, 13, 250, 250, 250, 13, 6, 250, 250, 250, 13, 13, 250, 250, 250, 13, 250, 13, 250, 250, 13, 13, 250, 13, 13, 250, 12, 13, 250, 6, 13, 13, 13, 13, 250, 13, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.28760646573815957, "mean_inference_ms": 0.8928483530310755, "mean_action_processing_ms": 0.09427050787179728, "mean_env_wait_ms": 0.30903215583656396, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004584074020385742, "ViewRequirementAgentConnector_ms": 0.12191200256347656}, "poison_success_rate": 0.07, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4360035654902458, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0010000000000000002, "total_loss": -0.03102832326044639, "policy_loss": -0.062181314782549936, "vf_loss": 0.018763437550514937, "vf_explained_var": 0.43186232129732766, "kl": 0.018354895018662016, "entropy": 0.9098677309354146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1275.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 11520, "num_env_steps_trained": 11520, "num_agent_steps_sampled": 11520, "num_agent_steps_trained": 11520}, "sampler_results": {"episode_reward_max": 0.9388, "episode_reward_min": 0.0, "episode_reward_mean": 0.48839999999999995, "episode_len_mean": 85.26, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312, 0.0, 0.0, 0.0, 0.0, 0.5571999999999999, 0.4132, 0.5751999999999999, 0.0, 0.6436, 0.4852000000000001, 0.4132, 0.8308, 0.7083999999999999, 0.0, 0.41679999999999995, 0.0, 0.7515999999999999, 0.7228, 0.0, 0.0, 0.0, 0.7444, 0.0, 0.9279999999999999, 0.784, 0.7372000000000001, 0.9136, 0.12519999999999998, 0.8956, 0.0, 0.766, 0.8992, 0.6399999999999999, 0.6255999999999999, 0.8596, 0.9388, 0.514, 0.8308, 0.7876, 0.0, 0.8848, 0.6544, 0.9352, 0.6616, 0.0, 0.7732, 0.8848, 0.0, 0.6436, 0.9064, 0.9244, 0.6004, 0.8775999999999999, 0.748, 0.0, 0.8236, 0.9279999999999999, 0.5895999999999999, 0.82, 0.8524, 0.7336, 0.8848, 0.7696, 0.7732, 0.802, 0.6796, 0.91, 0.6724, 0.0, 0.9136, 0.7372000000000001, 0.9244, 0.0, 0.8092], "episode_lengths": [67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158, 250, 64, 61, 250, 123, 163, 118, 30, 99, 143, 163, 47, 81, 10, 162, 250, 69, 77, 141, 80, 20, 71, 150, 20, 60, 73, 24, 243, 29, 63, 65, 28, 100, 104, 39, 17, 135, 47, 59, 43, 32, 96, 18, 94, 38, 63, 32, 51, 99, 26, 21, 111, 34, 70, 3, 49, 20, 114, 50, 41, 74, 32, 64, 63, 55, 89, 25, 91, 88, 24, 73, 21, 40, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4305421902662019, "mean_inference_ms": 1.2566488530460347, "mean_action_processing_ms": 0.12833947526803846, "mean_env_wait_ms": 0.37404741650771184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005674123764038086, "ViewRequirementAgentConnector_ms": 0.1457202434539795}}, "episode_reward_max": 0.9388, "episode_reward_min": 0.0, "episode_reward_mean": 0.48839999999999995, "episode_len_mean": 85.26, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.892, 0.3808, 0.0, 0.136, 0.6472, 0.0, 0.0, 0.5644, 0.6616, 0.6255999999999999, 0.0, 0.244, 0.5751999999999999, 0.0, 0.0, 0.0, 0.0, 0.6148, 0.8668, 0.0, 0.5751999999999999, 0.4312, 0.0, 0.0, 0.0, 0.0, 0.5571999999999999, 0.4132, 0.5751999999999999, 0.0, 0.6436, 0.4852000000000001, 0.4132, 0.8308, 0.7083999999999999, 0.0, 0.41679999999999995, 0.0, 0.7515999999999999, 0.7228, 0.0, 0.0, 0.0, 0.7444, 0.0, 0.9279999999999999, 0.784, 0.7372000000000001, 0.9136, 0.12519999999999998, 0.8956, 0.0, 0.766, 0.8992, 0.6399999999999999, 0.6255999999999999, 0.8596, 0.9388, 0.514, 0.8308, 0.7876, 0.0, 0.8848, 0.6544, 0.9352, 0.6616, 0.0, 0.7732, 0.8848, 0.0, 0.6436, 0.9064, 0.9244, 0.6004, 0.8775999999999999, 0.748, 0.0, 0.8236, 0.9279999999999999, 0.5895999999999999, 0.82, 0.8524, 0.7336, 0.8848, 0.7696, 0.7732, 0.802, 0.6796, 0.91, 0.6724, 0.0, 0.9136, 0.7372000000000001, 0.9244, 0.0, 0.8092], "episode_lengths": [67, 250, 112, 49, 30, 172, 36, 240, 98, 133, 157, 121, 94, 104, 16, 210, 118, 143, 99, 93, 79, 107, 37, 60, 118, 158, 250, 64, 61, 250, 123, 163, 118, 30, 99, 143, 163, 47, 81, 10, 162, 250, 69, 77, 141, 80, 20, 71, 150, 20, 60, 73, 24, 243, 29, 63, 65, 28, 100, 104, 39, 17, 135, 47, 59, 43, 32, 96, 18, 94, 38, 63, 32, 51, 99, 26, 21, 111, 34, 70, 3, 49, 20, 114, 50, 41, 74, 32, 64, 63, 55, 89, 25, 91, 88, 24, 73, 21, 40, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4305421902662019, "mean_inference_ms": 1.2566488530460347, "mean_action_processing_ms": 0.12833947526803846, "mean_env_wait_ms": 0.37404741650771184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005674123764038086, "ViewRequirementAgentConnector_ms": 0.1457202434539795}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11520, "num_agent_steps_trained": 11520, "num_env_steps_sampled": 11520, "num_env_steps_trained": 11520, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 11520, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 11520, "timers": {"training_iteration_time_ms": 2825.41, "sample_time_ms": 338.829, "load_time_ms": 0.742, "load_throughput": 1725718.136, "learn_time_ms": 2466.377, "learn_throughput": 518.98, "synch_weights_time_ms": 18.858}, "counters": {"num_env_steps_sampled": 11520, "num_env_steps_trained": 11520, "num_agent_steps_sampled": 11520, "num_agent_steps_trained": 11520}, "done": false, "episodes_total": 125, "training_iteration": 9, "trial_id": "7d771_00000", "date": "2023-08-04_22-37-32", "timestamp": 1691203052, "time_this_iter_s": 17.97292447090149, "time_total_s": 213.90359330177307, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 213.90359330177307, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 68.48846153846154, "ram_util_percent": 19.4}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.5909840000000001, "episode_len_mean": 93.34, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0], "episode_lengths": [14, 251, 14, 14, 14, 14, 13, 250, 6, 250, 13, 13, 13, 13, 13, 13, 250, 6, 13, 13, 13, 250, 13, 13, 250, 13, 250, 250, 13, 250, 13, 13, 13, 250, 250, 13, 250, 250, 13, 250, 13, 250, 250, 250, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 4, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 6, 13, 250, 250, 13, 250, 250, 13, 13, 13, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28782736594310204, "mean_inference_ms": 0.8926858154720039, "mean_action_processing_ms": 0.0942400305298853, "mean_env_wait_ms": 0.30869098428908154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004920482635498047, "ViewRequirementAgentConnector_ms": 0.150923490524292}, "clean_success_rate": 0.62, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 114.9, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 250, 250, 250, 13, 13, 13, 250, 250, 13, 250, 250, 250, 13, 13, 6, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 250, 250, 250, 250, 250, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 250, 250, 250, 250, 250, 250, 13, 13, 13, 250, 13, 250, 250, 13, 250, 250, 13, 250, 250, 250, 13, 13, 13, 250, 250, 13, 250, 13, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.28783557258450393, "mean_inference_ms": 0.8915046780456021, "mean_action_processing_ms": 0.09415717168819249, "mean_env_wait_ms": 0.30826101113058757, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004575967788696289, "ViewRequirementAgentConnector_ms": 0.12446188926696777}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44175008734067284, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0010000000000000002, "total_loss": -0.005529805663973093, "policy_loss": -0.0487287891904513, "vf_loss": 0.03342165914985041, "vf_explained_var": 0.5132791884740193, "kl": 0.014484924964102296, "entropy": 0.882144159078598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1425.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6445440000000001, "episode_len_mean": 57.08, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.6436, 0.4852000000000001, 0.4132, 0.8308, 0.7083999999999999, 0.0, 0.41679999999999995, 0.0, 0.7515999999999999, 0.7228, 0.0, 0.0, 0.0, 0.7444, 0.0, 0.9279999999999999, 0.784, 0.7372000000000001, 0.9136, 0.12519999999999998, 0.8956, 0.0, 0.766, 0.8992, 0.6399999999999999, 0.6255999999999999, 0.8596, 0.9388, 0.514, 0.8308, 0.7876, 0.0, 0.8848, 0.6544, 0.9352, 0.6616, 0.0, 0.7732, 0.8848, 0.0, 0.6436, 0.9064, 0.9244, 0.6004, 0.8775999999999999, 0.748, 0.0, 0.8236, 0.9279999999999999, 0.5895999999999999, 0.82, 0.8524, 0.7336, 0.8848, 0.7696, 0.7732, 0.802, 0.6796, 0.91, 0.6724, 0.0, 0.9136, 0.7372000000000001, 0.9244, 0.0, 0.8092, 0.8775999999999999, 0.946, 0.8812, 0.8992, 0.9028, 0.9064, 0.7192000000000001, 0.8848, 0.0, 0.8452, 0.8992, 0.8632, 0.8128, 0.9316, 0.8775999999999999, 0.91, 0.9064, 0.9532, 0.9316, 0.0, 0.0, 0.7948, 0.856, 0.8992, 0.9388, 0.8524, 0.0, 0.7048, 0.82, 0.838, 0.82, 0.0, 0.9028], "episode_lengths": [30, 99, 143, 163, 47, 81, 10, 162, 250, 69, 77, 141, 80, 20, 71, 150, 20, 60, 73, 24, 243, 29, 63, 65, 28, 100, 104, 39, 17, 135, 47, 59, 43, 32, 96, 18, 94, 38, 63, 32, 51, 99, 26, 21, 111, 34, 70, 3, 49, 20, 114, 50, 41, 74, 32, 64, 63, 55, 89, 25, 91, 88, 24, 73, 21, 40, 53, 34, 15, 33, 28, 27, 26, 78, 32, 16, 43, 28, 38, 52, 19, 34, 25, 26, 13, 19, 22, 27, 57, 40, 28, 17, 41, 36, 82, 50, 45, 50, 4, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42449386921264237, "mean_inference_ms": 1.2322019729426765, "mean_action_processing_ms": 0.12634364641221968, "mean_env_wait_ms": 0.36843473362985063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005700349807739258, "ViewRequirementAgentConnector_ms": 0.14623713493347168}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6445440000000001, "episode_len_mean": 57.08, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0, 0.6436, 0.4852000000000001, 0.4132, 0.8308, 0.7083999999999999, 0.0, 0.41679999999999995, 0.0, 0.7515999999999999, 0.7228, 0.0, 0.0, 0.0, 0.7444, 0.0, 0.9279999999999999, 0.784, 0.7372000000000001, 0.9136, 0.12519999999999998, 0.8956, 0.0, 0.766, 0.8992, 0.6399999999999999, 0.6255999999999999, 0.8596, 0.9388, 0.514, 0.8308, 0.7876, 0.0, 0.8848, 0.6544, 0.9352, 0.6616, 0.0, 0.7732, 0.8848, 0.0, 0.6436, 0.9064, 0.9244, 0.6004, 0.8775999999999999, 0.748, 0.0, 0.8236, 0.9279999999999999, 0.5895999999999999, 0.82, 0.8524, 0.7336, 0.8848, 0.7696, 0.7732, 0.802, 0.6796, 0.91, 0.6724, 0.0, 0.9136, 0.7372000000000001, 0.9244, 0.0, 0.8092, 0.8775999999999999, 0.946, 0.8812, 0.8992, 0.9028, 0.9064, 0.7192000000000001, 0.8848, 0.0, 0.8452, 0.8992, 0.8632, 0.8128, 0.9316, 0.8775999999999999, 0.91, 0.9064, 0.9532, 0.9316, 0.0, 0.0, 0.7948, 0.856, 0.8992, 0.9388, 0.8524, 0.0, 0.7048, 0.82, 0.838, 0.82, 0.0, 0.9028], "episode_lengths": [30, 99, 143, 163, 47, 81, 10, 162, 250, 69, 77, 141, 80, 20, 71, 150, 20, 60, 73, 24, 243, 29, 63, 65, 28, 100, 104, 39, 17, 135, 47, 59, 43, 32, 96, 18, 94, 38, 63, 32, 51, 99, 26, 21, 111, 34, 70, 3, 49, 20, 114, 50, 41, 74, 32, 64, 63, 55, 89, 25, 91, 88, 24, 73, 21, 40, 53, 34, 15, 33, 28, 27, 26, 78, 32, 16, 43, 28, 38, 52, 19, 34, 25, 26, 13, 19, 22, 27, 57, 40, 28, 17, 41, 36, 82, 50, 45, 50, 4, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42449386921264237, "mean_inference_ms": 1.2322019729426765, "mean_action_processing_ms": 0.12634364641221968, "mean_env_wait_ms": 0.36843473362985063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005700349807739258, "ViewRequirementAgentConnector_ms": 0.14623713493347168}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 12800, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 2800.926, "sample_time_ms": 345.616, "load_time_ms": 0.732, "load_throughput": 1748309.6, "learn_time_ms": 2435.893, "learn_throughput": 525.475, "synch_weights_time_ms": 18.092}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 158, "training_iteration": 10, "trial_id": "7d771_00000", "date": "2023-08-04_22-37-50", "timestamp": 1691203070, "time_this_iter_s": 17.28164553642273, "time_total_s": 231.1852388381958, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 231.1852388381958, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 68.40416666666665, "ram_util_percent": 19.4}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6860879999999999, "episode_len_mean": 79.48, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.946, 0.0, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 15, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 250, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 250, 13, 15, 250, 13, 250, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 250, 13, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2881637698208056, "mean_inference_ms": 0.8917755634077058, "mean_action_processing_ms": 0.0941665635078666, "mean_env_wait_ms": 0.3083056352959978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0046536922454833984, "ViewRequirementAgentConnector_ms": 0.13547396659851074}, "clean_success_rate": 0.72, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.028919999999999998, "poison_episode_len_mean": 76.98, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9568, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9568], "episode_lengths": [14, 14, 14, 14, 14, 16, 6, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 250, 250, 250, 250, 13, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 250, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 12, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 12]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2884141819448218, "mean_inference_ms": 0.8915992905213962, "mean_action_processing_ms": 0.09416445833113127, "mean_env_wait_ms": 0.3082263484055693, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004695892333984375, "ViewRequirementAgentConnector_ms": 0.14213800430297852}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.570550868610541, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0010000000000000002, "total_loss": -0.009714201390743256, "policy_loss": -0.05720541129509608, "vf_loss": 0.03534334889923533, "vf_explained_var": 0.3159223024050395, "kl": 0.01799682979248852, "entropy": 0.8760573236147563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 14080, "num_env_steps_trained": 14080, "num_agent_steps_sampled": 14080, "num_agent_steps_trained": 14080}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7214360000000001, "episode_len_mean": 43.43, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8596, 0.9388, 0.514, 0.8308, 0.7876, 0.0, 0.8848, 0.6544, 0.9352, 0.6616, 0.0, 0.7732, 0.8848, 0.0, 0.6436, 0.9064, 0.9244, 0.6004, 0.8775999999999999, 0.748, 0.0, 0.8236, 0.9279999999999999, 0.5895999999999999, 0.82, 0.8524, 0.7336, 0.8848, 0.7696, 0.7732, 0.802, 0.6796, 0.91, 0.6724, 0.0, 0.9136, 0.7372000000000001, 0.9244, 0.0, 0.8092, 0.8775999999999999, 0.946, 0.8812, 0.8992, 0.9028, 0.9064, 0.7192000000000001, 0.8848, 0.0, 0.8452, 0.8992, 0.8632, 0.8128, 0.9316, 0.8775999999999999, 0.91, 0.9064, 0.9532, 0.9316, 0.0, 0.0, 0.7948, 0.856, 0.8992, 0.9388, 0.8524, 0.0, 0.7048, 0.82, 0.838, 0.82, 0.0, 0.9028, 0.8452, 0.8308, 0.892, 0.9388, 0.7012, 0.8848, 0.9172, 0.9064, 0.9388, 0.5211999999999999, 0.8992, 0.9316, 0.9352, 0.9316, 0.8884, 0.9316, 0.0, 0.9064, 0.7876, 0.874, 0.0, 0.9028, 0.7228, 0.9532, 0.8092, 0.0, 0.8704000000000001], "episode_lengths": [39, 17, 135, 47, 59, 43, 32, 96, 18, 94, 38, 63, 32, 51, 99, 26, 21, 111, 34, 70, 3, 49, 20, 114, 50, 41, 74, 32, 64, 63, 55, 89, 25, 91, 88, 24, 73, 21, 40, 53, 34, 15, 33, 28, 27, 26, 78, 32, 16, 43, 28, 38, 52, 19, 34, 25, 26, 13, 19, 22, 27, 57, 40, 28, 17, 41, 36, 82, 50, 45, 50, 4, 27, 43, 47, 30, 17, 83, 32, 23, 26, 17, 133, 28, 19, 18, 19, 31, 19, 49, 26, 59, 35, 52, 27, 77, 13, 53, 25, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42875977189176223, "mean_inference_ms": 1.2374698925675487, "mean_action_processing_ms": 0.12795631206068345, "mean_env_wait_ms": 0.3687954798244334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005499601364135742, "ViewRequirementAgentConnector_ms": 0.14779973030090332}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7214360000000001, "episode_len_mean": 43.43, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8596, 0.9388, 0.514, 0.8308, 0.7876, 0.0, 0.8848, 0.6544, 0.9352, 0.6616, 0.0, 0.7732, 0.8848, 0.0, 0.6436, 0.9064, 0.9244, 0.6004, 0.8775999999999999, 0.748, 0.0, 0.8236, 0.9279999999999999, 0.5895999999999999, 0.82, 0.8524, 0.7336, 0.8848, 0.7696, 0.7732, 0.802, 0.6796, 0.91, 0.6724, 0.0, 0.9136, 0.7372000000000001, 0.9244, 0.0, 0.8092, 0.8775999999999999, 0.946, 0.8812, 0.8992, 0.9028, 0.9064, 0.7192000000000001, 0.8848, 0.0, 0.8452, 0.8992, 0.8632, 0.8128, 0.9316, 0.8775999999999999, 0.91, 0.9064, 0.9532, 0.9316, 0.0, 0.0, 0.7948, 0.856, 0.8992, 0.9388, 0.8524, 0.0, 0.7048, 0.82, 0.838, 0.82, 0.0, 0.9028, 0.8452, 0.8308, 0.892, 0.9388, 0.7012, 0.8848, 0.9172, 0.9064, 0.9388, 0.5211999999999999, 0.8992, 0.9316, 0.9352, 0.9316, 0.8884, 0.9316, 0.0, 0.9064, 0.7876, 0.874, 0.0, 0.9028, 0.7228, 0.9532, 0.8092, 0.0, 0.8704000000000001], "episode_lengths": [39, 17, 135, 47, 59, 43, 32, 96, 18, 94, 38, 63, 32, 51, 99, 26, 21, 111, 34, 70, 3, 49, 20, 114, 50, 41, 74, 32, 64, 63, 55, 89, 25, 91, 88, 24, 73, 21, 40, 53, 34, 15, 33, 28, 27, 26, 78, 32, 16, 43, 28, 38, 52, 19, 34, 25, 26, 13, 19, 22, 27, 57, 40, 28, 17, 41, 36, 82, 50, 45, 50, 4, 27, 43, 47, 30, 17, 83, 32, 23, 26, 17, 133, 28, 19, 18, 19, 31, 19, 49, 26, 59, 35, 52, 27, 77, 13, 53, 25, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42875977189176223, "mean_inference_ms": 1.2374698925675487, "mean_action_processing_ms": 0.12795631206068345, "mean_env_wait_ms": 0.3687954798244334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005499601364135742, "ViewRequirementAgentConnector_ms": 0.14779973030090332}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14080, "num_agent_steps_trained": 14080, "num_env_steps_sampled": 14080, "num_env_steps_trained": 14080, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 14080, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 14080, "timers": {"training_iteration_time_ms": 2763.663, "sample_time_ms": 343.205, "load_time_ms": 0.73, "load_throughput": 1754136.156, "learn_time_ms": 2400.189, "learn_throughput": 533.291, "synch_weights_time_ms": 18.921}, "counters": {"num_env_steps_sampled": 14080, "num_env_steps_trained": 14080, "num_agent_steps_sampled": 14080, "num_agent_steps_trained": 14080}, "done": false, "episodes_total": 185, "training_iteration": 11, "trial_id": "7d771_00000", "date": "2023-08-04_22-38-07", "timestamp": 1691203087, "time_this_iter_s": 16.97128129005432, "time_total_s": 248.15652012825012, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 248.15652012825012, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 70.95, "ram_util_percent": 19.4}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.657636, "episode_len_mean": 74.35, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0], "episode_lengths": [14, 14, 14, 14, 16, 14, 250, 13, 250, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 6, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 250, 250, 13, 13, 13, 13, 13, 13, 6, 6, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 250, 13, 13, 6, 13, 13, 13, 13, 13, 13, 250, 250, 13, 6, 13, 13, 13, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28888989637778106, "mean_inference_ms": 0.8924004851196803, "mean_action_processing_ms": 0.09418133320348149, "mean_env_wait_ms": 0.30837164672270917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0050280094146728516, "ViewRequirementAgentConnector_ms": 0.14100146293640137}, "clean_success_rate": 0.69, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.048920000000000005, "poison_episode_len_mean": 114.64, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [16, 14, 14, 14, 14, 14, 6, 13, 13, 250, 250, 250, 250, 250, 13, 250, 250, 6, 13, 13, 250, 250, 13, 250, 13, 250, 250, 13, 13, 250, 13, 6, 13, 250, 250, 250, 250, 13, 250, 13, 13, 6, 13, 13, 250, 13, 13, 13, 13, 250, 250, 250, 13, 13, 6, 13, 13, 250, 13, 13, 250, 250, 13, 13, 250, 13, 13, 250, 250, 13, 250, 250, 13, 13, 250, 250, 13, 13, 250, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 250, 250, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2890173374826016, "mean_inference_ms": 0.8918955338639374, "mean_action_processing_ms": 0.09413966701421714, "mean_env_wait_ms": 0.30836643885208126, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004669904708862305, "ViewRequirementAgentConnector_ms": 0.13843464851379395}, "poison_success_rate": 0.05, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4626440930366516, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0010000000000000002, "total_loss": -0.020334976747011145, "policy_loss": -0.05936790746947129, "vf_loss": 0.028171131076912086, "vf_explained_var": 0.5825984656810761, "kl": 0.01609155115186392, "entropy": 0.8734541082382202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1725.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7068800000000002, "episode_len_mean": 40.57, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.802, 0.6796, 0.91, 0.6724, 0.0, 0.9136, 0.7372000000000001, 0.9244, 0.0, 0.8092, 0.8775999999999999, 0.946, 0.8812, 0.8992, 0.9028, 0.9064, 0.7192000000000001, 0.8848, 0.0, 0.8452, 0.8992, 0.8632, 0.8128, 0.9316, 0.8775999999999999, 0.91, 0.9064, 0.9532, 0.9316, 0.0, 0.0, 0.7948, 0.856, 0.8992, 0.9388, 0.8524, 0.0, 0.7048, 0.82, 0.838, 0.82, 0.0, 0.9028, 0.8452, 0.8308, 0.892, 0.9388, 0.7012, 0.8848, 0.9172, 0.9064, 0.9388, 0.5211999999999999, 0.8992, 0.9316, 0.9352, 0.9316, 0.8884, 0.9316, 0.0, 0.9064, 0.7876, 0.874, 0.0, 0.9028, 0.7228, 0.9532, 0.8092, 0.0, 0.8704000000000001, 0.8884, 0.9028, 0.9388, 0.0, 0.9532, 0.8236, 0.4132, 0.5895999999999999, 0.0, 0.9028, 0.0, 0.8956, 0.0, 0.9352, 0.9316, 0.8812, 0.7192000000000001, 0.82, 0.8452, 0.9028, 0.0, 0.8488, 0.8416, 0.856, 0.0, 0.9388, 0.5284, 0.9172, 0.0, 0.8704000000000001], "episode_lengths": [55, 89, 25, 91, 88, 24, 73, 21, 40, 53, 34, 15, 33, 28, 27, 26, 78, 32, 16, 43, 28, 38, 52, 19, 34, 25, 26, 13, 19, 22, 27, 57, 40, 28, 17, 41, 36, 82, 50, 45, 50, 4, 27, 43, 47, 30, 17, 83, 32, 23, 26, 17, 133, 28, 19, 18, 19, 31, 19, 49, 26, 59, 35, 52, 27, 77, 13, 53, 25, 36, 31, 27, 17, 13, 13, 49, 163, 114, 12, 27, 3, 29, 203, 18, 19, 33, 78, 50, 43, 27, 8, 42, 44, 40, 20, 17, 131, 23, 19, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4306451782912635, "mean_inference_ms": 1.250307415975476, "mean_action_processing_ms": 0.12731122617460955, "mean_env_wait_ms": 0.3712930818327685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00533747673034668, "ViewRequirementAgentConnector_ms": 0.149261474609375}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7068800000000002, "episode_len_mean": 40.57, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.802, 0.6796, 0.91, 0.6724, 0.0, 0.9136, 0.7372000000000001, 0.9244, 0.0, 0.8092, 0.8775999999999999, 0.946, 0.8812, 0.8992, 0.9028, 0.9064, 0.7192000000000001, 0.8848, 0.0, 0.8452, 0.8992, 0.8632, 0.8128, 0.9316, 0.8775999999999999, 0.91, 0.9064, 0.9532, 0.9316, 0.0, 0.0, 0.7948, 0.856, 0.8992, 0.9388, 0.8524, 0.0, 0.7048, 0.82, 0.838, 0.82, 0.0, 0.9028, 0.8452, 0.8308, 0.892, 0.9388, 0.7012, 0.8848, 0.9172, 0.9064, 0.9388, 0.5211999999999999, 0.8992, 0.9316, 0.9352, 0.9316, 0.8884, 0.9316, 0.0, 0.9064, 0.7876, 0.874, 0.0, 0.9028, 0.7228, 0.9532, 0.8092, 0.0, 0.8704000000000001, 0.8884, 0.9028, 0.9388, 0.0, 0.9532, 0.8236, 0.4132, 0.5895999999999999, 0.0, 0.9028, 0.0, 0.8956, 0.0, 0.9352, 0.9316, 0.8812, 0.7192000000000001, 0.82, 0.8452, 0.9028, 0.0, 0.8488, 0.8416, 0.856, 0.0, 0.9388, 0.5284, 0.9172, 0.0, 0.8704000000000001], "episode_lengths": [55, 89, 25, 91, 88, 24, 73, 21, 40, 53, 34, 15, 33, 28, 27, 26, 78, 32, 16, 43, 28, 38, 52, 19, 34, 25, 26, 13, 19, 22, 27, 57, 40, 28, 17, 41, 36, 82, 50, 45, 50, 4, 27, 43, 47, 30, 17, 83, 32, 23, 26, 17, 133, 28, 19, 18, 19, 31, 19, 49, 26, 59, 35, 52, 27, 77, 13, 53, 25, 36, 31, 27, 17, 13, 13, 49, 163, 114, 12, 27, 3, 29, 203, 18, 19, 33, 78, 50, 43, 27, 8, 42, 44, 40, 20, 17, 131, 23, 19, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4306451782912635, "mean_inference_ms": 1.250307415975476, "mean_action_processing_ms": 0.12731122617460955, "mean_env_wait_ms": 0.3712930818327685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00533747673034668, "ViewRequirementAgentConnector_ms": 0.149261474609375}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 15360, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 2779.694, "sample_time_ms": 344.498, "load_time_ms": 0.734, "load_throughput": 1743823.406, "learn_time_ms": 2414.341, "learn_throughput": 530.165, "synch_weights_time_ms": 19.498}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "episodes_total": 215, "training_iteration": 12, "trial_id": "7d771_00000", "date": "2023-08-04_22-38-24", "timestamp": 1691203104, "time_this_iter_s": 17.078426122665405, "time_total_s": 265.2349462509155, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 265.2349462509155, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 68.59599999999999, "ram_util_percent": 19.4}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6766999999999997, "episode_len_mean": 79.37, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 16, 14, 14, 250, 13, 250, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 6, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 250, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28924028862119877, "mean_inference_ms": 0.8919777272892773, "mean_action_processing_ms": 0.094123112335374, "mean_env_wait_ms": 0.3085195331325318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.1395118236541748}, "clean_success_rate": 0.71, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 119.71, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 250, 13, 250, 250, 250, 250, 13, 13, 250, 250, 250, 13, 250, 250, 250, 250, 250, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 250, 13, 250, 250, 250, 250, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 250, 250, 13, 13, 13, 250, 250, 13, 13, 250, 13, 250, 250, 13, 250, 13, 250, 250, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2891170004522059, "mean_inference_ms": 0.8907426239024983, "mean_action_processing_ms": 0.09403037396235084, "mean_env_wait_ms": 0.3080464162606589, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.005031585693359375, "ViewRequirementAgentConnector_ms": 0.1194162368774414}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.429892849723498, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0010000000000000002, "total_loss": -0.015388702750205993, "policy_loss": -0.055350947628418606, "vf_loss": 0.027690304511537155, "vf_explained_var": 0.631690183877945, "kl": 0.01818065203241228, "entropy": 0.8163990990320842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1875.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 16640, "num_env_steps_trained": 16640, "num_agent_steps_sampled": 16640, "num_agent_steps_trained": 16640}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.69516, "episode_len_mean": 42.46, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.7048, 0.82, 0.838, 0.82, 0.0, 0.9028, 0.8452, 0.8308, 0.892, 0.9388, 0.7012, 0.8848, 0.9172, 0.9064, 0.9388, 0.5211999999999999, 0.8992, 0.9316, 0.9352, 0.9316, 0.8884, 0.9316, 0.0, 0.9064, 0.7876, 0.874, 0.0, 0.9028, 0.7228, 0.9532, 0.8092, 0.0, 0.8704000000000001, 0.8884, 0.9028, 0.9388, 0.0, 0.9532, 0.8236, 0.4132, 0.5895999999999999, 0.0, 0.9028, 0.0, 0.8956, 0.0, 0.9352, 0.9316, 0.8812, 0.7192000000000001, 0.82, 0.8452, 0.9028, 0.0, 0.8488, 0.8416, 0.856, 0.0, 0.9388, 0.5284, 0.9172, 0.0, 0.8704000000000001, 0.0, 0.9244, 0.0, 0.7696, 0.8775999999999999, 0.9208000000000001, 0.946, 0.9064, 0.4708, 0.9028, 0.9388, 0.8632, 0.9028, 0.8848, 0.0, 0.9388, 0.0, 0.7984, 0.0, 0.8812, 0.9388, 0.9028, 0.8704000000000001, 0.9208000000000001, 0.8956, 0.9064, 0.8488, 0.0, 0.9279999999999999, 0.8956, 0.892, 0.9136, 0.9352, 0.8956, 0.8956, 0.0], "episode_lengths": [36, 82, 50, 45, 50, 4, 27, 43, 47, 30, 17, 83, 32, 23, 26, 17, 133, 28, 19, 18, 19, 31, 19, 49, 26, 59, 35, 52, 27, 77, 13, 53, 25, 36, 31, 27, 17, 13, 13, 49, 163, 114, 12, 27, 3, 29, 203, 18, 19, 33, 78, 50, 43, 27, 8, 42, 44, 40, 20, 17, 131, 23, 19, 36, 149, 21, 20, 64, 34, 22, 15, 26, 147, 27, 17, 38, 27, 32, 192, 17, 41, 56, 59, 33, 17, 27, 36, 22, 29, 26, 42, 98, 20, 29, 30, 24, 18, 29, 29, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43199160729706854, "mean_inference_ms": 1.2564094743317877, "mean_action_processing_ms": 0.12653634033955932, "mean_env_wait_ms": 0.37354664722933967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00507044792175293, "ViewRequirementAgentConnector_ms": 0.15588903427124023}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.69516, "episode_len_mean": 42.46, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0, 0.7048, 0.82, 0.838, 0.82, 0.0, 0.9028, 0.8452, 0.8308, 0.892, 0.9388, 0.7012, 0.8848, 0.9172, 0.9064, 0.9388, 0.5211999999999999, 0.8992, 0.9316, 0.9352, 0.9316, 0.8884, 0.9316, 0.0, 0.9064, 0.7876, 0.874, 0.0, 0.9028, 0.7228, 0.9532, 0.8092, 0.0, 0.8704000000000001, 0.8884, 0.9028, 0.9388, 0.0, 0.9532, 0.8236, 0.4132, 0.5895999999999999, 0.0, 0.9028, 0.0, 0.8956, 0.0, 0.9352, 0.9316, 0.8812, 0.7192000000000001, 0.82, 0.8452, 0.9028, 0.0, 0.8488, 0.8416, 0.856, 0.0, 0.9388, 0.5284, 0.9172, 0.0, 0.8704000000000001, 0.0, 0.9244, 0.0, 0.7696, 0.8775999999999999, 0.9208000000000001, 0.946, 0.9064, 0.4708, 0.9028, 0.9388, 0.8632, 0.9028, 0.8848, 0.0, 0.9388, 0.0, 0.7984, 0.0, 0.8812, 0.9388, 0.9028, 0.8704000000000001, 0.9208000000000001, 0.8956, 0.9064, 0.8488, 0.0, 0.9279999999999999, 0.8956, 0.892, 0.9136, 0.9352, 0.8956, 0.8956, 0.0], "episode_lengths": [36, 82, 50, 45, 50, 4, 27, 43, 47, 30, 17, 83, 32, 23, 26, 17, 133, 28, 19, 18, 19, 31, 19, 49, 26, 59, 35, 52, 27, 77, 13, 53, 25, 36, 31, 27, 17, 13, 13, 49, 163, 114, 12, 27, 3, 29, 203, 18, 19, 33, 78, 50, 43, 27, 8, 42, 44, 40, 20, 17, 131, 23, 19, 36, 149, 21, 20, 64, 34, 22, 15, 26, 147, 27, 17, 38, 27, 32, 192, 17, 41, 56, 59, 33, 17, 27, 36, 22, 29, 26, 42, 98, 20, 29, 30, 24, 18, 29, 29, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43199160729706854, "mean_inference_ms": 1.2564094743317877, "mean_action_processing_ms": 0.12653634033955932, "mean_env_wait_ms": 0.37354664722933967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00507044792175293, "ViewRequirementAgentConnector_ms": 0.15588903427124023}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16640, "num_agent_steps_trained": 16640, "num_env_steps_sampled": 16640, "num_env_steps_trained": 16640, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 16640, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 16640, "timers": {"training_iteration_time_ms": 2756.467, "sample_time_ms": 341.712, "load_time_ms": 0.712, "load_throughput": 1796696.603, "learn_time_ms": 2393.952, "learn_throughput": 534.681, "synch_weights_time_ms": 19.479}, "counters": {"num_env_steps_sampled": 16640, "num_env_steps_trained": 16640, "num_agent_steps_sampled": 16640, "num_agent_steps_trained": 16640}, "done": false, "episodes_total": 251, "training_iteration": 13, "trial_id": "7d771_00000", "date": "2023-08-04_22-38-40", "timestamp": 1691203120, "time_this_iter_s": 16.160825490951538, "time_total_s": 281.39577174186707, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 281.39577174186707, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 68.4391304347826, "ram_util_percent": 19.39999999999999}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6100479999999999, "episode_len_mean": 95.94, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 13, 250, 250, 250, 250, 250, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 250, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 250, 13, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28935180853748677, "mean_inference_ms": 0.8909230740876043, "mean_action_processing_ms": 0.0940038832974976, "mean_env_wait_ms": 0.3078931368479211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004598855972290039, "ViewRequirementAgentConnector_ms": 0.13619756698608398}, "clean_success_rate": 0.64, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 103.14, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 16, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 250, 13, 250, 13, 250, 250, 13, 13, 250, 250, 250, 13, 250, 250, 250, 250, 13, 250, 13, 250, 250, 250, 13, 250, 13, 250, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 250, 13, 13, 250, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2895546773015857, "mean_inference_ms": 0.8910073693524565, "mean_action_processing_ms": 0.09402139405877069, "mean_env_wait_ms": 0.30773251750419045, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004534244537353516, "ViewRequirementAgentConnector_ms": 0.13752412796020508}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47165851016839344, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0010000000000000002, "total_loss": 0.006606702158848445, "policy_loss": -0.0488933249314626, "vf_loss": 0.04521530675391356, "vf_explained_var": 0.574075280825297, "kl": 0.015236625588004244, "entropy": 0.8361853973070781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6728999999999999, "episode_len_mean": 41.83, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.874, 0.0, 0.9028, 0.7228, 0.9532, 0.8092, 0.0, 0.8704000000000001, 0.8884, 0.9028, 0.9388, 0.0, 0.9532, 0.8236, 0.4132, 0.5895999999999999, 0.0, 0.9028, 0.0, 0.8956, 0.0, 0.9352, 0.9316, 0.8812, 0.7192000000000001, 0.82, 0.8452, 0.9028, 0.0, 0.8488, 0.8416, 0.856, 0.0, 0.9388, 0.5284, 0.9172, 0.0, 0.8704000000000001, 0.0, 0.9244, 0.0, 0.7696, 0.8775999999999999, 0.9208000000000001, 0.946, 0.9064, 0.4708, 0.9028, 0.9388, 0.8632, 0.9028, 0.8848, 0.0, 0.9388, 0.0, 0.7984, 0.0, 0.8812, 0.9388, 0.9028, 0.8704000000000001, 0.9208000000000001, 0.8956, 0.9064, 0.8488, 0.0, 0.9279999999999999, 0.8956, 0.892, 0.9136, 0.9352, 0.8956, 0.8956, 0.0, 0.0, 0.9316, 0.8848, 0.91, 0.946, 0.6579999999999999, 0.0, 0.9172, 0.91, 0.8668, 0.0, 0.9136, 0.91, 0.8416, 0.0, 0.91, 0.6904, 0.8452, 0.9172, 0.0, 0.9028, 0.9316, 0.784, 0.9172, 0.8596, 0.0], "episode_lengths": [35, 52, 27, 77, 13, 53, 25, 36, 31, 27, 17, 13, 13, 49, 163, 114, 12, 27, 3, 29, 203, 18, 19, 33, 78, 50, 43, 27, 8, 42, 44, 40, 20, 17, 131, 23, 19, 36, 149, 21, 20, 64, 34, 22, 15, 26, 147, 27, 17, 38, 27, 32, 192, 17, 41, 56, 59, 33, 17, 27, 36, 22, 29, 26, 42, 98, 20, 29, 30, 24, 18, 29, 29, 53, 50, 19, 32, 25, 15, 95, 40, 23, 25, 37, 38, 24, 25, 44, 47, 25, 86, 43, 23, 57, 27, 19, 60, 23, 39, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4287602090973383, "mean_inference_ms": 1.2545545227481687, "mean_action_processing_ms": 0.12515375567864095, "mean_env_wait_ms": 0.3727233417705814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004962444305419922, "ViewRequirementAgentConnector_ms": 0.15489912033081055}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6728999999999999, "episode_len_mean": 41.83, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.874, 0.0, 0.9028, 0.7228, 0.9532, 0.8092, 0.0, 0.8704000000000001, 0.8884, 0.9028, 0.9388, 0.0, 0.9532, 0.8236, 0.4132, 0.5895999999999999, 0.0, 0.9028, 0.0, 0.8956, 0.0, 0.9352, 0.9316, 0.8812, 0.7192000000000001, 0.82, 0.8452, 0.9028, 0.0, 0.8488, 0.8416, 0.856, 0.0, 0.9388, 0.5284, 0.9172, 0.0, 0.8704000000000001, 0.0, 0.9244, 0.0, 0.7696, 0.8775999999999999, 0.9208000000000001, 0.946, 0.9064, 0.4708, 0.9028, 0.9388, 0.8632, 0.9028, 0.8848, 0.0, 0.9388, 0.0, 0.7984, 0.0, 0.8812, 0.9388, 0.9028, 0.8704000000000001, 0.9208000000000001, 0.8956, 0.9064, 0.8488, 0.0, 0.9279999999999999, 0.8956, 0.892, 0.9136, 0.9352, 0.8956, 0.8956, 0.0, 0.0, 0.9316, 0.8848, 0.91, 0.946, 0.6579999999999999, 0.0, 0.9172, 0.91, 0.8668, 0.0, 0.9136, 0.91, 0.8416, 0.0, 0.91, 0.6904, 0.8452, 0.9172, 0.0, 0.9028, 0.9316, 0.784, 0.9172, 0.8596, 0.0], "episode_lengths": [35, 52, 27, 77, 13, 53, 25, 36, 31, 27, 17, 13, 13, 49, 163, 114, 12, 27, 3, 29, 203, 18, 19, 33, 78, 50, 43, 27, 8, 42, 44, 40, 20, 17, 131, 23, 19, 36, 149, 21, 20, 64, 34, 22, 15, 26, 147, 27, 17, 38, 27, 32, 192, 17, 41, 56, 59, 33, 17, 27, 36, 22, 29, 26, 42, 98, 20, 29, 30, 24, 18, 29, 29, 53, 50, 19, 32, 25, 15, 95, 40, 23, 25, 37, 38, 24, 25, 44, 47, 25, 86, 43, 23, 57, 27, 19, 60, 23, 39, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4287602090973383, "mean_inference_ms": 1.2545545227481687, "mean_action_processing_ms": 0.12515375567864095, "mean_env_wait_ms": 0.3727233417705814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004962444305419922, "ViewRequirementAgentConnector_ms": 0.15489912033081055}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 17920, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 17920, "timers": {"training_iteration_time_ms": 2704.938, "sample_time_ms": 331.039, "load_time_ms": 0.698, "load_throughput": 1835079.683, "learn_time_ms": 2355.558, "learn_throughput": 543.396, "synch_weights_time_ms": 17.025}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "done": false, "episodes_total": 277, "training_iteration": 14, "trial_id": "7d771_00000", "date": "2023-08-04_22-38-57", "timestamp": 1691203137, "time_this_iter_s": 16.853118658065796, "time_total_s": 298.24889039993286, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 298.24889039993286, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 69.13333333333333, "ram_util_percent": 19.4}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.657708, "episode_len_mean": 86.53, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532], "episode_lengths": [14, 251, 14, 14, 14, 14, 250, 13, 250, 250, 250, 250, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 250, 13, 250, 13, 250, 250, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28981121349242256, "mean_inference_ms": 0.8915773348625653, "mean_action_processing_ms": 0.09410306462797889, "mean_env_wait_ms": 0.30773808709154654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004666328430175781, "ViewRequirementAgentConnector_ms": 0.13852214813232422}, "clean_success_rate": 0.69, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 91.27, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 251, 14, 14, 251, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 250, 13, 13, 13, 250, 250, 250, 13, 250, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2899582899887825, "mean_inference_ms": 0.8913151650836455, "mean_action_processing_ms": 0.0940961721344917, "mean_env_wait_ms": 0.3076182718187646, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004448890686035156, "ViewRequirementAgentConnector_ms": 0.12175941467285156}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46783074021339416, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0010000000000000002, "total_loss": -0.013129418790340424, "policy_loss": -0.06131634463866552, "vf_loss": 0.03214368555694819, "vf_explained_var": 0.6849288495381674, "kl": 0.02376776526032093, "entropy": 0.8230318379402161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 2175.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 19200, "num_env_steps_trained": 19200, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200}, "sampler_results": {"episode_reward_max": 0.946, "episode_reward_min": 0.0, "episode_reward_mean": 0.6703880000000001, "episode_len_mean": 44.04, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9028, 0.0, 0.8488, 0.8416, 0.856, 0.0, 0.9388, 0.5284, 0.9172, 0.0, 0.8704000000000001, 0.0, 0.9244, 0.0, 0.7696, 0.8775999999999999, 0.9208000000000001, 0.946, 0.9064, 0.4708, 0.9028, 0.9388, 0.8632, 0.9028, 0.8848, 0.0, 0.9388, 0.0, 0.7984, 0.0, 0.8812, 0.9388, 0.9028, 0.8704000000000001, 0.9208000000000001, 0.8956, 0.9064, 0.8488, 0.0, 0.9279999999999999, 0.8956, 0.892, 0.9136, 0.9352, 0.8956, 0.8956, 0.0, 0.0, 0.9316, 0.8848, 0.91, 0.946, 0.6579999999999999, 0.0, 0.9172, 0.91, 0.8668, 0.0, 0.9136, 0.91, 0.8416, 0.0, 0.91, 0.6904, 0.8452, 0.9172, 0.0, 0.9028, 0.9316, 0.784, 0.9172, 0.8596, 0.0, 0.8452, 0.8308, 0.0, 0.0, 0.9172, 0.8668, 0.9352, 0.8884, 0.8848, 0.8704000000000001, 0.874, 0.0, 0.946, 0.0, 0.9388, 0.8884, 0.3952, 0.0, 0.9244, 0.946, 0.0, 0.9316, 0.0, 0.9244, 0.8128, 0.8632, 0.838], "episode_lengths": [27, 8, 42, 44, 40, 20, 17, 131, 23, 19, 36, 149, 21, 20, 64, 34, 22, 15, 26, 147, 27, 17, 38, 27, 32, 192, 17, 41, 56, 59, 33, 17, 27, 36, 22, 29, 26, 42, 98, 20, 29, 30, 24, 18, 29, 29, 53, 50, 19, 32, 25, 15, 95, 40, 23, 25, 37, 38, 24, 25, 44, 47, 25, 86, 43, 23, 57, 27, 19, 60, 23, 39, 9, 43, 47, 22, 203, 23, 37, 18, 31, 32, 36, 35, 155, 15, 156, 17, 31, 168, 46, 21, 15, 82, 19, 73, 21, 52, 38, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42675694125530783, "mean_inference_ms": 1.2444972828880907, "mean_action_processing_ms": 0.1245962214132136, "mean_env_wait_ms": 0.3695236019815927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049877166748046875, "ViewRequirementAgentConnector_ms": 0.15953540802001953}}, "episode_reward_max": 0.946, "episode_reward_min": 0.0, "episode_reward_mean": 0.6703880000000001, "episode_len_mean": 44.04, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9028, 0.0, 0.8488, 0.8416, 0.856, 0.0, 0.9388, 0.5284, 0.9172, 0.0, 0.8704000000000001, 0.0, 0.9244, 0.0, 0.7696, 0.8775999999999999, 0.9208000000000001, 0.946, 0.9064, 0.4708, 0.9028, 0.9388, 0.8632, 0.9028, 0.8848, 0.0, 0.9388, 0.0, 0.7984, 0.0, 0.8812, 0.9388, 0.9028, 0.8704000000000001, 0.9208000000000001, 0.8956, 0.9064, 0.8488, 0.0, 0.9279999999999999, 0.8956, 0.892, 0.9136, 0.9352, 0.8956, 0.8956, 0.0, 0.0, 0.9316, 0.8848, 0.91, 0.946, 0.6579999999999999, 0.0, 0.9172, 0.91, 0.8668, 0.0, 0.9136, 0.91, 0.8416, 0.0, 0.91, 0.6904, 0.8452, 0.9172, 0.0, 0.9028, 0.9316, 0.784, 0.9172, 0.8596, 0.0, 0.8452, 0.8308, 0.0, 0.0, 0.9172, 0.8668, 0.9352, 0.8884, 0.8848, 0.8704000000000001, 0.874, 0.0, 0.946, 0.0, 0.9388, 0.8884, 0.3952, 0.0, 0.9244, 0.946, 0.0, 0.9316, 0.0, 0.9244, 0.8128, 0.8632, 0.838], "episode_lengths": [27, 8, 42, 44, 40, 20, 17, 131, 23, 19, 36, 149, 21, 20, 64, 34, 22, 15, 26, 147, 27, 17, 38, 27, 32, 192, 17, 41, 56, 59, 33, 17, 27, 36, 22, 29, 26, 42, 98, 20, 29, 30, 24, 18, 29, 29, 53, 50, 19, 32, 25, 15, 95, 40, 23, 25, 37, 38, 24, 25, 44, 47, 25, 86, 43, 23, 57, 27, 19, 60, 23, 39, 9, 43, 47, 22, 203, 23, 37, 18, 31, 32, 36, 35, 155, 15, 156, 17, 31, 168, 46, 21, 15, 82, 19, 73, 21, 52, 38, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42675694125530783, "mean_inference_ms": 1.2444972828880907, "mean_action_processing_ms": 0.1245962214132136, "mean_env_wait_ms": 0.3695236019815927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049877166748046875, "ViewRequirementAgentConnector_ms": 0.15953540802001953}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200, "num_env_steps_sampled": 19200, "num_env_steps_trained": 19200, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 19200, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 19200, "timers": {"training_iteration_time_ms": 2676.885, "sample_time_ms": 332.274, "load_time_ms": 0.675, "load_throughput": 1895128.356, "learn_time_ms": 2328.638, "learn_throughput": 549.678, "synch_weights_time_ms": 14.679}, "counters": {"num_env_steps_sampled": 19200, "num_env_steps_trained": 19200, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200}, "done": false, "episodes_total": 304, "training_iteration": 15, "trial_id": "7d771_00000", "date": "2023-08-04_22-39-14", "timestamp": 1691203154, "time_this_iter_s": 17.00211262702942, "time_total_s": 315.2510030269623, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 315.2510030269623, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 68.27499999999999, "ram_util_percent": 19.4}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6670959999999999, "episode_len_mean": 69.52, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 16, 16, 14, 14, 14, 13, 250, 13, 13, 250, 13, 250, 6, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 6, 13, 13, 250, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 5, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 250, 250, 13, 5, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 5, 13, 13, 13, 13, 13, 13, 5, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2902586405172513, "mean_inference_ms": 0.8912880884571431, "mean_action_processing_ms": 0.09412750054184267, "mean_env_wait_ms": 0.307505014596974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004991769790649414, "ViewRequirementAgentConnector_ms": 0.1582348346710205}, "clean_success_rate": 0.7, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.048920000000000005, "poison_episode_len_mean": 57.74, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 250, 13, 13, 6, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 250, 250, 6, 13, 250, 13, 13, 6, 13, 250, 13, 13, 13, 250, 13, 13, 6, 13, 13, 13, 13, 13, 13, 6, 13, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29045551439971673, "mean_inference_ms": 0.8912368517454949, "mean_action_processing_ms": 0.09413264244051493, "mean_env_wait_ms": 0.3074131620607542, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004967927932739258, "ViewRequirementAgentConnector_ms": 0.12845706939697266}, "poison_success_rate": 0.05, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5105451945463816, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.012899320212503274, "policy_loss": -0.0525983360906442, "vf_loss": 0.026538771092891694, "vf_explained_var": 0.6323285627365113, "kl": 0.012997773850947851, "entropy": 0.8165333422025045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "sampler_results": {"episode_reward_max": 0.946, "episode_reward_min": 0.0, "episode_reward_mean": 0.6756800000000002, "episode_len_mean": 41.61, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8956, 0.9064, 0.8488, 0.0, 0.9279999999999999, 0.8956, 0.892, 0.9136, 0.9352, 0.8956, 0.8956, 0.0, 0.0, 0.9316, 0.8848, 0.91, 0.946, 0.6579999999999999, 0.0, 0.9172, 0.91, 0.8668, 0.0, 0.9136, 0.91, 0.8416, 0.0, 0.91, 0.6904, 0.8452, 0.9172, 0.0, 0.9028, 0.9316, 0.784, 0.9172, 0.8596, 0.0, 0.8452, 0.8308, 0.0, 0.0, 0.9172, 0.8668, 0.9352, 0.8884, 0.8848, 0.8704000000000001, 0.874, 0.0, 0.946, 0.0, 0.9388, 0.8884, 0.3952, 0.0, 0.9244, 0.946, 0.0, 0.9316, 0.0, 0.9244, 0.8128, 0.8632, 0.838, 0.9208000000000001, 0.0, 0.8812, 0.8488, 0.0, 0.0, 0.9279999999999999, 0.892, 0.0, 0.9352, 0.9172, 0.8632, 0.9388, 0.9172, 0.7048, 0.7263999999999999, 0.0, 0.0, 0.9244, 0.9388, 0.9316, 0.9316, 0.9388, 0.91, 0.8668, 0.6148, 0.0, 0.9388, 0.7696, 0.892, 0.874, 0.0, 0.9244, 0.9244, 0.9388], "episode_lengths": [29, 26, 42, 98, 20, 29, 30, 24, 18, 29, 29, 53, 50, 19, 32, 25, 15, 95, 40, 23, 25, 37, 38, 24, 25, 44, 47, 25, 86, 43, 23, 57, 27, 19, 60, 23, 39, 9, 43, 47, 22, 203, 23, 37, 18, 31, 32, 36, 35, 155, 15, 156, 17, 31, 168, 46, 21, 15, 82, 19, 73, 21, 52, 38, 45, 22, 12, 33, 42, 9, 33, 20, 30, 10, 18, 23, 38, 17, 23, 82, 76, 250, 66, 21, 17, 19, 19, 17, 25, 37, 107, 23, 17, 64, 30, 35, 9, 21, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4264307839858627, "mean_inference_ms": 1.2350213701451165, "mean_action_processing_ms": 0.12376609082096358, "mean_env_wait_ms": 0.36796605287188117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005143880844116211, "ViewRequirementAgentConnector_ms": 0.15747690200805664}}, "episode_reward_max": 0.946, "episode_reward_min": 0.0, "episode_reward_mean": 0.6756800000000002, "episode_len_mean": 41.61, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8956, 0.9064, 0.8488, 0.0, 0.9279999999999999, 0.8956, 0.892, 0.9136, 0.9352, 0.8956, 0.8956, 0.0, 0.0, 0.9316, 0.8848, 0.91, 0.946, 0.6579999999999999, 0.0, 0.9172, 0.91, 0.8668, 0.0, 0.9136, 0.91, 0.8416, 0.0, 0.91, 0.6904, 0.8452, 0.9172, 0.0, 0.9028, 0.9316, 0.784, 0.9172, 0.8596, 0.0, 0.8452, 0.8308, 0.0, 0.0, 0.9172, 0.8668, 0.9352, 0.8884, 0.8848, 0.8704000000000001, 0.874, 0.0, 0.946, 0.0, 0.9388, 0.8884, 0.3952, 0.0, 0.9244, 0.946, 0.0, 0.9316, 0.0, 0.9244, 0.8128, 0.8632, 0.838, 0.9208000000000001, 0.0, 0.8812, 0.8488, 0.0, 0.0, 0.9279999999999999, 0.892, 0.0, 0.9352, 0.9172, 0.8632, 0.9388, 0.9172, 0.7048, 0.7263999999999999, 0.0, 0.0, 0.9244, 0.9388, 0.9316, 0.9316, 0.9388, 0.91, 0.8668, 0.6148, 0.0, 0.9388, 0.7696, 0.892, 0.874, 0.0, 0.9244, 0.9244, 0.9388], "episode_lengths": [29, 26, 42, 98, 20, 29, 30, 24, 18, 29, 29, 53, 50, 19, 32, 25, 15, 95, 40, 23, 25, 37, 38, 24, 25, 44, 47, 25, 86, 43, 23, 57, 27, 19, 60, 23, 39, 9, 43, 47, 22, 203, 23, 37, 18, 31, 32, 36, 35, 155, 15, 156, 17, 31, 168, 46, 21, 15, 82, 19, 73, 21, 52, 38, 45, 22, 12, 33, 42, 9, 33, 20, 30, 10, 18, 23, 38, 17, 23, 82, 76, 250, 66, 21, 17, 19, 19, 17, 25, 37, 107, 23, 17, 64, 30, 35, 9, 21, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4264307839858627, "mean_inference_ms": 1.2350213701451165, "mean_action_processing_ms": 0.12376609082096358, "mean_env_wait_ms": 0.36796605287188117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005143880844116211, "ViewRequirementAgentConnector_ms": 0.15747690200805664}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 20480, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 2622.733, "sample_time_ms": 334.01, "load_time_ms": 0.652, "load_throughput": 1961745.577, "learn_time_ms": 2273.291, "learn_throughput": 563.06, "synch_weights_time_ms": 14.168}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "episodes_total": 339, "training_iteration": 16, "trial_id": "7d771_00000", "date": "2023-08-04_22-39-28", "timestamp": 1691203168, "time_this_iter_s": 13.768076181411743, "time_total_s": 329.019079208374, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 329.019079208374, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 67.63000000000001, "ram_util_percent": 19.399999999999995}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6290399999999999, "episode_len_mean": 88.76, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0], "episode_lengths": [14, 14, 14, 16, 14, 14, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 13, 250, 250, 13, 250, 13, 250, 13, 13, 250, 250, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 5, 250, 5, 13, 250, 13, 250, 13, 13, 250, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29075671983400087, "mean_inference_ms": 0.8918551014134173, "mean_action_processing_ms": 0.09415883858856404, "mean_env_wait_ms": 0.30744245695504563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049016475677490234, "ViewRequirementAgentConnector_ms": 0.1396791934967041}, "clean_success_rate": 0.66, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 81.6, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784], "episode_lengths": [16, 14, 14, 14, 14, 14, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 6, 250, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 250, 250, 250, 13, 13, 250, 13, 250, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 6, 13, 13, 250, 250, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 250, 6]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2908367861855107, "mean_inference_ms": 0.8913066611169902, "mean_action_processing_ms": 0.09409200784771649, "mean_env_wait_ms": 0.30737273023903655, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004664897918701172, "ViewRequirementAgentConnector_ms": 0.14870786666870117}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40986213137706123, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.016493284323563177, "policy_loss": -0.05403467829028765, "vf_loss": 0.025003085068116587, "vf_explained_var": 0.6704178464412689, "kl": 0.012383513649692758, "entropy": 0.8206470998128256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 21760, "num_env_steps_trained": 21760, "num_agent_steps_sampled": 21760, "num_agent_steps_trained": 21760}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.702936, "episode_len_mean": 42.96, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.784, 0.9172, 0.8596, 0.0, 0.8452, 0.8308, 0.0, 0.0, 0.9172, 0.8668, 0.9352, 0.8884, 0.8848, 0.8704000000000001, 0.874, 0.0, 0.946, 0.0, 0.9388, 0.8884, 0.3952, 0.0, 0.9244, 0.946, 0.0, 0.9316, 0.0, 0.9244, 0.8128, 0.8632, 0.838, 0.9208000000000001, 0.0, 0.8812, 0.8488, 0.0, 0.0, 0.9279999999999999, 0.892, 0.0, 0.9352, 0.9172, 0.8632, 0.9388, 0.9172, 0.7048, 0.7263999999999999, 0.0, 0.0, 0.9244, 0.9388, 0.9316, 0.9316, 0.9388, 0.91, 0.8668, 0.6148, 0.0, 0.9388, 0.7696, 0.892, 0.874, 0.0, 0.9244, 0.9244, 0.9388, 0.8884, 0.9316, 0.856, 0.9064, 0.946, 0.7444, 0.91, 0.9388, 0.0, 0.8271999999999999, 0.8775999999999999, 0.9279999999999999, 0.7263999999999999, 0.0, 0.5176, 0.9244, 0.0, 0.9136, 0.7012, 0.9172, 0.4456, 0.9316, 0.8956, 0.9388, 0.9208000000000001, 0.9532, 0.9136, 0.9279999999999999, 0.9316, 0.7876, 0.8271999999999999, 0.8668, 0.9064, 0.9172], "episode_lengths": [60, 23, 39, 9, 43, 47, 22, 203, 23, 37, 18, 31, 32, 36, 35, 155, 15, 156, 17, 31, 168, 46, 21, 15, 82, 19, 73, 21, 52, 38, 45, 22, 12, 33, 42, 9, 33, 20, 30, 10, 18, 23, 38, 17, 23, 82, 76, 250, 66, 21, 17, 19, 19, 17, 25, 37, 107, 23, 17, 64, 30, 35, 9, 21, 21, 17, 31, 19, 40, 26, 15, 71, 25, 17, 91, 48, 34, 20, 76, 29, 134, 21, 44, 24, 83, 23, 154, 19, 29, 17, 22, 13, 24, 20, 19, 59, 48, 37, 26, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.425611803099478, "mean_inference_ms": 1.2235391460957117, "mean_action_processing_ms": 0.1229383674492423, "mean_env_wait_ms": 0.3655880664015276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00522613525390625, "ViewRequirementAgentConnector_ms": 0.16756701469421387}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.702936, "episode_len_mean": 42.96, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.784, 0.9172, 0.8596, 0.0, 0.8452, 0.8308, 0.0, 0.0, 0.9172, 0.8668, 0.9352, 0.8884, 0.8848, 0.8704000000000001, 0.874, 0.0, 0.946, 0.0, 0.9388, 0.8884, 0.3952, 0.0, 0.9244, 0.946, 0.0, 0.9316, 0.0, 0.9244, 0.8128, 0.8632, 0.838, 0.9208000000000001, 0.0, 0.8812, 0.8488, 0.0, 0.0, 0.9279999999999999, 0.892, 0.0, 0.9352, 0.9172, 0.8632, 0.9388, 0.9172, 0.7048, 0.7263999999999999, 0.0, 0.0, 0.9244, 0.9388, 0.9316, 0.9316, 0.9388, 0.91, 0.8668, 0.6148, 0.0, 0.9388, 0.7696, 0.892, 0.874, 0.0, 0.9244, 0.9244, 0.9388, 0.8884, 0.9316, 0.856, 0.9064, 0.946, 0.7444, 0.91, 0.9388, 0.0, 0.8271999999999999, 0.8775999999999999, 0.9279999999999999, 0.7263999999999999, 0.0, 0.5176, 0.9244, 0.0, 0.9136, 0.7012, 0.9172, 0.4456, 0.9316, 0.8956, 0.9388, 0.9208000000000001, 0.9532, 0.9136, 0.9279999999999999, 0.9316, 0.7876, 0.8271999999999999, 0.8668, 0.9064, 0.9172], "episode_lengths": [60, 23, 39, 9, 43, 47, 22, 203, 23, 37, 18, 31, 32, 36, 35, 155, 15, 156, 17, 31, 168, 46, 21, 15, 82, 19, 73, 21, 52, 38, 45, 22, 12, 33, 42, 9, 33, 20, 30, 10, 18, 23, 38, 17, 23, 82, 76, 250, 66, 21, 17, 19, 19, 17, 25, 37, 107, 23, 17, 64, 30, 35, 9, 21, 21, 17, 31, 19, 40, 26, 15, 71, 25, 17, 91, 48, 34, 20, 76, 29, 134, 21, 44, 24, 83, 23, 154, 19, 29, 17, 22, 13, 24, 20, 19, 59, 48, 37, 26, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.425611803099478, "mean_inference_ms": 1.2235391460957117, "mean_action_processing_ms": 0.1229383674492423, "mean_env_wait_ms": 0.3655880664015276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00522613525390625, "ViewRequirementAgentConnector_ms": 0.16756701469421387}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21760, "num_agent_steps_trained": 21760, "num_env_steps_sampled": 21760, "num_env_steps_trained": 21760, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 21760, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 21760, "timers": {"training_iteration_time_ms": 2702.067, "sample_time_ms": 340.483, "load_time_ms": 0.638, "load_throughput": 2005120.12, "learn_time_ms": 2346.727, "learn_throughput": 545.441, "synch_weights_time_ms": 13.587}, "counters": {"num_env_steps_sampled": 21760, "num_env_steps_trained": 21760, "num_agent_steps_sampled": 21760, "num_agent_steps_trained": 21760}, "done": false, "episodes_total": 373, "training_iteration": 17, "trial_id": "7d771_00000", "date": "2023-08-04_22-39-43", "timestamp": 1691203183, "time_this_iter_s": 14.788249015808105, "time_total_s": 343.80732822418213, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 343.80732822418213, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 69.0, "ram_util_percent": 19.399999999999995}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.610048, "episode_len_mean": 83.8, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 250, 250, 13, 12, 13, 13, 6, 250, 13, 250, 6, 13, 13, 13, 13, 250, 250, 13, 250, 13, 250, 13, 250, 13, 250, 13, 6, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 250, 250, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 250, 250, 250, 13, 250, 13, 13, 13, 250, 13, 6, 13, 13, 250, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29095718255947367, "mean_inference_ms": 0.8912286739470364, "mean_action_processing_ms": 0.09406105740412635, "mean_env_wait_ms": 0.3072806682261468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004816770553588867, "ViewRequirementAgentConnector_ms": 0.14095091819763184}, "clean_success_rate": 0.64, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019352, "poison_episode_len_mean": 93.58, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9568, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 16, 14, 13, 13, 6, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 250, 250, 13, 13, 13, 250, 13, 13, 250, 250, 250, 13, 13, 13, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 13, 13, 13, 250, 250, 13, 250, 250, 250, 250, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2910877484784977, "mean_inference_ms": 0.8910308253670388, "mean_action_processing_ms": 0.09405624831482468, "mean_env_wait_ms": 0.3072569257006267, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004834651947021484, "ViewRequirementAgentConnector_ms": 0.1239161491394043}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5204661564032237, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.0029730317989985146, "policy_loss": -0.04196059388729433, "vf_loss": 0.027690854985266924, "vf_explained_var": 0.5199347535769144, "kl": 0.011157240058328171, "entropy": 0.8274590321381887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 2625.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.749948, "episode_len_mean": 37.04, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9208000000000001, 0.0, 0.8812, 0.8488, 0.0, 0.0, 0.9279999999999999, 0.892, 0.0, 0.9352, 0.9172, 0.8632, 0.9388, 0.9172, 0.7048, 0.7263999999999999, 0.0, 0.0, 0.9244, 0.9388, 0.9316, 0.9316, 0.9388, 0.91, 0.8668, 0.6148, 0.0, 0.9388, 0.7696, 0.892, 0.874, 0.0, 0.9244, 0.9244, 0.9388, 0.8884, 0.9316, 0.856, 0.9064, 0.946, 0.7444, 0.91, 0.9388, 0.0, 0.8271999999999999, 0.8775999999999999, 0.9279999999999999, 0.7263999999999999, 0.0, 0.5176, 0.9244, 0.0, 0.9136, 0.7012, 0.9172, 0.4456, 0.9316, 0.8956, 0.9388, 0.9208000000000001, 0.9532, 0.9136, 0.9279999999999999, 0.9316, 0.7876, 0.8271999999999999, 0.8668, 0.9064, 0.9172, 0.8992, 0.9279999999999999, 0.8524, 0.9316, 0.8668, 0.6508, 0.0, 0.9136, 0.9172, 0.9136, 0.9388, 0.9316, 0.9172, 0.9388, 0.9352, 0.9316, 0.9028, 0.8164, 0.6544, 0.8992, 0.0, 0.892, 0.9496, 0.9136, 0.8992, 0.9136, 0.0, 0.946, 0.5968, 0.874, 0.8596], "episode_lengths": [22, 12, 33, 42, 9, 33, 20, 30, 10, 18, 23, 38, 17, 23, 82, 76, 250, 66, 21, 17, 19, 19, 17, 25, 37, 107, 23, 17, 64, 30, 35, 9, 21, 21, 17, 31, 19, 40, 26, 15, 71, 25, 17, 91, 48, 34, 20, 76, 29, 134, 21, 44, 24, 83, 23, 154, 19, 29, 17, 22, 13, 24, 20, 19, 59, 48, 37, 26, 23, 28, 20, 41, 19, 37, 97, 27, 24, 23, 24, 17, 19, 23, 17, 18, 19, 27, 51, 96, 28, 37, 30, 14, 24, 28, 24, 7, 15, 112, 35, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4254592063508771, "mean_inference_ms": 1.2198578541551754, "mean_action_processing_ms": 0.12275006245188241, "mean_env_wait_ms": 0.36444616981745753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005109310150146484, "ViewRequirementAgentConnector_ms": 0.15731096267700195}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.749948, "episode_len_mean": 37.04, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9208000000000001, 0.0, 0.8812, 0.8488, 0.0, 0.0, 0.9279999999999999, 0.892, 0.0, 0.9352, 0.9172, 0.8632, 0.9388, 0.9172, 0.7048, 0.7263999999999999, 0.0, 0.0, 0.9244, 0.9388, 0.9316, 0.9316, 0.9388, 0.91, 0.8668, 0.6148, 0.0, 0.9388, 0.7696, 0.892, 0.874, 0.0, 0.9244, 0.9244, 0.9388, 0.8884, 0.9316, 0.856, 0.9064, 0.946, 0.7444, 0.91, 0.9388, 0.0, 0.8271999999999999, 0.8775999999999999, 0.9279999999999999, 0.7263999999999999, 0.0, 0.5176, 0.9244, 0.0, 0.9136, 0.7012, 0.9172, 0.4456, 0.9316, 0.8956, 0.9388, 0.9208000000000001, 0.9532, 0.9136, 0.9279999999999999, 0.9316, 0.7876, 0.8271999999999999, 0.8668, 0.9064, 0.9172, 0.8992, 0.9279999999999999, 0.8524, 0.9316, 0.8668, 0.6508, 0.0, 0.9136, 0.9172, 0.9136, 0.9388, 0.9316, 0.9172, 0.9388, 0.9352, 0.9316, 0.9028, 0.8164, 0.6544, 0.8992, 0.0, 0.892, 0.9496, 0.9136, 0.8992, 0.9136, 0.0, 0.946, 0.5968, 0.874, 0.8596], "episode_lengths": [22, 12, 33, 42, 9, 33, 20, 30, 10, 18, 23, 38, 17, 23, 82, 76, 250, 66, 21, 17, 19, 19, 17, 25, 37, 107, 23, 17, 64, 30, 35, 9, 21, 21, 17, 31, 19, 40, 26, 15, 71, 25, 17, 91, 48, 34, 20, 76, 29, 134, 21, 44, 24, 83, 23, 154, 19, 29, 17, 22, 13, 24, 20, 19, 59, 48, 37, 26, 23, 28, 20, 41, 19, 37, 97, 27, 24, 23, 24, 17, 19, 23, 17, 18, 19, 27, 51, 96, 28, 37, 30, 14, 24, 28, 24, 7, 15, 112, 35, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4254592063508771, "mean_inference_ms": 1.2198578541551754, "mean_action_processing_ms": 0.12275006245188241, "mean_env_wait_ms": 0.36444616981745753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005109310150146484, "ViewRequirementAgentConnector_ms": 0.15731096267700195}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 23040, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 2703.69, "sample_time_ms": 344.162, "load_time_ms": 0.639, "load_throughput": 2002876.001, "learn_time_ms": 2344.221, "learn_throughput": 546.024, "synch_weights_time_ms": 14.038}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 404, "training_iteration": 18, "trial_id": "7d771_00000", "date": "2023-08-04_22-39-59", "timestamp": 1691203199, "time_this_iter_s": 15.981025695800781, "time_total_s": 359.7883539199829, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 359.7883539199829, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 68.25217391304346, "ram_util_percent": 19.39999999999999}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7624879999999997, "episode_len_mean": 55.66, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532], "episode_lengths": [16, 14, 14, 14, 14, 14, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 12, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29144848097034454, "mean_inference_ms": 0.8914220921454401, "mean_action_processing_ms": 0.09408659137163722, "mean_env_wait_ms": 0.30746876506523024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00496363639831543, "ViewRequirementAgentConnector_ms": 0.16213107109069824}, "clean_success_rate": 0.8, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 88.87, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 16, 14, 14, 14, 16, 250, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 6, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 250, 250, 13, 250, 250, 13, 13, 13, 250, 250, 250, 250, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29155322791096366, "mean_inference_ms": 0.8913417867557939, "mean_action_processing_ms": 0.09409150168053781, "mean_env_wait_ms": 0.30755449551316905, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0047760009765625, "ViewRequirementAgentConnector_ms": 0.14265656471252441}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42659192631642023, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": 0.006480354890227318, "policy_loss": -0.04252930247535308, "vf_loss": 0.038717268283168474, "vf_explained_var": 0.6459885748227437, "kl": 0.010165321588089379, "entropy": 0.7757774742444357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 2775.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 24320, "num_env_steps_trained": 24320, "num_agent_steps_sampled": 24320, "num_agent_steps_trained": 24320}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.760488, "episode_len_mean": 38.48, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9064, 0.946, 0.7444, 0.91, 0.9388, 0.0, 0.8271999999999999, 0.8775999999999999, 0.9279999999999999, 0.7263999999999999, 0.0, 0.5176, 0.9244, 0.0, 0.9136, 0.7012, 0.9172, 0.4456, 0.9316, 0.8956, 0.9388, 0.9208000000000001, 0.9532, 0.9136, 0.9279999999999999, 0.9316, 0.7876, 0.8271999999999999, 0.8668, 0.9064, 0.9172, 0.8992, 0.9279999999999999, 0.8524, 0.9316, 0.8668, 0.6508, 0.0, 0.9136, 0.9172, 0.9136, 0.9388, 0.9316, 0.9172, 0.9388, 0.9352, 0.9316, 0.9028, 0.8164, 0.6544, 0.8992, 0.0, 0.892, 0.9496, 0.9136, 0.8992, 0.9136, 0.0, 0.946, 0.5968, 0.874, 0.8596, 0.6364, 0.9388, 0.9172, 0.42399999999999993, 0.0, 0.9172, 0.0, 0.8884, 0.9388, 0.9244, 0.8236, 0.9532, 0.946, 0.91, 0.8488, 0.946, 0.9064, 0.8956, 0.8992, 0.9388, 0.0, 0.0, 0.9316, 0.8812, 0.9532, 0.9388, 0.9388, 0.8848, 0.9244, 0.0, 0.9316, 0.8524, 0.0, 0.9352, 0.8596, 0.9388, 0.0, 0.8992], "episode_lengths": [26, 15, 71, 25, 17, 91, 48, 34, 20, 76, 29, 134, 21, 44, 24, 83, 23, 154, 19, 29, 17, 22, 13, 24, 20, 19, 59, 48, 37, 26, 23, 28, 20, 41, 19, 37, 97, 27, 24, 23, 24, 17, 19, 23, 17, 18, 19, 27, 51, 96, 28, 37, 30, 14, 24, 28, 24, 7, 15, 112, 35, 39, 101, 17, 23, 160, 85, 23, 84, 31, 17, 21, 49, 13, 15, 25, 42, 15, 26, 29, 28, 17, 88, 15, 19, 33, 13, 17, 17, 32, 21, 13, 19, 41, 36, 18, 39, 17, 250, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4244566800992933, "mean_inference_ms": 1.2200577786175941, "mean_action_processing_ms": 0.122021903569469, "mean_env_wait_ms": 0.3623668090630055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004827976226806641, "ViewRequirementAgentConnector_ms": 0.1543259620666504}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.760488, "episode_len_mean": 38.48, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9064, 0.946, 0.7444, 0.91, 0.9388, 0.0, 0.8271999999999999, 0.8775999999999999, 0.9279999999999999, 0.7263999999999999, 0.0, 0.5176, 0.9244, 0.0, 0.9136, 0.7012, 0.9172, 0.4456, 0.9316, 0.8956, 0.9388, 0.9208000000000001, 0.9532, 0.9136, 0.9279999999999999, 0.9316, 0.7876, 0.8271999999999999, 0.8668, 0.9064, 0.9172, 0.8992, 0.9279999999999999, 0.8524, 0.9316, 0.8668, 0.6508, 0.0, 0.9136, 0.9172, 0.9136, 0.9388, 0.9316, 0.9172, 0.9388, 0.9352, 0.9316, 0.9028, 0.8164, 0.6544, 0.8992, 0.0, 0.892, 0.9496, 0.9136, 0.8992, 0.9136, 0.0, 0.946, 0.5968, 0.874, 0.8596, 0.6364, 0.9388, 0.9172, 0.42399999999999993, 0.0, 0.9172, 0.0, 0.8884, 0.9388, 0.9244, 0.8236, 0.9532, 0.946, 0.91, 0.8488, 0.946, 0.9064, 0.8956, 0.8992, 0.9388, 0.0, 0.0, 0.9316, 0.8812, 0.9532, 0.9388, 0.9388, 0.8848, 0.9244, 0.0, 0.9316, 0.8524, 0.0, 0.9352, 0.8596, 0.9388, 0.0, 0.8992], "episode_lengths": [26, 15, 71, 25, 17, 91, 48, 34, 20, 76, 29, 134, 21, 44, 24, 83, 23, 154, 19, 29, 17, 22, 13, 24, 20, 19, 59, 48, 37, 26, 23, 28, 20, 41, 19, 37, 97, 27, 24, 23, 24, 17, 19, 23, 17, 18, 19, 27, 51, 96, 28, 37, 30, 14, 24, 28, 24, 7, 15, 112, 35, 39, 101, 17, 23, 160, 85, 23, 84, 31, 17, 21, 49, 13, 15, 25, 42, 15, 26, 29, 28, 17, 88, 15, 19, 33, 13, 17, 17, 32, 21, 13, 19, 41, 36, 18, 39, 17, 250, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4244566800992933, "mean_inference_ms": 1.2200577786175941, "mean_action_processing_ms": 0.122021903569469, "mean_env_wait_ms": 0.3623668090630055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004827976226806641, "ViewRequirementAgentConnector_ms": 0.1543259620666504}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24320, "num_agent_steps_trained": 24320, "num_env_steps_sampled": 24320, "num_env_steps_trained": 24320, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 24320, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 24320, "timers": {"training_iteration_time_ms": 2759.717, "sample_time_ms": 347.704, "load_time_ms": 0.63, "load_throughput": 2032062.498, "learn_time_ms": 2396.283, "learn_throughput": 534.161, "synch_weights_time_ms": 14.466}, "counters": {"num_env_steps_sampled": 24320, "num_env_steps_trained": 24320, "num_agent_steps_sampled": 24320, "num_agent_steps_trained": 24320}, "done": false, "episodes_total": 442, "training_iteration": 19, "trial_id": "7d771_00000", "date": "2023-08-04_22-40-16", "timestamp": 1691203216, "time_this_iter_s": 17.05892586708069, "time_total_s": 376.8472797870636, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 376.8472797870636, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 68.8375, "ram_util_percent": 19.4}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6671679999999999, "episode_len_mean": 81.74, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 16, 14, 250, 13, 13, 13, 13, 250, 250, 250, 13, 13, 250, 250, 13, 250, 13, 250, 13, 6, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 13, 250, 250, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29176895584019874, "mean_inference_ms": 0.8917285198608234, "mean_action_processing_ms": 0.09409484306804503, "mean_env_wait_ms": 0.3077738596292203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004553318023681641, "ViewRequirementAgentConnector_ms": 0.13808155059814453}, "clean_success_rate": 0.7, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 60.25, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 251, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 250, 13, 250, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 6, 13, 6, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29203471633830563, "mean_inference_ms": 0.8917712954200903, "mean_action_processing_ms": 0.0940738059179613, "mean_env_wait_ms": 0.30790781142008383, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0050699710845947266, "ViewRequirementAgentConnector_ms": 0.13124585151672363}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4139336021741231, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02224005328180889, "policy_loss": -0.05303595222532749, "vf_loss": 0.01924680405296385, "vf_explained_var": 0.49506380875905354, "kl": 0.011406512051144091, "entropy": 0.7683050545056661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 2925.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7785880000000001, "episode_len_mean": 34.75, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9388, 0.9352, 0.9316, 0.9028, 0.8164, 0.6544, 0.8992, 0.0, 0.892, 0.9496, 0.9136, 0.8992, 0.9136, 0.0, 0.946, 0.5968, 0.874, 0.8596, 0.6364, 0.9388, 0.9172, 0.42399999999999993, 0.0, 0.9172, 0.0, 0.8884, 0.9388, 0.9244, 0.8236, 0.9532, 0.946, 0.91, 0.8488, 0.946, 0.9064, 0.8956, 0.8992, 0.9388, 0.0, 0.0, 0.9316, 0.8812, 0.9532, 0.9388, 0.9388, 0.8848, 0.9244, 0.0, 0.9316, 0.8524, 0.0, 0.9352, 0.8596, 0.9388, 0.0, 0.8992, 0.7912, 0.8271999999999999, 0.9279999999999999, 0.91, 0.8992, 0.892, 0.91, 0.856, 0.9028, 0.45999999999999996, 0.8596, 0.9172, 0.0, 0.9532, 0.9064, 0.9136, 0.9244, 0.8956, 0.9208000000000001, 0.946, 0.0, 0.91, 0.946, 0.91, 0.9279999999999999, 0.9316, 0.874, 0.8956, 0.9316, 0.9316, 0.8271999999999999, 0.748, 0.946, 0.892, 0.9424, 0.9028, 0.9424, 0.8164, 0.946, 0.8992, 0.91, 0.0, 0.9316, 0.838], "episode_lengths": [17, 18, 19, 27, 51, 96, 28, 37, 30, 14, 24, 28, 24, 7, 15, 112, 35, 39, 101, 17, 23, 160, 85, 23, 84, 31, 17, 21, 49, 13, 15, 25, 42, 15, 26, 29, 28, 17, 88, 15, 19, 33, 13, 17, 17, 32, 21, 13, 19, 41, 36, 18, 39, 17, 250, 28, 58, 48, 20, 25, 28, 30, 25, 40, 27, 150, 39, 23, 13, 13, 26, 24, 21, 29, 22, 15, 20, 25, 15, 25, 20, 19, 35, 29, 19, 19, 48, 70, 15, 30, 16, 27, 16, 51, 15, 28, 25, 10, 19, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4274002892820448, "mean_inference_ms": 1.2191279292060748, "mean_action_processing_ms": 0.12139714407574287, "mean_env_wait_ms": 0.3626639466321564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004930734634399414, "ViewRequirementAgentConnector_ms": 0.16237378120422363}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7785880000000001, "episode_len_mean": 34.75, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9388, 0.9352, 0.9316, 0.9028, 0.8164, 0.6544, 0.8992, 0.0, 0.892, 0.9496, 0.9136, 0.8992, 0.9136, 0.0, 0.946, 0.5968, 0.874, 0.8596, 0.6364, 0.9388, 0.9172, 0.42399999999999993, 0.0, 0.9172, 0.0, 0.8884, 0.9388, 0.9244, 0.8236, 0.9532, 0.946, 0.91, 0.8488, 0.946, 0.9064, 0.8956, 0.8992, 0.9388, 0.0, 0.0, 0.9316, 0.8812, 0.9532, 0.9388, 0.9388, 0.8848, 0.9244, 0.0, 0.9316, 0.8524, 0.0, 0.9352, 0.8596, 0.9388, 0.0, 0.8992, 0.7912, 0.8271999999999999, 0.9279999999999999, 0.91, 0.8992, 0.892, 0.91, 0.856, 0.9028, 0.45999999999999996, 0.8596, 0.9172, 0.0, 0.9532, 0.9064, 0.9136, 0.9244, 0.8956, 0.9208000000000001, 0.946, 0.0, 0.91, 0.946, 0.91, 0.9279999999999999, 0.9316, 0.874, 0.8956, 0.9316, 0.9316, 0.8271999999999999, 0.748, 0.946, 0.892, 0.9424, 0.9028, 0.9424, 0.8164, 0.946, 0.8992, 0.91, 0.0, 0.9316, 0.838], "episode_lengths": [17, 18, 19, 27, 51, 96, 28, 37, 30, 14, 24, 28, 24, 7, 15, 112, 35, 39, 101, 17, 23, 160, 85, 23, 84, 31, 17, 21, 49, 13, 15, 25, 42, 15, 26, 29, 28, 17, 88, 15, 19, 33, 13, 17, 17, 32, 21, 13, 19, 41, 36, 18, 39, 17, 250, 28, 58, 48, 20, 25, 28, 30, 25, 40, 27, 150, 39, 23, 13, 13, 26, 24, 21, 29, 22, 15, 20, 25, 15, 25, 20, 19, 35, 29, 19, 19, 48, 70, 15, 30, 16, 27, 16, 51, 15, 28, 25, 10, 19, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4274002892820448, "mean_inference_ms": 1.2191279292060748, "mean_action_processing_ms": 0.12139714407574287, "mean_env_wait_ms": 0.3626639466321564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004930734634399414, "ViewRequirementAgentConnector_ms": 0.16237378120422363}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 25600, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 2767.52, "sample_time_ms": 340.569, "load_time_ms": 0.616, "load_throughput": 2078478.173, "learn_time_ms": 2411.454, "learn_throughput": 530.8, "synch_weights_time_ms": 14.244}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 486, "training_iteration": 20, "trial_id": "7d771_00000", "date": "2023-08-04_22-40-31", "timestamp": 1691203231, "time_this_iter_s": 15.419457197189331, "time_total_s": 392.26673698425293, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 392.26673698425293, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 67.75454545454546, "ram_util_percent": 19.39999999999999}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.6761959999999999, "episode_len_mean": 77.07, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9316, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 16, 14, 14, 16, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 6, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 250, 13, 250, 13, 250, 19, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 19, 250, 13, 13, 250, 250, 13, 6, 13, 250, 13, 13, 13, 250, 13, 250, 250, 13, 250, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2922644696014755, "mean_inference_ms": 0.8919359697870193, "mean_action_processing_ms": 0.09408369445027356, "mean_env_wait_ms": 0.3079193973267338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004963397979736328, "ViewRequirementAgentConnector_ms": 0.138779878616333}, "clean_success_rate": 0.71, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.039136000000000004, "poison_episode_len_mean": 60.18, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 250, 13, 250, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 250, 13, 13, 250, 13, 250, 250, 13, 13, 13, 250, 13, 250, 13, 13, 6, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29245192055112595, "mean_inference_ms": 0.8919440028074215, "mean_action_processing_ms": 0.09412751746027215, "mean_env_wait_ms": 0.3078181182040875, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004895925521850586, "ViewRequirementAgentConnector_ms": 0.14484620094299316}, "poison_success_rate": 0.04, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41862333397070567, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.009268416846171022, "policy_loss": -0.05098585060487191, "vf_loss": 0.02885528597359856, "vf_explained_var": 0.6156199908256531, "kl": 0.01270335509601864, "entropy": 0.8194329476356507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 3075.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.777588, "episode_len_mean": 32.13, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9244, 0.8236, 0.9532, 0.946, 0.91, 0.8488, 0.946, 0.9064, 0.8956, 0.8992, 0.9388, 0.0, 0.0, 0.9316, 0.8812, 0.9532, 0.9388, 0.9388, 0.8848, 0.9244, 0.0, 0.9316, 0.8524, 0.0, 0.9352, 0.8596, 0.9388, 0.0, 0.8992, 0.7912, 0.8271999999999999, 0.9279999999999999, 0.91, 0.8992, 0.892, 0.91, 0.856, 0.9028, 0.45999999999999996, 0.8596, 0.9172, 0.0, 0.9532, 0.9064, 0.9136, 0.9244, 0.8956, 0.9208000000000001, 0.946, 0.0, 0.91, 0.946, 0.91, 0.9279999999999999, 0.9316, 0.874, 0.8956, 0.9316, 0.9316, 0.8271999999999999, 0.748, 0.946, 0.892, 0.9424, 0.9028, 0.9424, 0.8164, 0.946, 0.8992, 0.91, 0.0, 0.9316, 0.838, 0.9028, 0.0, 0.8812, 0.766, 0.9028, 0.9388, 0.9424, 0.8812, 0.8775999999999999, 0.9316, 0.9279999999999999, 0.0, 0.892, 0.0, 0.766, 0.0, 0.8092, 0.946, 0.0, 0.946, 0.9028, 0.8812, 0.8271999999999999, 0.8632, 0.9028, 0.8488, 0.946], "episode_lengths": [21, 49, 13, 15, 25, 42, 15, 26, 29, 28, 17, 88, 15, 19, 33, 13, 17, 17, 32, 21, 13, 19, 41, 36, 18, 39, 17, 250, 28, 58, 48, 20, 25, 28, 30, 25, 40, 27, 150, 39, 23, 13, 13, 26, 24, 21, 29, 22, 15, 20, 25, 15, 25, 20, 19, 35, 29, 19, 19, 48, 70, 15, 30, 16, 27, 16, 51, 15, 28, 25, 10, 19, 45, 27, 8, 33, 65, 27, 17, 16, 33, 34, 19, 20, 56, 30, 56, 65, 44, 53, 15, 37, 15, 27, 33, 48, 38, 27, 42, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42825852114410945, "mean_inference_ms": 1.2207197611198104, "mean_action_processing_ms": 0.12188798452956683, "mean_env_wait_ms": 0.3631200309626088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00485539436340332, "ViewRequirementAgentConnector_ms": 0.16217803955078125}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.777588, "episode_len_mean": 32.13, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9244, 0.8236, 0.9532, 0.946, 0.91, 0.8488, 0.946, 0.9064, 0.8956, 0.8992, 0.9388, 0.0, 0.0, 0.9316, 0.8812, 0.9532, 0.9388, 0.9388, 0.8848, 0.9244, 0.0, 0.9316, 0.8524, 0.0, 0.9352, 0.8596, 0.9388, 0.0, 0.8992, 0.7912, 0.8271999999999999, 0.9279999999999999, 0.91, 0.8992, 0.892, 0.91, 0.856, 0.9028, 0.45999999999999996, 0.8596, 0.9172, 0.0, 0.9532, 0.9064, 0.9136, 0.9244, 0.8956, 0.9208000000000001, 0.946, 0.0, 0.91, 0.946, 0.91, 0.9279999999999999, 0.9316, 0.874, 0.8956, 0.9316, 0.9316, 0.8271999999999999, 0.748, 0.946, 0.892, 0.9424, 0.9028, 0.9424, 0.8164, 0.946, 0.8992, 0.91, 0.0, 0.9316, 0.838, 0.9028, 0.0, 0.8812, 0.766, 0.9028, 0.9388, 0.9424, 0.8812, 0.8775999999999999, 0.9316, 0.9279999999999999, 0.0, 0.892, 0.0, 0.766, 0.0, 0.8092, 0.946, 0.0, 0.946, 0.9028, 0.8812, 0.8271999999999999, 0.8632, 0.9028, 0.8488, 0.946], "episode_lengths": [21, 49, 13, 15, 25, 42, 15, 26, 29, 28, 17, 88, 15, 19, 33, 13, 17, 17, 32, 21, 13, 19, 41, 36, 18, 39, 17, 250, 28, 58, 48, 20, 25, 28, 30, 25, 40, 27, 150, 39, 23, 13, 13, 26, 24, 21, 29, 22, 15, 20, 25, 15, 25, 20, 19, 35, 29, 19, 19, 48, 70, 15, 30, 16, 27, 16, 51, 15, 28, 25, 10, 19, 45, 27, 8, 33, 65, 27, 17, 16, 33, 34, 19, 20, 56, 30, 56, 65, 44, 53, 15, 37, 15, 27, 33, 48, 38, 27, 42, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42825852114410945, "mean_inference_ms": 1.2207197611198104, "mean_action_processing_ms": 0.12188798452956683, "mean_env_wait_ms": 0.3631200309626088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00485539436340332, "ViewRequirementAgentConnector_ms": 0.16217803955078125}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 26880, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 2742.469, "sample_time_ms": 336.181, "load_time_ms": 0.611, "load_throughput": 2095842.099, "learn_time_ms": 2393.034, "learn_throughput": 534.886, "synch_weights_time_ms": 12.026}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "done": false, "episodes_total": 513, "training_iteration": 21, "trial_id": "7d771_00000", "date": "2023-08-04_22-40-47", "timestamp": 1691203247, "time_this_iter_s": 15.165830850601196, "time_total_s": 407.4325678348541, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 407.4325678348541, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 67.98571428571428, "ram_util_percent": 19.399999999999995}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.62904, "episode_len_mean": 93.66, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532], "episode_lengths": [14, 14, 14, 16, 251, 14, 13, 13, 250, 250, 250, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 250, 13, 250, 13, 250, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2925820571289676, "mean_inference_ms": 0.8917745469169582, "mean_action_processing_ms": 0.09409200945313961, "mean_env_wait_ms": 0.3076800706948904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004725456237792969, "ViewRequirementAgentConnector_ms": 0.15611004829406738}, "clean_success_rate": 0.66, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 91.08, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 16, 14, 14, 14, 13, 13, 13, 13, 13, 13, 250, 6, 13, 13, 250, 250, 250, 13, 13, 250, 250, 13, 250, 250, 13, 13, 13, 13, 6, 250, 13, 13, 13, 250, 13, 250, 13, 13, 250, 6, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 250, 250, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2926299772661592, "mean_inference_ms": 0.8914306538381227, "mean_action_processing_ms": 0.09406449298468919, "mean_env_wait_ms": 0.30769244148572705, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004701137542724609, "ViewRequirementAgentConnector_ms": 0.12796640396118164}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4152475560704867, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.0017017458379268646, "policy_loss": -0.04720073230564594, "vf_loss": 0.033326572341223555, "vf_explained_var": 0.6426220651467641, "kl": 0.012022139337398888, "entropy": 0.7822051886717478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 3225.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7700559999999999, "episode_len_mean": 37.48, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.892, 0.91, 0.856, 0.9028, 0.45999999999999996, 0.8596, 0.9172, 0.0, 0.9532, 0.9064, 0.9136, 0.9244, 0.8956, 0.9208000000000001, 0.946, 0.0, 0.91, 0.946, 0.91, 0.9279999999999999, 0.9316, 0.874, 0.8956, 0.9316, 0.9316, 0.8271999999999999, 0.748, 0.946, 0.892, 0.9424, 0.9028, 0.9424, 0.8164, 0.946, 0.8992, 0.91, 0.0, 0.9316, 0.838, 0.9028, 0.0, 0.8812, 0.766, 0.9028, 0.9388, 0.9424, 0.8812, 0.8775999999999999, 0.9316, 0.9279999999999999, 0.0, 0.892, 0.0, 0.766, 0.0, 0.8092, 0.946, 0.0, 0.946, 0.9028, 0.8812, 0.8271999999999999, 0.8632, 0.9028, 0.8488, 0.946, 0.0, 0.0, 0.9532, 0.9316, 0.91, 0.9424, 0.8308, 0.8848, 0.4888, 0.0, 0.8812, 0.9208000000000001, 0.9388, 0.694, 0.9316, 0.946, 0.8992, 0.946, 0.8812, 0.9244, 0.9352, 0.8956, 0.9316, 0.8812, 0.8812, 0.8704000000000001, 0.532, 0.874, 0.8884, 0.9244, 0.874, 0.17199999999999993, 0.0, 0.8992], "episode_lengths": [30, 25, 40, 27, 150, 39, 23, 13, 13, 26, 24, 21, 29, 22, 15, 20, 25, 15, 25, 20, 19, 35, 29, 19, 19, 48, 70, 15, 30, 16, 27, 16, 51, 15, 28, 25, 10, 19, 45, 27, 8, 33, 65, 27, 17, 16, 33, 34, 19, 20, 56, 30, 56, 65, 44, 53, 15, 37, 15, 27, 33, 48, 38, 27, 42, 15, 127, 37, 13, 19, 25, 16, 47, 32, 142, 250, 33, 22, 17, 85, 19, 15, 28, 15, 33, 21, 18, 29, 19, 33, 33, 36, 130, 35, 31, 21, 35, 230, 36, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43102874049298623, "mean_inference_ms": 1.2223864118965497, "mean_action_processing_ms": 0.12237173480453123, "mean_env_wait_ms": 0.3641092070410291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005129575729370117, "ViewRequirementAgentConnector_ms": 0.1562516689300537}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7700559999999999, "episode_len_mean": 37.48, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.892, 0.91, 0.856, 0.9028, 0.45999999999999996, 0.8596, 0.9172, 0.0, 0.9532, 0.9064, 0.9136, 0.9244, 0.8956, 0.9208000000000001, 0.946, 0.0, 0.91, 0.946, 0.91, 0.9279999999999999, 0.9316, 0.874, 0.8956, 0.9316, 0.9316, 0.8271999999999999, 0.748, 0.946, 0.892, 0.9424, 0.9028, 0.9424, 0.8164, 0.946, 0.8992, 0.91, 0.0, 0.9316, 0.838, 0.9028, 0.0, 0.8812, 0.766, 0.9028, 0.9388, 0.9424, 0.8812, 0.8775999999999999, 0.9316, 0.9279999999999999, 0.0, 0.892, 0.0, 0.766, 0.0, 0.8092, 0.946, 0.0, 0.946, 0.9028, 0.8812, 0.8271999999999999, 0.8632, 0.9028, 0.8488, 0.946, 0.0, 0.0, 0.9532, 0.9316, 0.91, 0.9424, 0.8308, 0.8848, 0.4888, 0.0, 0.8812, 0.9208000000000001, 0.9388, 0.694, 0.9316, 0.946, 0.8992, 0.946, 0.8812, 0.9244, 0.9352, 0.8956, 0.9316, 0.8812, 0.8812, 0.8704000000000001, 0.532, 0.874, 0.8884, 0.9244, 0.874, 0.17199999999999993, 0.0, 0.8992], "episode_lengths": [30, 25, 40, 27, 150, 39, 23, 13, 13, 26, 24, 21, 29, 22, 15, 20, 25, 15, 25, 20, 19, 35, 29, 19, 19, 48, 70, 15, 30, 16, 27, 16, 51, 15, 28, 25, 10, 19, 45, 27, 8, 33, 65, 27, 17, 16, 33, 34, 19, 20, 56, 30, 56, 65, 44, 53, 15, 37, 15, 27, 33, 48, 38, 27, 42, 15, 127, 37, 13, 19, 25, 16, 47, 32, 142, 250, 33, 22, 17, 85, 19, 15, 28, 15, 33, 21, 18, 29, 19, 33, 33, 36, 130, 35, 31, 21, 35, 230, 36, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43102874049298623, "mean_inference_ms": 1.2223864118965497, "mean_action_processing_ms": 0.12237173480453123, "mean_env_wait_ms": 0.3641092070410291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005129575729370117, "ViewRequirementAgentConnector_ms": 0.1562516689300537}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 28160, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 28160, "timers": {"training_iteration_time_ms": 2639.049, "sample_time_ms": 340.719, "load_time_ms": 0.62, "load_throughput": 2064094.241, "learn_time_ms": 2286.653, "learn_throughput": 559.77, "synch_weights_time_ms": 10.45}, "counters": {"num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "done": false, "episodes_total": 547, "training_iteration": 22, "trial_id": "7d771_00000", "date": "2023-08-04_22-41-03", "timestamp": 1691203263, "time_this_iter_s": 16.188823699951172, "time_total_s": 423.6213915348053, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 423.6213915348053, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 67.82916666666667, "ram_util_percent": 19.4}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7432079999999998, "episode_len_mean": 60.4, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 16, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 250, 6, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 19, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 6, 13, 13, 13, 13, 250, 250, 250, 250, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2927836606034547, "mean_inference_ms": 0.8915841375966436, "mean_action_processing_ms": 0.09412584695389237, "mean_env_wait_ms": 0.3077774845596635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.006236076354980469, "ViewRequirementAgentConnector_ms": 0.15350055694580078}, "clean_success_rate": 0.78, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 69.79, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 18, 16, 14, 250, 13, 6, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 250, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 6, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2929128305460127, "mean_inference_ms": 0.891629557583566, "mean_action_processing_ms": 0.09412662782924971, "mean_env_wait_ms": 0.307628857203724, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0099334716796875, "ViewRequirementAgentConnector_ms": 0.12824773788452148}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4089312282204628, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.00882308389681081, "policy_loss": -0.04900461173305909, "vf_loss": 0.028628988768905402, "vf_explained_var": 0.5973596791426341, "kl": 0.011409912346183167, "entropy": 0.7634918745358785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 29440, "num_env_steps_trained": 29440, "num_agent_steps_sampled": 29440, "num_agent_steps_trained": 29440}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7728280000000001, "episode_len_mean": 36.97, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8992, 0.91, 0.0, 0.9316, 0.838, 0.9028, 0.0, 0.8812, 0.766, 0.9028, 0.9388, 0.9424, 0.8812, 0.8775999999999999, 0.9316, 0.9279999999999999, 0.0, 0.892, 0.0, 0.766, 0.0, 0.8092, 0.946, 0.0, 0.946, 0.9028, 0.8812, 0.8271999999999999, 0.8632, 0.9028, 0.8488, 0.946, 0.0, 0.0, 0.9532, 0.9316, 0.91, 0.9424, 0.8308, 0.8848, 0.4888, 0.0, 0.8812, 0.9208000000000001, 0.9388, 0.694, 0.9316, 0.946, 0.8992, 0.946, 0.8812, 0.9244, 0.9352, 0.8956, 0.9316, 0.8812, 0.8812, 0.8704000000000001, 0.532, 0.874, 0.8884, 0.9244, 0.874, 0.17199999999999993, 0.0, 0.8992, 0.8524, 0.856, 0.8596, 0.91, 0.9424, 0.8848, 0.91, 0.91, 0.82, 0.856, 0.8992, 0.9172, 0.8992, 0.9172, 0.0, 0.9316, 0.8632, 0.0, 0.9316, 0.9352, 0.8668, 0.8416, 0.9279999999999999, 0.8992, 0.9244, 0.9316, 0.946, 0.892, 0.8668, 0.9532, 0.9316, 0.9316, 0.8164, 0.9316], "episode_lengths": [28, 25, 10, 19, 45, 27, 8, 33, 65, 27, 17, 16, 33, 34, 19, 20, 56, 30, 56, 65, 44, 53, 15, 37, 15, 27, 33, 48, 38, 27, 42, 15, 127, 37, 13, 19, 25, 16, 47, 32, 142, 250, 33, 22, 17, 85, 19, 15, 28, 15, 33, 21, 18, 29, 19, 33, 33, 36, 130, 35, 31, 21, 35, 230, 36, 28, 41, 40, 39, 25, 16, 32, 25, 25, 50, 40, 28, 23, 28, 23, 57, 19, 38, 2, 19, 18, 37, 44, 20, 28, 21, 19, 15, 30, 37, 13, 19, 19, 51, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43009554557146173, "mean_inference_ms": 1.2213936534305845, "mean_action_processing_ms": 0.12261736922661318, "mean_env_wait_ms": 0.36359142068304523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005252361297607422, "ViewRequirementAgentConnector_ms": 0.1555626392364502}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7728280000000001, "episode_len_mean": 36.97, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8992, 0.91, 0.0, 0.9316, 0.838, 0.9028, 0.0, 0.8812, 0.766, 0.9028, 0.9388, 0.9424, 0.8812, 0.8775999999999999, 0.9316, 0.9279999999999999, 0.0, 0.892, 0.0, 0.766, 0.0, 0.8092, 0.946, 0.0, 0.946, 0.9028, 0.8812, 0.8271999999999999, 0.8632, 0.9028, 0.8488, 0.946, 0.0, 0.0, 0.9532, 0.9316, 0.91, 0.9424, 0.8308, 0.8848, 0.4888, 0.0, 0.8812, 0.9208000000000001, 0.9388, 0.694, 0.9316, 0.946, 0.8992, 0.946, 0.8812, 0.9244, 0.9352, 0.8956, 0.9316, 0.8812, 0.8812, 0.8704000000000001, 0.532, 0.874, 0.8884, 0.9244, 0.874, 0.17199999999999993, 0.0, 0.8992, 0.8524, 0.856, 0.8596, 0.91, 0.9424, 0.8848, 0.91, 0.91, 0.82, 0.856, 0.8992, 0.9172, 0.8992, 0.9172, 0.0, 0.9316, 0.8632, 0.0, 0.9316, 0.9352, 0.8668, 0.8416, 0.9279999999999999, 0.8992, 0.9244, 0.9316, 0.946, 0.892, 0.8668, 0.9532, 0.9316, 0.9316, 0.8164, 0.9316], "episode_lengths": [28, 25, 10, 19, 45, 27, 8, 33, 65, 27, 17, 16, 33, 34, 19, 20, 56, 30, 56, 65, 44, 53, 15, 37, 15, 27, 33, 48, 38, 27, 42, 15, 127, 37, 13, 19, 25, 16, 47, 32, 142, 250, 33, 22, 17, 85, 19, 15, 28, 15, 33, 21, 18, 29, 19, 33, 33, 36, 130, 35, 31, 21, 35, 230, 36, 28, 41, 40, 39, 25, 16, 32, 25, 25, 50, 40, 28, 23, 28, 23, 57, 19, 38, 2, 19, 18, 37, 44, 20, 28, 21, 19, 15, 30, 37, 13, 19, 19, 51, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43009554557146173, "mean_inference_ms": 1.2213936534305845, "mean_action_processing_ms": 0.12261736922661318, "mean_env_wait_ms": 0.36359142068304523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005252361297607422, "ViewRequirementAgentConnector_ms": 0.1555626392364502}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29440, "num_agent_steps_trained": 29440, "num_env_steps_sampled": 29440, "num_env_steps_trained": 29440, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 29440, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 29440, "timers": {"training_iteration_time_ms": 2638.357, "sample_time_ms": 341.422, "load_time_ms": 0.61, "load_throughput": 2097725.597, "learn_time_ms": 2285.047, "learn_throughput": 560.163, "synch_weights_time_ms": 10.679}, "counters": {"num_env_steps_sampled": 29440, "num_env_steps_trained": 29440, "num_agent_steps_sampled": 29440, "num_agent_steps_trained": 29440}, "done": false, "episodes_total": 581, "training_iteration": 23, "trial_id": "7d771_00000", "date": "2023-08-04_22-41-16", "timestamp": 1691203276, "time_this_iter_s": 13.14921760559082, "time_total_s": 436.7706091403961, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 436.7706091403961, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 68.4, "ram_util_percent": 19.399999999999995}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7434959999999998, "episode_len_mean": 60.32, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 6, 13, 250, 13, 13, 250, 13, 250, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 6, 13, 13, 13, 13, 13, 250, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29308597730344016, "mean_inference_ms": 0.891670759771353, "mean_action_processing_ms": 0.09410532705033209, "mean_env_wait_ms": 0.30755823545154337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004831552505493164, "ViewRequirementAgentConnector_ms": 0.15306830406188965}, "clean_success_rate": 0.78, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 69.84, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 18, 14, 14, 14, 14, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 250, 13, 13, 250, 250, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 6, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 250, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2931941247517269, "mean_inference_ms": 0.8915803380129218, "mean_action_processing_ms": 0.09410502458170596, "mean_env_wait_ms": 0.30741697098917453, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004670143127441406, "ViewRequirementAgentConnector_ms": 0.13086605072021484}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3835105882088343, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02359580488875508, "policy_loss": -0.05410335237781207, "vf_loss": 0.01884611288396021, "vf_explained_var": 0.820937800804774, "kl": 0.01151746415659242, "entropy": 0.7384438236554464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 3525.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.793872, "episode_len_mean": 36.66, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9424, 0.8308, 0.8848, 0.4888, 0.0, 0.8812, 0.9208000000000001, 0.9388, 0.694, 0.9316, 0.946, 0.8992, 0.946, 0.8812, 0.9244, 0.9352, 0.8956, 0.9316, 0.8812, 0.8812, 0.8704000000000001, 0.532, 0.874, 0.8884, 0.9244, 0.874, 0.17199999999999993, 0.0, 0.8992, 0.8524, 0.856, 0.8596, 0.91, 0.9424, 0.8848, 0.91, 0.91, 0.82, 0.856, 0.8992, 0.9172, 0.8992, 0.9172, 0.0, 0.9316, 0.8632, 0.0, 0.9316, 0.9352, 0.8668, 0.8416, 0.9279999999999999, 0.8992, 0.9244, 0.9316, 0.946, 0.892, 0.8668, 0.9532, 0.9316, 0.9316, 0.8164, 0.9316, 0.8704000000000001, 0.9316, 0.0, 0.9316, 0.6796, 0.9172, 0.9388, 0.9424, 0.9424, 0.9064, 0.946, 0.91, 0.9532, 0.0, 0.9352, 0.91, 0.9532, 0.9388, 0.946, 0.892, 0.9388, 0.8992, 0.0, 0.5428, 0.0, 0.8704000000000001, 0.9352, 0.0, 0.9279999999999999, 0.0, 0.946, 0.9532, 0.8848, 0.9316, 0.8452, 0.9352, 0.9064], "episode_lengths": [16, 47, 32, 142, 250, 33, 22, 17, 85, 19, 15, 28, 15, 33, 21, 18, 29, 19, 33, 33, 36, 130, 35, 31, 21, 35, 230, 36, 28, 41, 40, 39, 25, 16, 32, 25, 25, 50, 40, 28, 23, 28, 23, 57, 19, 38, 2, 19, 18, 37, 44, 20, 28, 21, 19, 15, 30, 37, 13, 19, 19, 51, 19, 36, 19, 65, 19, 89, 23, 17, 16, 16, 26, 15, 25, 13, 5, 18, 25, 13, 17, 15, 30, 17, 28, 250, 127, 36, 36, 18, 11, 20, 6, 15, 13, 32, 19, 43, 18, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42973977792033097, "mean_inference_ms": 1.2156988540931837, "mean_action_processing_ms": 0.12233182320239422, "mean_env_wait_ms": 0.3627986382232977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005236387252807617, "ViewRequirementAgentConnector_ms": 0.144059419631958}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.793872, "episode_len_mean": 36.66, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9424, 0.8308, 0.8848, 0.4888, 0.0, 0.8812, 0.9208000000000001, 0.9388, 0.694, 0.9316, 0.946, 0.8992, 0.946, 0.8812, 0.9244, 0.9352, 0.8956, 0.9316, 0.8812, 0.8812, 0.8704000000000001, 0.532, 0.874, 0.8884, 0.9244, 0.874, 0.17199999999999993, 0.0, 0.8992, 0.8524, 0.856, 0.8596, 0.91, 0.9424, 0.8848, 0.91, 0.91, 0.82, 0.856, 0.8992, 0.9172, 0.8992, 0.9172, 0.0, 0.9316, 0.8632, 0.0, 0.9316, 0.9352, 0.8668, 0.8416, 0.9279999999999999, 0.8992, 0.9244, 0.9316, 0.946, 0.892, 0.8668, 0.9532, 0.9316, 0.9316, 0.8164, 0.9316, 0.8704000000000001, 0.9316, 0.0, 0.9316, 0.6796, 0.9172, 0.9388, 0.9424, 0.9424, 0.9064, 0.946, 0.91, 0.9532, 0.0, 0.9352, 0.91, 0.9532, 0.9388, 0.946, 0.892, 0.9388, 0.8992, 0.0, 0.5428, 0.0, 0.8704000000000001, 0.9352, 0.0, 0.9279999999999999, 0.0, 0.946, 0.9532, 0.8848, 0.9316, 0.8452, 0.9352, 0.9064], "episode_lengths": [16, 47, 32, 142, 250, 33, 22, 17, 85, 19, 15, 28, 15, 33, 21, 18, 29, 19, 33, 33, 36, 130, 35, 31, 21, 35, 230, 36, 28, 41, 40, 39, 25, 16, 32, 25, 25, 50, 40, 28, 23, 28, 23, 57, 19, 38, 2, 19, 18, 37, 44, 20, 28, 21, 19, 15, 30, 37, 13, 19, 19, 51, 19, 36, 19, 65, 19, 89, 23, 17, 16, 16, 26, 15, 25, 13, 5, 18, 25, 13, 17, 15, 30, 17, 28, 250, 127, 36, 36, 18, 11, 20, 6, 15, 13, 32, 19, 43, 18, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42973977792033097, "mean_inference_ms": 1.2156988540931837, "mean_action_processing_ms": 0.12233182320239422, "mean_env_wait_ms": 0.3627986382232977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005236387252807617, "ViewRequirementAgentConnector_ms": 0.144059419631958}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 30720, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 2647.701, "sample_time_ms": 344.158, "load_time_ms": 0.596, "load_throughput": 2148858.918, "learn_time_ms": 2290.984, "learn_throughput": 558.712, "synch_weights_time_ms": 11.381}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "episodes_total": 618, "training_iteration": 24, "trial_id": "7d771_00000", "date": "2023-08-04_22-41-29", "timestamp": 1691203289, "time_this_iter_s": 12.857110261917114, "time_total_s": 449.62771940231323, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 449.62771940231323, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 67.36315789473684, "ram_util_percent": 19.41052631578947}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7052239999999999, "episode_len_mean": 67.4, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 16, 16, 14, 13, 13, 250, 250, 13, 13, 6, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 6, 13, 13, 13, 13, 13, 250, 250, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 250, 13, 6, 13, 250, 13, 13, 13, 250, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2934717395370951, "mean_inference_ms": 0.8919950995995465, "mean_action_processing_ms": 0.09420108123774963, "mean_env_wait_ms": 0.30740364138426673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00508427619934082, "ViewRequirementAgentConnector_ms": 0.1499643325805664}, "clean_success_rate": 0.74, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.048920000000000005, "poison_episode_len_mean": 53.02, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [16, 14, 14, 14, 14, 14, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 6, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 6, 13, 13, 250, 13, 13, 13, 13, 250, 6, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 250, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2936393816763178, "mean_inference_ms": 0.8920424983255942, "mean_action_processing_ms": 0.09421121158245165, "mean_env_wait_ms": 0.30736722258426036, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.006371974945068359, "ViewRequirementAgentConnector_ms": 0.14533114433288574}, "poison_success_rate": 0.05, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45962502181529996, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.003860534066334367, "policy_loss": -0.049267544249693554, "vf_loss": 0.03253384924183289, "vf_explained_var": 0.732575972477595, "kl": 0.012714236657629954, "entropy": 0.7161023743947347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 3675.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7579560000000001, "episode_len_mean": 31.84, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8992, 0.9172, 0.0, 0.9316, 0.8632, 0.0, 0.9316, 0.9352, 0.8668, 0.8416, 0.9279999999999999, 0.8992, 0.9244, 0.9316, 0.946, 0.892, 0.8668, 0.9532, 0.9316, 0.9316, 0.8164, 0.9316, 0.8704000000000001, 0.9316, 0.0, 0.9316, 0.6796, 0.9172, 0.9388, 0.9424, 0.9424, 0.9064, 0.946, 0.91, 0.9532, 0.0, 0.9352, 0.91, 0.9532, 0.9388, 0.946, 0.892, 0.9388, 0.8992, 0.0, 0.5428, 0.0, 0.8704000000000001, 0.9352, 0.0, 0.9279999999999999, 0.0, 0.946, 0.9532, 0.8848, 0.9316, 0.8452, 0.9352, 0.9064, 0.9316, 0.9279999999999999, 0.91, 0.9352, 0.8812, 0.8775999999999999, 0.9316, 0.9172, 0.9532, 0.9316, 0.9244, 0.0, 0.9244, 0.0, 0.946, 0.28359999999999996, 0.9532, 0.9064, 0.9279999999999999, 0.9172, 0.9244, 0.0, 0.9532, 0.8271999999999999, 0.9496, 0.0, 0.892, 0.0, 0.9172, 0.9244, 0.0, 0.8956, 0.8775999999999999, 0.0, 0.9316, 0.8775999999999999, 0.9496, 0.0, 0.9424, 0.9279999999999999, 0.9244], "episode_lengths": [28, 23, 57, 19, 38, 2, 19, 18, 37, 44, 20, 28, 21, 19, 15, 30, 37, 13, 19, 19, 51, 19, 36, 19, 65, 19, 89, 23, 17, 16, 16, 26, 15, 25, 13, 5, 18, 25, 13, 17, 15, 30, 17, 28, 250, 127, 36, 36, 18, 11, 20, 6, 15, 13, 32, 19, 43, 18, 26, 19, 20, 25, 18, 33, 34, 19, 23, 13, 19, 21, 6, 21, 81, 15, 199, 13, 26, 20, 23, 21, 34, 13, 48, 14, 83, 30, 8, 23, 21, 10, 29, 34, 250, 19, 34, 14, 1, 16, 20, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43115104686316236, "mean_inference_ms": 1.2164780788854612, "mean_action_processing_ms": 0.12246093276667505, "mean_env_wait_ms": 0.36294840927370153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005007266998291016, "ViewRequirementAgentConnector_ms": 0.15636134147644043}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7579560000000001, "episode_len_mean": 31.84, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8992, 0.9172, 0.0, 0.9316, 0.8632, 0.0, 0.9316, 0.9352, 0.8668, 0.8416, 0.9279999999999999, 0.8992, 0.9244, 0.9316, 0.946, 0.892, 0.8668, 0.9532, 0.9316, 0.9316, 0.8164, 0.9316, 0.8704000000000001, 0.9316, 0.0, 0.9316, 0.6796, 0.9172, 0.9388, 0.9424, 0.9424, 0.9064, 0.946, 0.91, 0.9532, 0.0, 0.9352, 0.91, 0.9532, 0.9388, 0.946, 0.892, 0.9388, 0.8992, 0.0, 0.5428, 0.0, 0.8704000000000001, 0.9352, 0.0, 0.9279999999999999, 0.0, 0.946, 0.9532, 0.8848, 0.9316, 0.8452, 0.9352, 0.9064, 0.9316, 0.9279999999999999, 0.91, 0.9352, 0.8812, 0.8775999999999999, 0.9316, 0.9172, 0.9532, 0.9316, 0.9244, 0.0, 0.9244, 0.0, 0.946, 0.28359999999999996, 0.9532, 0.9064, 0.9279999999999999, 0.9172, 0.9244, 0.0, 0.9532, 0.8271999999999999, 0.9496, 0.0, 0.892, 0.0, 0.9172, 0.9244, 0.0, 0.8956, 0.8775999999999999, 0.0, 0.9316, 0.8775999999999999, 0.9496, 0.0, 0.9424, 0.9279999999999999, 0.9244], "episode_lengths": [28, 23, 57, 19, 38, 2, 19, 18, 37, 44, 20, 28, 21, 19, 15, 30, 37, 13, 19, 19, 51, 19, 36, 19, 65, 19, 89, 23, 17, 16, 16, 26, 15, 25, 13, 5, 18, 25, 13, 17, 15, 30, 17, 28, 250, 127, 36, 36, 18, 11, 20, 6, 15, 13, 32, 19, 43, 18, 26, 19, 20, 25, 18, 33, 34, 19, 23, 13, 19, 21, 6, 21, 81, 15, 199, 13, 26, 20, 23, 21, 34, 13, 48, 14, 83, 30, 8, 23, 21, 10, 29, 34, 250, 19, 34, 14, 1, 16, 20, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43115104686316236, "mean_inference_ms": 1.2164780788854612, "mean_action_processing_ms": 0.12246093276667505, "mean_env_wait_ms": 0.36294840927370153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005007266998291016, "ViewRequirementAgentConnector_ms": 0.15636134147644043}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 32000, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 2597.59, "sample_time_ms": 344.88, "load_time_ms": 0.565, "load_throughput": 2263558.951, "learn_time_ms": 2239.941, "learn_throughput": 571.444, "synch_weights_time_ms": 11.631}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 659, "training_iteration": 25, "trial_id": "7d771_00000", "date": "2023-08-04_22-41-41", "timestamp": 1691203301, "time_this_iter_s": 12.242575883865356, "time_total_s": 461.8702952861786, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 461.8702952861786, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 68.4764705882353, "ram_util_percent": 19.470588235294116}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7338919999999999, "episode_len_mean": 62.71, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 16, 14, 14, 14, 14, 13, 13, 250, 13, 13, 6, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 250, 13, 250, 250, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 6, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29386642226235105, "mean_inference_ms": 0.8923206782615308, "mean_action_processing_ms": 0.09422331794754828, "mean_env_wait_ms": 0.30738452139352407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00475311279296875, "ViewRequirementAgentConnector_ms": 0.1350252628326416}, "clean_success_rate": 0.77, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 77.05, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 250, 13, 13, 250, 250, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 250, 250, 13, 250, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29393186546279765, "mean_inference_ms": 0.892109959164602, "mean_action_processing_ms": 0.0942039780211516, "mean_env_wait_ms": 0.3072872661492453, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004571199417114258, "ViewRequirementAgentConnector_ms": 0.12380695343017578}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44516973276933036, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.014135421660418312, "policy_loss": -0.05041682563722134, "vf_loss": 0.023326399456709623, "vf_explained_var": 0.6721791438261668, "kl": 0.01279506637622641, "entropy": 0.7089700865745544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 3825.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7463279999999999, "episode_len_mean": 36.35, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.892, 0.9388, 0.8992, 0.0, 0.5428, 0.0, 0.8704000000000001, 0.9352, 0.0, 0.9279999999999999, 0.0, 0.946, 0.9532, 0.8848, 0.9316, 0.8452, 0.9352, 0.9064, 0.9316, 0.9279999999999999, 0.91, 0.9352, 0.8812, 0.8775999999999999, 0.9316, 0.9172, 0.9532, 0.9316, 0.9244, 0.0, 0.9244, 0.0, 0.946, 0.28359999999999996, 0.9532, 0.9064, 0.9279999999999999, 0.9172, 0.9244, 0.0, 0.9532, 0.8271999999999999, 0.9496, 0.0, 0.892, 0.0, 0.9172, 0.9244, 0.0, 0.8956, 0.8775999999999999, 0.0, 0.9316, 0.8775999999999999, 0.9496, 0.0, 0.9424, 0.9279999999999999, 0.9244, 0.0, 0.0, 0.9532, 0.9279999999999999, 0.0, 0.946, 0.9028, 0.8992, 0.9532, 0.9028, 0.856, 0.9532, 0.0, 0.874, 0.874, 0.9532, 0.9532, 0.9244, 0.9496, 0.8704000000000001, 0.9532, 0.9532, 0.9532, 0.9172, 0.9532, 0.29079999999999995, 0.9208000000000001, 0.8236, 0.6184000000000001, 0.9352, 0.9244, 0.9064, 0.8524, 0.9244, 0.7515999999999999, 0.946, 0.4708, 0.9532, 0.9136, 0.9279999999999999], "episode_lengths": [15, 30, 17, 28, 250, 127, 36, 36, 18, 11, 20, 6, 15, 13, 32, 19, 43, 18, 26, 19, 20, 25, 18, 33, 34, 19, 23, 13, 19, 21, 6, 21, 81, 15, 199, 13, 26, 20, 23, 21, 34, 13, 48, 14, 83, 30, 8, 23, 21, 10, 29, 34, 250, 19, 34, 14, 1, 16, 20, 21, 132, 76, 13, 20, 26, 15, 27, 28, 13, 27, 40, 13, 23, 35, 35, 13, 13, 21, 14, 36, 13, 13, 13, 23, 13, 197, 22, 49, 106, 18, 21, 26, 41, 21, 69, 15, 147, 13, 24, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4321762198462272, "mean_inference_ms": 1.2181207183045621, "mean_action_processing_ms": 0.12229545864725763, "mean_env_wait_ms": 0.36285841677203723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049054622650146484, "ViewRequirementAgentConnector_ms": 0.14915204048156738}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7463279999999999, "episode_len_mean": 36.35, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.946, 0.892, 0.9388, 0.8992, 0.0, 0.5428, 0.0, 0.8704000000000001, 0.9352, 0.0, 0.9279999999999999, 0.0, 0.946, 0.9532, 0.8848, 0.9316, 0.8452, 0.9352, 0.9064, 0.9316, 0.9279999999999999, 0.91, 0.9352, 0.8812, 0.8775999999999999, 0.9316, 0.9172, 0.9532, 0.9316, 0.9244, 0.0, 0.9244, 0.0, 0.946, 0.28359999999999996, 0.9532, 0.9064, 0.9279999999999999, 0.9172, 0.9244, 0.0, 0.9532, 0.8271999999999999, 0.9496, 0.0, 0.892, 0.0, 0.9172, 0.9244, 0.0, 0.8956, 0.8775999999999999, 0.0, 0.9316, 0.8775999999999999, 0.9496, 0.0, 0.9424, 0.9279999999999999, 0.9244, 0.0, 0.0, 0.9532, 0.9279999999999999, 0.0, 0.946, 0.9028, 0.8992, 0.9532, 0.9028, 0.856, 0.9532, 0.0, 0.874, 0.874, 0.9532, 0.9532, 0.9244, 0.9496, 0.8704000000000001, 0.9532, 0.9532, 0.9532, 0.9172, 0.9532, 0.29079999999999995, 0.9208000000000001, 0.8236, 0.6184000000000001, 0.9352, 0.9244, 0.9064, 0.8524, 0.9244, 0.7515999999999999, 0.946, 0.4708, 0.9532, 0.9136, 0.9279999999999999], "episode_lengths": [15, 30, 17, 28, 250, 127, 36, 36, 18, 11, 20, 6, 15, 13, 32, 19, 43, 18, 26, 19, 20, 25, 18, 33, 34, 19, 23, 13, 19, 21, 6, 21, 81, 15, 199, 13, 26, 20, 23, 21, 34, 13, 48, 14, 83, 30, 8, 23, 21, 10, 29, 34, 250, 19, 34, 14, 1, 16, 20, 21, 132, 76, 13, 20, 26, 15, 27, 28, 13, 27, 40, 13, 23, 35, 35, 13, 13, 21, 14, 36, 13, 13, 13, 23, 13, 197, 22, 49, 106, 18, 21, 26, 41, 21, 69, 15, 147, 13, 24, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4321762198462272, "mean_inference_ms": 1.2181207183045621, "mean_action_processing_ms": 0.12229545864725763, "mean_env_wait_ms": 0.36285841677203723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049054622650146484, "ViewRequirementAgentConnector_ms": 0.14915204048156738}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 33280, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 33280, "timers": {"training_iteration_time_ms": 2592.484, "sample_time_ms": 338.893, "load_time_ms": 0.538, "load_throughput": 2378481.8, "learn_time_ms": 2240.158, "learn_throughput": 571.388, "synch_weights_time_ms": 12.325}, "counters": {"num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "done": false, "episodes_total": 699, "training_iteration": 26, "trial_id": "7d771_00000", "date": "2023-08-04_22-41-56", "timestamp": 1691203316, "time_this_iter_s": 14.337300777435303, "time_total_s": 476.2075960636139, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 476.2075960636139, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 68.05238095238094, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8006879999999998, "episode_len_mean": 43.66, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 6, 13, 250, 13, 13, 250, 13, 6, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29415467278184193, "mean_inference_ms": 0.8923338160928406, "mean_action_processing_ms": 0.09423740813839374, "mean_env_wait_ms": 0.3073688563581356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008095026016235352, "ViewRequirementAgentConnector_ms": 0.1594550609588623}, "clean_success_rate": 0.84, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 58.02, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 250, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 6, 13, 13, 13, 250, 250, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2943669322288961, "mean_inference_ms": 0.8925375070144288, "mean_action_processing_ms": 0.09426886118239965, "mean_env_wait_ms": 0.3073277338283529, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004817485809326172, "ViewRequirementAgentConnector_ms": 0.1489572525024414}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.373304247657458, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.003887863035003344, "policy_loss": -0.046033807893594104, "vf_loss": 0.031603292214373746, "vf_explained_var": 0.7029633132616678, "kl": 0.010412497264927273, "entropy": 0.7223558859030406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 3975.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 34560, "num_env_steps_trained": 34560, "num_agent_steps_sampled": 34560, "num_agent_steps_trained": 34560}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8065439999999998, "episode_len_mean": 32.39, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9064, 0.9279999999999999, 0.9172, 0.9244, 0.0, 0.9532, 0.8271999999999999, 0.9496, 0.0, 0.892, 0.0, 0.9172, 0.9244, 0.0, 0.8956, 0.8775999999999999, 0.0, 0.9316, 0.8775999999999999, 0.9496, 0.0, 0.9424, 0.9279999999999999, 0.9244, 0.0, 0.0, 0.9532, 0.9279999999999999, 0.0, 0.946, 0.9028, 0.8992, 0.9532, 0.9028, 0.856, 0.9532, 0.0, 0.874, 0.874, 0.9532, 0.9532, 0.9244, 0.9496, 0.8704000000000001, 0.9532, 0.9532, 0.9532, 0.9172, 0.9532, 0.29079999999999995, 0.9208000000000001, 0.8236, 0.6184000000000001, 0.9352, 0.9244, 0.9064, 0.8524, 0.9244, 0.7515999999999999, 0.946, 0.4708, 0.9532, 0.9136, 0.9279999999999999, 0.9172, 0.9532, 0.946, 0.946, 0.9028, 0.9388, 0.7984, 0.9388, 0.9136, 0.946, 0.9244, 0.9208000000000001, 0.8848, 0.9244, 0.8775999999999999, 0.8488, 0.9388, 0.9208000000000001, 0.9316, 0.9352, 0.9208000000000001, 0.91, 0.9388, 0.6508, 0.8308, 0.946, 0.874, 0.8524, 0.8956, 0.8992, 0.9244, 0.9532, 0.9532, 0.8596, 0.9352], "episode_lengths": [13, 26, 20, 23, 21, 34, 13, 48, 14, 83, 30, 8, 23, 21, 10, 29, 34, 250, 19, 34, 14, 1, 16, 20, 21, 132, 76, 13, 20, 26, 15, 27, 28, 13, 27, 40, 13, 23, 35, 35, 13, 13, 21, 14, 36, 13, 13, 13, 23, 13, 197, 22, 49, 106, 18, 21, 26, 41, 21, 69, 15, 147, 13, 24, 20, 23, 13, 15, 15, 27, 17, 56, 17, 24, 15, 21, 22, 32, 21, 34, 42, 17, 22, 19, 18, 22, 25, 17, 97, 47, 15, 35, 41, 29, 28, 21, 13, 13, 39, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4341127541254523, "mean_inference_ms": 1.223960922359034, "mean_action_processing_ms": 0.12264132465752178, "mean_env_wait_ms": 0.36391088627789014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049669742584228516, "ViewRequirementAgentConnector_ms": 0.17168378829956055}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8065439999999998, "episode_len_mean": 32.39, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9064, 0.9279999999999999, 0.9172, 0.9244, 0.0, 0.9532, 0.8271999999999999, 0.9496, 0.0, 0.892, 0.0, 0.9172, 0.9244, 0.0, 0.8956, 0.8775999999999999, 0.0, 0.9316, 0.8775999999999999, 0.9496, 0.0, 0.9424, 0.9279999999999999, 0.9244, 0.0, 0.0, 0.9532, 0.9279999999999999, 0.0, 0.946, 0.9028, 0.8992, 0.9532, 0.9028, 0.856, 0.9532, 0.0, 0.874, 0.874, 0.9532, 0.9532, 0.9244, 0.9496, 0.8704000000000001, 0.9532, 0.9532, 0.9532, 0.9172, 0.9532, 0.29079999999999995, 0.9208000000000001, 0.8236, 0.6184000000000001, 0.9352, 0.9244, 0.9064, 0.8524, 0.9244, 0.7515999999999999, 0.946, 0.4708, 0.9532, 0.9136, 0.9279999999999999, 0.9172, 0.9532, 0.946, 0.946, 0.9028, 0.9388, 0.7984, 0.9388, 0.9136, 0.946, 0.9244, 0.9208000000000001, 0.8848, 0.9244, 0.8775999999999999, 0.8488, 0.9388, 0.9208000000000001, 0.9316, 0.9352, 0.9208000000000001, 0.91, 0.9388, 0.6508, 0.8308, 0.946, 0.874, 0.8524, 0.8956, 0.8992, 0.9244, 0.9532, 0.9532, 0.8596, 0.9352], "episode_lengths": [13, 26, 20, 23, 21, 34, 13, 48, 14, 83, 30, 8, 23, 21, 10, 29, 34, 250, 19, 34, 14, 1, 16, 20, 21, 132, 76, 13, 20, 26, 15, 27, 28, 13, 27, 40, 13, 23, 35, 35, 13, 13, 21, 14, 36, 13, 13, 13, 23, 13, 197, 22, 49, 106, 18, 21, 26, 41, 21, 69, 15, 147, 13, 24, 20, 23, 13, 15, 15, 27, 17, 56, 17, 24, 15, 21, 22, 32, 21, 34, 42, 17, 22, 19, 18, 22, 25, 17, 97, 47, 15, 35, 41, 29, 28, 21, 13, 13, 39, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4341127541254523, "mean_inference_ms": 1.223960922359034, "mean_action_processing_ms": 0.12264132465752178, "mean_env_wait_ms": 0.36391088627789014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049669742584228516, "ViewRequirementAgentConnector_ms": 0.17168378829956055}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34560, "num_agent_steps_trained": 34560, "num_env_steps_sampled": 34560, "num_env_steps_trained": 34560, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 34560, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 34560, "timers": {"training_iteration_time_ms": 2548.528, "sample_time_ms": 346.408, "load_time_ms": 0.527, "load_throughput": 2429060.32, "learn_time_ms": 2188.139, "learn_throughput": 584.972, "synch_weights_time_ms": 12.897}, "counters": {"num_env_steps_sampled": 34560, "num_env_steps_trained": 34560, "num_agent_steps_sampled": 34560, "num_agent_steps_trained": 34560}, "done": false, "episodes_total": 734, "training_iteration": 27, "trial_id": "7d771_00000", "date": "2023-08-04_22-42-06", "timestamp": 1691203326, "time_this_iter_s": 10.302777528762817, "time_total_s": 486.5103735923767, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 486.5103735923767, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 68.24285714285715, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7908679999999998, "episode_len_mean": 46.11, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 6, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 6, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 15, 6, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 15, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2946579531705703, "mean_inference_ms": 0.892933675641786, "mean_action_processing_ms": 0.094327159286455, "mean_env_wait_ms": 0.30732142179212846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0051004886627197266, "ViewRequirementAgentConnector_ms": 0.13997960090637207}, "clean_success_rate": 0.83, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 60.38, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 16, 18, 250, 13, 13, 13, 13, 6, 250, 250, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29480766939312597, "mean_inference_ms": 0.8929537532439737, "mean_action_processing_ms": 0.09434655648837242, "mean_env_wait_ms": 0.30729378170357063, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0048673152923583984, "ViewRequirementAgentConnector_ms": 0.14090633392333984}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4618468012412389, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.007271433522303899, "policy_loss": -0.04766685167948405, "vf_loss": 0.026689148017515738, "vf_explained_var": 0.5859929613272349, "kl": 0.013537057382660957, "entropy": 0.721315184434255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 4125.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8317199999999998, "episode_len_mean": 33.9, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9244, 0.9496, 0.8704000000000001, 0.9532, 0.9532, 0.9532, 0.9172, 0.9532, 0.29079999999999995, 0.9208000000000001, 0.8236, 0.6184000000000001, 0.9352, 0.9244, 0.9064, 0.8524, 0.9244, 0.7515999999999999, 0.946, 0.4708, 0.9532, 0.9136, 0.9279999999999999, 0.9172, 0.9532, 0.946, 0.946, 0.9028, 0.9388, 0.7984, 0.9388, 0.9136, 0.946, 0.9244, 0.9208000000000001, 0.8848, 0.9244, 0.8775999999999999, 0.8488, 0.9388, 0.9208000000000001, 0.9316, 0.9352, 0.9208000000000001, 0.91, 0.9388, 0.6508, 0.8308, 0.946, 0.874, 0.8524, 0.8956, 0.8992, 0.9244, 0.9532, 0.9532, 0.8596, 0.9352, 0.0, 0.8236, 0.7948, 0.9352, 0.9388, 0.9532, 0.892, 0.9532, 0.946, 0.9244, 0.946, 0.5356, 0.946, 0.9532, 0.9352, 0.946, 0.9208000000000001, 0.82, 0.9316, 0.0, 0.9496, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9244, 0.0, 0.9352, 0.8092, 0.9388, 0.9496, 0.91, 0.9352, 0.946, 0.0, 0.8992, 0.9532, 0.874, 0.0], "episode_lengths": [13, 13, 21, 14, 36, 13, 13, 13, 23, 13, 197, 22, 49, 106, 18, 21, 26, 41, 21, 69, 15, 147, 13, 24, 20, 23, 13, 15, 15, 27, 17, 56, 17, 24, 15, 21, 22, 32, 21, 34, 42, 17, 22, 19, 18, 22, 25, 17, 97, 47, 15, 35, 41, 29, 28, 21, 13, 13, 39, 18, 55, 49, 57, 18, 17, 13, 30, 13, 15, 21, 15, 129, 15, 13, 18, 15, 22, 50, 19, 250, 14, 13, 13, 5, 13, 71, 21, 14, 18, 53, 17, 14, 25, 18, 15, 15, 28, 13, 35, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4345098118281188, "mean_inference_ms": 1.2176658008649761, "mean_action_processing_ms": 0.12199839507646622, "mean_env_wait_ms": 0.36320466688443304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049114227294921875, "ViewRequirementAgentConnector_ms": 0.1728222370147705}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8317199999999998, "episode_len_mean": 33.9, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9244, 0.9496, 0.8704000000000001, 0.9532, 0.9532, 0.9532, 0.9172, 0.9532, 0.29079999999999995, 0.9208000000000001, 0.8236, 0.6184000000000001, 0.9352, 0.9244, 0.9064, 0.8524, 0.9244, 0.7515999999999999, 0.946, 0.4708, 0.9532, 0.9136, 0.9279999999999999, 0.9172, 0.9532, 0.946, 0.946, 0.9028, 0.9388, 0.7984, 0.9388, 0.9136, 0.946, 0.9244, 0.9208000000000001, 0.8848, 0.9244, 0.8775999999999999, 0.8488, 0.9388, 0.9208000000000001, 0.9316, 0.9352, 0.9208000000000001, 0.91, 0.9388, 0.6508, 0.8308, 0.946, 0.874, 0.8524, 0.8956, 0.8992, 0.9244, 0.9532, 0.9532, 0.8596, 0.9352, 0.0, 0.8236, 0.7948, 0.9352, 0.9388, 0.9532, 0.892, 0.9532, 0.946, 0.9244, 0.946, 0.5356, 0.946, 0.9532, 0.9352, 0.946, 0.9208000000000001, 0.82, 0.9316, 0.0, 0.9496, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9244, 0.0, 0.9352, 0.8092, 0.9388, 0.9496, 0.91, 0.9352, 0.946, 0.0, 0.8992, 0.9532, 0.874, 0.0], "episode_lengths": [13, 13, 21, 14, 36, 13, 13, 13, 23, 13, 197, 22, 49, 106, 18, 21, 26, 41, 21, 69, 15, 147, 13, 24, 20, 23, 13, 15, 15, 27, 17, 56, 17, 24, 15, 21, 22, 32, 21, 34, 42, 17, 22, 19, 18, 22, 25, 17, 97, 47, 15, 35, 41, 29, 28, 21, 13, 13, 39, 18, 55, 49, 57, 18, 17, 13, 30, 13, 15, 21, 15, 129, 15, 13, 18, 15, 22, 50, 19, 250, 14, 13, 13, 5, 13, 71, 21, 14, 18, 53, 17, 14, 25, 18, 15, 15, 28, 13, 35, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4345098118281188, "mean_inference_ms": 1.2176658008649761, "mean_action_processing_ms": 0.12199839507646622, "mean_env_wait_ms": 0.36320466688443304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049114227294921875, "ViewRequirementAgentConnector_ms": 0.1728222370147705}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 35840, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 2524.609, "sample_time_ms": 343.963, "load_time_ms": 0.508, "load_throughput": 2517329.732, "learn_time_ms": 2167.566, "learn_throughput": 590.524, "synch_weights_time_ms": 12.034}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "episodes_total": 774, "training_iteration": 28, "trial_id": "7d771_00000", "date": "2023-08-04_22-42-18", "timestamp": 1691203338, "time_this_iter_s": 11.498351097106934, "time_total_s": 498.00872468948364, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 498.00872468948364, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 67.48235294117649, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.733676, "episode_len_mean": 57.89, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532], "episode_lengths": [14, 18, 16, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 250, 15, 250, 13, 250, 250, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 6, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2951345608520506, "mean_inference_ms": 0.8933822940650018, "mean_action_processing_ms": 0.09440089635600024, "mean_env_wait_ms": 0.3073491820139082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004973173141479492, "ViewRequirementAgentConnector_ms": 0.15405702590942383}, "clean_success_rate": 0.77, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 53.28, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2952775933628189, "mean_inference_ms": 0.8933482455644419, "mean_action_processing_ms": 0.09439318341230349, "mean_env_wait_ms": 0.3072461765577984, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004934072494506836, "ViewRequirementAgentConnector_ms": 0.13609766960144043}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4059009337425232, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.007795121148228645, "policy_loss": -0.05178344176461299, "vf_loss": 0.031513465146223704, "vf_explained_var": 0.5482637882232666, "kl": 0.012320846123317703, "entropy": 0.7106932973861695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 4275.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 37120, "num_env_steps_trained": 37120, "num_agent_steps_sampled": 37120, "num_agent_steps_trained": 37120}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8240680000000001, "episode_len_mean": 33.12, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8488, 0.9388, 0.9208000000000001, 0.9316, 0.9352, 0.9208000000000001, 0.91, 0.9388, 0.6508, 0.8308, 0.946, 0.874, 0.8524, 0.8956, 0.8992, 0.9244, 0.9532, 0.9532, 0.8596, 0.9352, 0.0, 0.8236, 0.7948, 0.9352, 0.9388, 0.9532, 0.892, 0.9532, 0.946, 0.9244, 0.946, 0.5356, 0.946, 0.9532, 0.9352, 0.946, 0.9208000000000001, 0.82, 0.9316, 0.0, 0.9496, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9244, 0.0, 0.9352, 0.8092, 0.9388, 0.9496, 0.91, 0.9352, 0.946, 0.0, 0.8992, 0.9532, 0.874, 0.0, 0.9496, 0.9352, 0.8956, 0.9028, 0.9136, 0.9532, 0.8848, 0.8992, 0.9532, 0.8668, 0.9388, 0.874, 0.946, 0.946, 0.0, 0.874, 0.91, 0.9136, 0.838, 0.9532, 0.9208000000000001, 0.6759999999999999, 0.9532, 0.892, 0.9388, 0.9316, 0.9352, 0.8884, 0.9388, 0.9388, 0.9316, 0.9279999999999999, 0.9388, 0.0, 0.9279999999999999, 0.9532, 0.9136, 0.6759999999999999, 0.946, 0.9316], "episode_lengths": [42, 17, 22, 19, 18, 22, 25, 17, 97, 47, 15, 35, 41, 29, 28, 21, 13, 13, 39, 18, 55, 49, 57, 18, 17, 13, 30, 13, 15, 21, 15, 129, 15, 13, 18, 15, 22, 50, 19, 250, 14, 13, 13, 5, 13, 71, 21, 14, 18, 53, 17, 14, 25, 18, 15, 15, 28, 13, 35, 250, 14, 18, 29, 27, 24, 13, 32, 28, 13, 37, 17, 35, 15, 15, 250, 35, 25, 24, 45, 13, 22, 90, 13, 30, 17, 19, 18, 31, 17, 17, 19, 20, 17, 15, 20, 13, 24, 90, 15, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43428347090810837, "mean_inference_ms": 1.21688684429608, "mean_action_processing_ms": 0.12090843941546742, "mean_env_wait_ms": 0.36415353727111727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004915952682495117, "ViewRequirementAgentConnector_ms": 0.17592906951904297}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8240680000000001, "episode_len_mean": 33.12, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8488, 0.9388, 0.9208000000000001, 0.9316, 0.9352, 0.9208000000000001, 0.91, 0.9388, 0.6508, 0.8308, 0.946, 0.874, 0.8524, 0.8956, 0.8992, 0.9244, 0.9532, 0.9532, 0.8596, 0.9352, 0.0, 0.8236, 0.7948, 0.9352, 0.9388, 0.9532, 0.892, 0.9532, 0.946, 0.9244, 0.946, 0.5356, 0.946, 0.9532, 0.9352, 0.946, 0.9208000000000001, 0.82, 0.9316, 0.0, 0.9496, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9244, 0.0, 0.9352, 0.8092, 0.9388, 0.9496, 0.91, 0.9352, 0.946, 0.0, 0.8992, 0.9532, 0.874, 0.0, 0.9496, 0.9352, 0.8956, 0.9028, 0.9136, 0.9532, 0.8848, 0.8992, 0.9532, 0.8668, 0.9388, 0.874, 0.946, 0.946, 0.0, 0.874, 0.91, 0.9136, 0.838, 0.9532, 0.9208000000000001, 0.6759999999999999, 0.9532, 0.892, 0.9388, 0.9316, 0.9352, 0.8884, 0.9388, 0.9388, 0.9316, 0.9279999999999999, 0.9388, 0.0, 0.9279999999999999, 0.9532, 0.9136, 0.6759999999999999, 0.946, 0.9316], "episode_lengths": [42, 17, 22, 19, 18, 22, 25, 17, 97, 47, 15, 35, 41, 29, 28, 21, 13, 13, 39, 18, 55, 49, 57, 18, 17, 13, 30, 13, 15, 21, 15, 129, 15, 13, 18, 15, 22, 50, 19, 250, 14, 13, 13, 5, 13, 71, 21, 14, 18, 53, 17, 14, 25, 18, 15, 15, 28, 13, 35, 250, 14, 18, 29, 27, 24, 13, 32, 28, 13, 37, 17, 35, 15, 15, 250, 35, 25, 24, 45, 13, 22, 90, 13, 30, 17, 19, 18, 31, 17, 17, 19, 20, 17, 15, 20, 13, 24, 90, 15, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43428347090810837, "mean_inference_ms": 1.21688684429608, "mean_action_processing_ms": 0.12090843941546742, "mean_env_wait_ms": 0.36415353727111727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004915952682495117, "ViewRequirementAgentConnector_ms": 0.17592906951904297}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37120, "num_agent_steps_trained": 37120, "num_env_steps_sampled": 37120, "num_env_steps_trained": 37120, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 37120, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 37120, "timers": {"training_iteration_time_ms": 2476.815, "sample_time_ms": 341.789, "load_time_ms": 0.512, "load_throughput": 2502428.041, "learn_time_ms": 2122.151, "learn_throughput": 603.162, "synch_weights_time_ms": 11.825}, "counters": {"num_env_steps_sampled": 37120, "num_env_steps_trained": 37120, "num_agent_steps_sampled": 37120, "num_agent_steps_trained": 37120}, "done": false, "episodes_total": 814, "training_iteration": 29, "trial_id": "7d771_00000", "date": "2023-08-04_22-42-28", "timestamp": 1691203348, "time_this_iter_s": 10.623056173324585, "time_total_s": 508.6317808628082, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 508.6317808628082, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 67.11999999999999, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7720199999999998, "episode_len_mean": 53.23, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0], "episode_lengths": [14, 16, 14, 14, 14, 14, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 6, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29571699990033296, "mean_inference_ms": 0.893764342312407, "mean_action_processing_ms": 0.09445107159564771, "mean_env_wait_ms": 0.30730116340034747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.006467580795288086, "ViewRequirementAgentConnector_ms": 0.17383575439453125}, "clean_success_rate": 0.81, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 55.76, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 18, 14, 14, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 250, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29606840616771457, "mean_inference_ms": 0.894017704383362, "mean_action_processing_ms": 0.09447820075495292, "mean_env_wait_ms": 0.3074537974278414, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0047299861907958984, "ViewRequirementAgentConnector_ms": 0.13004398345947266}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42557582626740137, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.012448101739088694, "policy_loss": -0.045842502117156986, "vf_loss": 0.022061980223904053, "vf_explained_var": 0.6721045597394307, "kl": 0.01119251647613055, "entropy": 0.6916483211517334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 4425.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.802232, "episode_len_mean": 33.43, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.0, 0.9532, 0.0, 0.9244, 0.0, 0.9352, 0.8092, 0.9388, 0.9496, 0.91, 0.9352, 0.946, 0.0, 0.8992, 0.9532, 0.874, 0.0, 0.9496, 0.9352, 0.8956, 0.9028, 0.9136, 0.9532, 0.8848, 0.8992, 0.9532, 0.8668, 0.9388, 0.874, 0.946, 0.946, 0.0, 0.874, 0.91, 0.9136, 0.838, 0.9532, 0.9208000000000001, 0.6759999999999999, 0.9532, 0.892, 0.9388, 0.9316, 0.9352, 0.8884, 0.9388, 0.9388, 0.9316, 0.9279999999999999, 0.9388, 0.0, 0.9279999999999999, 0.9532, 0.9136, 0.6759999999999999, 0.946, 0.9316, 0.9316, 0.9532, 0.6544, 0.6436, 0.9244, 0.9424, 0.9496, 0.9064, 0.7948, 0.946, 0.4276, 0.946, 0.9496, 0.9352, 0.9388, 0.9532, 0.91, 0.9532, 0.0, 0.9136, 0.9388, 0.946, 0.9244, 0.892, 0.9388, 0.946, 0.9388, 0.0, 0.8884, 0.9208000000000001, 0.6075999999999999, 0.9388, 0.0, 0.0, 0.91, 0.9064, 0.9028, 0.9316, 0.9172, 0.8992, 0.9316, 0.8812], "episode_lengths": [13, 5, 13, 71, 21, 14, 18, 53, 17, 14, 25, 18, 15, 15, 28, 13, 35, 250, 14, 18, 29, 27, 24, 13, 32, 28, 13, 37, 17, 35, 15, 15, 250, 35, 25, 24, 45, 13, 22, 90, 13, 30, 17, 19, 18, 31, 17, 17, 19, 20, 17, 15, 20, 13, 24, 90, 15, 19, 19, 13, 96, 99, 21, 16, 14, 26, 57, 15, 159, 15, 14, 18, 17, 13, 25, 13, 8, 24, 17, 15, 21, 30, 17, 15, 17, 10, 31, 22, 109, 17, 20, 247, 25, 26, 27, 19, 23, 28, 19, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4363930588085221, "mean_inference_ms": 1.2239677945886158, "mean_action_processing_ms": 0.1204373015953982, "mean_env_wait_ms": 0.3666278961148956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004996538162231445, "ViewRequirementAgentConnector_ms": 0.2082653045654297}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.802232, "episode_len_mean": 33.43, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.0, 0.9532, 0.0, 0.9244, 0.0, 0.9352, 0.8092, 0.9388, 0.9496, 0.91, 0.9352, 0.946, 0.0, 0.8992, 0.9532, 0.874, 0.0, 0.9496, 0.9352, 0.8956, 0.9028, 0.9136, 0.9532, 0.8848, 0.8992, 0.9532, 0.8668, 0.9388, 0.874, 0.946, 0.946, 0.0, 0.874, 0.91, 0.9136, 0.838, 0.9532, 0.9208000000000001, 0.6759999999999999, 0.9532, 0.892, 0.9388, 0.9316, 0.9352, 0.8884, 0.9388, 0.9388, 0.9316, 0.9279999999999999, 0.9388, 0.0, 0.9279999999999999, 0.9532, 0.9136, 0.6759999999999999, 0.946, 0.9316, 0.9316, 0.9532, 0.6544, 0.6436, 0.9244, 0.9424, 0.9496, 0.9064, 0.7948, 0.946, 0.4276, 0.946, 0.9496, 0.9352, 0.9388, 0.9532, 0.91, 0.9532, 0.0, 0.9136, 0.9388, 0.946, 0.9244, 0.892, 0.9388, 0.946, 0.9388, 0.0, 0.8884, 0.9208000000000001, 0.6075999999999999, 0.9388, 0.0, 0.0, 0.91, 0.9064, 0.9028, 0.9316, 0.9172, 0.8992, 0.9316, 0.8812], "episode_lengths": [13, 5, 13, 71, 21, 14, 18, 53, 17, 14, 25, 18, 15, 15, 28, 13, 35, 250, 14, 18, 29, 27, 24, 13, 32, 28, 13, 37, 17, 35, 15, 15, 250, 35, 25, 24, 45, 13, 22, 90, 13, 30, 17, 19, 18, 31, 17, 17, 19, 20, 17, 15, 20, 13, 24, 90, 15, 19, 19, 13, 96, 99, 21, 16, 14, 26, 57, 15, 159, 15, 14, 18, 17, 13, 25, 13, 8, 24, 17, 15, 21, 30, 17, 15, 17, 10, 31, 22, 109, 17, 20, 247, 25, 26, 27, 19, 23, 28, 19, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4363930588085221, "mean_inference_ms": 1.2239677945886158, "mean_action_processing_ms": 0.1204373015953982, "mean_env_wait_ms": 0.3666278961148956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004996538162231445, "ViewRequirementAgentConnector_ms": 0.2082653045654297}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 38400, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 2516.89, "sample_time_ms": 357.356, "load_time_ms": 0.528, "load_throughput": 2425110.272, "learn_time_ms": 2145.423, "learn_throughput": 596.619, "synch_weights_time_ms": 13.032}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "done": false, "episodes_total": 856, "training_iteration": 30, "trial_id": "7d771_00000", "date": "2023-08-04_22-42-41", "timestamp": 1691203361, "time_this_iter_s": 12.476594924926758, "time_total_s": 521.108375787735, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 521.108375787735, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 70.51666666666667, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8006159999999999, "episode_len_mean": 48.56, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 16, 14, 14, 14, 14, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 6, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29633731341606995, "mean_inference_ms": 0.8944949987847991, "mean_action_processing_ms": 0.09450422271837468, "mean_env_wait_ms": 0.3076676082037575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005056142807006836, "ViewRequirementAgentConnector_ms": 0.15012907981872559}, "clean_success_rate": 0.84, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 48.69, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [16, 16, 14, 14, 14, 18, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29654457957536495, "mean_inference_ms": 0.8947277485875368, "mean_action_processing_ms": 0.09450550431585139, "mean_env_wait_ms": 0.3077414905517922, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004768848419189453, "ViewRequirementAgentConnector_ms": 0.1238243579864502}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46059396644433337, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.0016299469831089178, "policy_loss": -0.04962150108690063, "vf_loss": 0.033245061188936234, "vf_explained_var": 0.43766948342323303, "kl": 0.014564434926772568, "entropy": 0.7408481931686401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 4575.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 39680, "num_env_steps_trained": 39680, "num_agent_steps_sampled": 39680, "num_agent_steps_trained": 39680}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.824808, "episode_len_mean": 34.78, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.874, 0.91, 0.9136, 0.838, 0.9532, 0.9208000000000001, 0.6759999999999999, 0.9532, 0.892, 0.9388, 0.9316, 0.9352, 0.8884, 0.9388, 0.9388, 0.9316, 0.9279999999999999, 0.9388, 0.0, 0.9279999999999999, 0.9532, 0.9136, 0.6759999999999999, 0.946, 0.9316, 0.9316, 0.9532, 0.6544, 0.6436, 0.9244, 0.9424, 0.9496, 0.9064, 0.7948, 0.946, 0.4276, 0.946, 0.9496, 0.9352, 0.9388, 0.9532, 0.91, 0.9532, 0.0, 0.9136, 0.9388, 0.946, 0.9244, 0.892, 0.9388, 0.946, 0.9388, 0.0, 0.8884, 0.9208000000000001, 0.6075999999999999, 0.9388, 0.0, 0.0, 0.91, 0.9064, 0.9028, 0.9316, 0.9172, 0.8992, 0.9316, 0.8812, 0.8704000000000001, 0.6616, 0.9208000000000001, 0.9388, 0.6436, 0.7372000000000001, 0.9532, 0.9172, 0.9532, 0.6472, 0.892, 0.9064, 0.7767999999999999, 0.91, 0.9316, 0.9208000000000001, 0.8704000000000001, 0.9388, 0.9244, 0.946, 0.9244, 0.8848, 0.946, 0.9028, 0.9279999999999999, 0.9279999999999999, 0.0, 0.73, 0.9532, 0.9208000000000001, 0.7804, 0.9388], "episode_lengths": [250, 35, 25, 24, 45, 13, 22, 90, 13, 30, 17, 19, 18, 31, 17, 17, 19, 20, 17, 15, 20, 13, 24, 90, 15, 19, 19, 13, 96, 99, 21, 16, 14, 26, 57, 15, 159, 15, 14, 18, 17, 13, 25, 13, 8, 24, 17, 15, 21, 30, 17, 15, 17, 10, 31, 22, 109, 17, 20, 247, 25, 26, 27, 19, 23, 28, 19, 33, 36, 94, 22, 17, 99, 73, 13, 23, 13, 98, 30, 26, 62, 25, 19, 22, 36, 17, 21, 15, 21, 32, 15, 27, 20, 20, 6, 75, 13, 22, 61, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43924990531839464, "mean_inference_ms": 1.2314251029244285, "mean_action_processing_ms": 0.12116052054007262, "mean_env_wait_ms": 0.3683029094705411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005121946334838867, "ViewRequirementAgentConnector_ms": 0.2085723876953125}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.824808, "episode_len_mean": 34.78, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0, 0.874, 0.91, 0.9136, 0.838, 0.9532, 0.9208000000000001, 0.6759999999999999, 0.9532, 0.892, 0.9388, 0.9316, 0.9352, 0.8884, 0.9388, 0.9388, 0.9316, 0.9279999999999999, 0.9388, 0.0, 0.9279999999999999, 0.9532, 0.9136, 0.6759999999999999, 0.946, 0.9316, 0.9316, 0.9532, 0.6544, 0.6436, 0.9244, 0.9424, 0.9496, 0.9064, 0.7948, 0.946, 0.4276, 0.946, 0.9496, 0.9352, 0.9388, 0.9532, 0.91, 0.9532, 0.0, 0.9136, 0.9388, 0.946, 0.9244, 0.892, 0.9388, 0.946, 0.9388, 0.0, 0.8884, 0.9208000000000001, 0.6075999999999999, 0.9388, 0.0, 0.0, 0.91, 0.9064, 0.9028, 0.9316, 0.9172, 0.8992, 0.9316, 0.8812, 0.8704000000000001, 0.6616, 0.9208000000000001, 0.9388, 0.6436, 0.7372000000000001, 0.9532, 0.9172, 0.9532, 0.6472, 0.892, 0.9064, 0.7767999999999999, 0.91, 0.9316, 0.9208000000000001, 0.8704000000000001, 0.9388, 0.9244, 0.946, 0.9244, 0.8848, 0.946, 0.9028, 0.9279999999999999, 0.9279999999999999, 0.0, 0.73, 0.9532, 0.9208000000000001, 0.7804, 0.9388], "episode_lengths": [250, 35, 25, 24, 45, 13, 22, 90, 13, 30, 17, 19, 18, 31, 17, 17, 19, 20, 17, 15, 20, 13, 24, 90, 15, 19, 19, 13, 96, 99, 21, 16, 14, 26, 57, 15, 159, 15, 14, 18, 17, 13, 25, 13, 8, 24, 17, 15, 21, 30, 17, 15, 17, 10, 31, 22, 109, 17, 20, 247, 25, 26, 27, 19, 23, 28, 19, 33, 36, 94, 22, 17, 99, 73, 13, 23, 13, 98, 30, 26, 62, 25, 19, 22, 36, 17, 21, 15, 21, 32, 15, 27, 20, 20, 6, 75, 13, 22, 61, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43924990531839464, "mean_inference_ms": 1.2314251029244285, "mean_action_processing_ms": 0.12116052054007262, "mean_env_wait_ms": 0.3683029094705411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005121946334838867, "ViewRequirementAgentConnector_ms": 0.2085723876953125}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39680, "num_agent_steps_trained": 39680, "num_env_steps_sampled": 39680, "num_env_steps_trained": 39680, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 39680, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 39680, "timers": {"training_iteration_time_ms": 2546.744, "sample_time_ms": 364.014, "load_time_ms": 0.529, "load_throughput": 2418664.288, "learn_time_ms": 2166.48, "learn_throughput": 590.82, "synch_weights_time_ms": 15.163}, "counters": {"num_env_steps_sampled": 39680, "num_env_steps_trained": 39680, "num_agent_steps_sampled": 39680, "num_agent_steps_trained": 39680}, "done": false, "episodes_total": 888, "training_iteration": 31, "trial_id": "7d771_00000", "date": "2023-08-04_22-42-52", "timestamp": 1691203372, "time_this_iter_s": 10.998796701431274, "time_total_s": 532.1071724891663, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 532.1071724891663, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 69.58, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7718759999999999, "episode_len_mean": 55.71, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0], "episode_lengths": [16, 14, 18, 14, 14, 14, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29681343909961716, "mean_inference_ms": 0.895404684447214, "mean_action_processing_ms": 0.09453312867380566, "mean_env_wait_ms": 0.3078916283893388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004858732223510742, "ViewRequirementAgentConnector_ms": 0.13481640815734863}, "clean_success_rate": 0.81, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 62.83, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29688489156835124, "mean_inference_ms": 0.8953610767786967, "mean_action_processing_ms": 0.09452578745198624, "mean_env_wait_ms": 0.3079260446300661, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004718303680419922, "ViewRequirementAgentConnector_ms": 0.1270277500152588}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4118629275759061, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.024612284451723098, "policy_loss": -0.05644063452879588, "vf_loss": 0.01704777360583345, "vf_explained_var": 0.644870080947876, "kl": 0.014598098785657689, "entropy": 0.7098178613185883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.81038, "episode_len_mean": 36.21, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7948, 0.946, 0.4276, 0.946, 0.9496, 0.9352, 0.9388, 0.9532, 0.91, 0.9532, 0.0, 0.9136, 0.9388, 0.946, 0.9244, 0.892, 0.9388, 0.946, 0.9388, 0.0, 0.8884, 0.9208000000000001, 0.6075999999999999, 0.9388, 0.0, 0.0, 0.91, 0.9064, 0.9028, 0.9316, 0.9172, 0.8992, 0.9316, 0.8812, 0.8704000000000001, 0.6616, 0.9208000000000001, 0.9388, 0.6436, 0.7372000000000001, 0.9532, 0.9172, 0.9532, 0.6472, 0.892, 0.9064, 0.7767999999999999, 0.91, 0.9316, 0.9208000000000001, 0.8704000000000001, 0.9388, 0.9244, 0.946, 0.9244, 0.8848, 0.946, 0.9028, 0.9279999999999999, 0.9279999999999999, 0.0, 0.73, 0.9532, 0.9208000000000001, 0.7804, 0.9388, 0.9244, 0.946, 0.9279999999999999, 0.7048, 0.0, 0.8271999999999999, 0.9208000000000001, 0.0, 0.8632, 0.0, 0.946, 0.8632, 0.9352, 0.946, 0.9208000000000001, 0.91, 0.9244, 0.7696, 0.9532, 0.9136, 0.8128, 0.9244, 0.9279999999999999, 0.7228, 0.946, 0.7587999999999999, 0.9496, 0.49959999999999993, 0.9388, 0.9172, 0.7372000000000001, 0.9244, 0.946, 0.91], "episode_lengths": [57, 15, 159, 15, 14, 18, 17, 13, 25, 13, 8, 24, 17, 15, 21, 30, 17, 15, 17, 10, 31, 22, 109, 17, 20, 247, 25, 26, 27, 19, 23, 28, 19, 33, 36, 94, 22, 17, 99, 73, 13, 23, 13, 98, 30, 26, 62, 25, 19, 22, 36, 17, 21, 15, 21, 32, 15, 27, 20, 20, 6, 75, 13, 22, 61, 17, 21, 15, 20, 82, 250, 48, 22, 6, 38, 29, 15, 38, 18, 15, 22, 25, 21, 64, 13, 24, 52, 21, 20, 77, 15, 67, 14, 139, 17, 23, 73, 21, 15, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44087342830574483, "mean_inference_ms": 1.239726223059216, "mean_action_processing_ms": 0.12184126568444803, "mean_env_wait_ms": 0.36964670048934745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005100250244140625, "ViewRequirementAgentConnector_ms": 0.19407296180725098}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.81038, "episode_len_mean": 36.21, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7948, 0.946, 0.4276, 0.946, 0.9496, 0.9352, 0.9388, 0.9532, 0.91, 0.9532, 0.0, 0.9136, 0.9388, 0.946, 0.9244, 0.892, 0.9388, 0.946, 0.9388, 0.0, 0.8884, 0.9208000000000001, 0.6075999999999999, 0.9388, 0.0, 0.0, 0.91, 0.9064, 0.9028, 0.9316, 0.9172, 0.8992, 0.9316, 0.8812, 0.8704000000000001, 0.6616, 0.9208000000000001, 0.9388, 0.6436, 0.7372000000000001, 0.9532, 0.9172, 0.9532, 0.6472, 0.892, 0.9064, 0.7767999999999999, 0.91, 0.9316, 0.9208000000000001, 0.8704000000000001, 0.9388, 0.9244, 0.946, 0.9244, 0.8848, 0.946, 0.9028, 0.9279999999999999, 0.9279999999999999, 0.0, 0.73, 0.9532, 0.9208000000000001, 0.7804, 0.9388, 0.9244, 0.946, 0.9279999999999999, 0.7048, 0.0, 0.8271999999999999, 0.9208000000000001, 0.0, 0.8632, 0.0, 0.946, 0.8632, 0.9352, 0.946, 0.9208000000000001, 0.91, 0.9244, 0.7696, 0.9532, 0.9136, 0.8128, 0.9244, 0.9279999999999999, 0.7228, 0.946, 0.7587999999999999, 0.9496, 0.49959999999999993, 0.9388, 0.9172, 0.7372000000000001, 0.9244, 0.946, 0.91], "episode_lengths": [57, 15, 159, 15, 14, 18, 17, 13, 25, 13, 8, 24, 17, 15, 21, 30, 17, 15, 17, 10, 31, 22, 109, 17, 20, 247, 25, 26, 27, 19, 23, 28, 19, 33, 36, 94, 22, 17, 99, 73, 13, 23, 13, 98, 30, 26, 62, 25, 19, 22, 36, 17, 21, 15, 21, 32, 15, 27, 20, 20, 6, 75, 13, 22, 61, 17, 21, 15, 20, 82, 250, 48, 22, 6, 38, 29, 15, 38, 18, 15, 22, 25, 21, 64, 13, 24, 52, 21, 20, 77, 15, 67, 14, 139, 17, 23, 73, 21, 15, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44087342830574483, "mean_inference_ms": 1.239726223059216, "mean_action_processing_ms": 0.12184126568444803, "mean_env_wait_ms": 0.36964670048934745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005100250244140625, "ViewRequirementAgentConnector_ms": 0.19407296180725098}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 40960, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 2633.438, "sample_time_ms": 362.064, "load_time_ms": 0.518, "load_throughput": 2471212.483, "learn_time_ms": 2254.215, "learn_throughput": 567.825, "synch_weights_time_ms": 16.07}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "episodes_total": 922, "training_iteration": 32, "trial_id": "7d771_00000", "date": "2023-08-04_22-43-06", "timestamp": 1691203386, "time_this_iter_s": 13.632211446762085, "time_total_s": 545.7393839359283, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 545.7393839359283, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 67.00999999999999, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7720199999999998, "episode_len_mean": 55.67, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [16, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2970065722185615, "mean_inference_ms": 0.8954790588655176, "mean_action_processing_ms": 0.09452339022519635, "mean_env_wait_ms": 0.3081140516997287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004988670349121094, "ViewRequirementAgentConnector_ms": 0.14858007431030273}, "clean_success_rate": 0.81, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 50.77, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 13, 250, 13, 13, 13, 13, 13, 250, 250, 250, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 6, 6, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 6, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2971268855145138, "mean_inference_ms": 0.8954704925267479, "mean_action_processing_ms": 0.09455688993428113, "mean_env_wait_ms": 0.3082022265799832, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0046617984771728516, "ViewRequirementAgentConnector_ms": 0.12359213829040527}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38844328592220945, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.016301533294220766, "policy_loss": -0.045191081250086425, "vf_loss": 0.01790989534308513, "vf_explained_var": 0.6265901871522268, "kl": 0.010844101482750073, "entropy": 0.6875663499037424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 4875.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 42240, "num_env_steps_trained": 42240, "num_agent_steps_sampled": 42240, "num_agent_steps_trained": 42240}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8418559999999999, "episode_len_mean": 33.35, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9172, 0.9532, 0.6472, 0.892, 0.9064, 0.7767999999999999, 0.91, 0.9316, 0.9208000000000001, 0.8704000000000001, 0.9388, 0.9244, 0.946, 0.9244, 0.8848, 0.946, 0.9028, 0.9279999999999999, 0.9279999999999999, 0.0, 0.73, 0.9532, 0.9208000000000001, 0.7804, 0.9388, 0.9244, 0.946, 0.9279999999999999, 0.7048, 0.0, 0.8271999999999999, 0.9208000000000001, 0.0, 0.8632, 0.0, 0.946, 0.8632, 0.9352, 0.946, 0.9208000000000001, 0.91, 0.9244, 0.7696, 0.9532, 0.9136, 0.8128, 0.9244, 0.9279999999999999, 0.7228, 0.946, 0.7587999999999999, 0.9496, 0.49959999999999993, 0.9388, 0.9172, 0.7372000000000001, 0.9244, 0.946, 0.91, 0.946, 0.9316, 0.9532, 0.8884, 0.9316, 0.8452, 0.9532, 0.9208000000000001, 0.946, 0.8884, 0.8668, 0.9532, 0.9244, 0.9388, 0.892, 0.8956, 0.9388, 0.9532, 0.6616, 0.7228, 0.9532, 0.9352, 0.9172, 0.9279999999999999, 0.91, 0.9172, 0.946, 0.9424, 0.946, 0.9064, 0.0, 0.9424, 0.9424, 0.8668, 0.7552, 0.9064, 0.3304, 0.8668, 0.9388, 0.946], "episode_lengths": [13, 23, 13, 98, 30, 26, 62, 25, 19, 22, 36, 17, 21, 15, 21, 32, 15, 27, 20, 20, 6, 75, 13, 22, 61, 17, 21, 15, 20, 82, 250, 48, 22, 6, 38, 29, 15, 38, 18, 15, 22, 25, 21, 64, 13, 24, 52, 21, 20, 77, 15, 67, 14, 139, 17, 23, 73, 21, 15, 25, 15, 19, 13, 31, 19, 43, 13, 22, 15, 31, 37, 13, 21, 17, 30, 29, 17, 13, 94, 77, 13, 18, 23, 20, 25, 23, 15, 16, 15, 26, 40, 16, 16, 37, 68, 26, 186, 37, 17, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.440064860364552, "mean_inference_ms": 1.2399285562787974, "mean_action_processing_ms": 0.12202992039724721, "mean_env_wait_ms": 0.3694107037071159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00490880012512207, "ViewRequirementAgentConnector_ms": 0.15686774253845215}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8418559999999999, "episode_len_mean": 33.35, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9172, 0.9532, 0.6472, 0.892, 0.9064, 0.7767999999999999, 0.91, 0.9316, 0.9208000000000001, 0.8704000000000001, 0.9388, 0.9244, 0.946, 0.9244, 0.8848, 0.946, 0.9028, 0.9279999999999999, 0.9279999999999999, 0.0, 0.73, 0.9532, 0.9208000000000001, 0.7804, 0.9388, 0.9244, 0.946, 0.9279999999999999, 0.7048, 0.0, 0.8271999999999999, 0.9208000000000001, 0.0, 0.8632, 0.0, 0.946, 0.8632, 0.9352, 0.946, 0.9208000000000001, 0.91, 0.9244, 0.7696, 0.9532, 0.9136, 0.8128, 0.9244, 0.9279999999999999, 0.7228, 0.946, 0.7587999999999999, 0.9496, 0.49959999999999993, 0.9388, 0.9172, 0.7372000000000001, 0.9244, 0.946, 0.91, 0.946, 0.9316, 0.9532, 0.8884, 0.9316, 0.8452, 0.9532, 0.9208000000000001, 0.946, 0.8884, 0.8668, 0.9532, 0.9244, 0.9388, 0.892, 0.8956, 0.9388, 0.9532, 0.6616, 0.7228, 0.9532, 0.9352, 0.9172, 0.9279999999999999, 0.91, 0.9172, 0.946, 0.9424, 0.946, 0.9064, 0.0, 0.9424, 0.9424, 0.8668, 0.7552, 0.9064, 0.3304, 0.8668, 0.9388, 0.946], "episode_lengths": [13, 23, 13, 98, 30, 26, 62, 25, 19, 22, 36, 17, 21, 15, 21, 32, 15, 27, 20, 20, 6, 75, 13, 22, 61, 17, 21, 15, 20, 82, 250, 48, 22, 6, 38, 29, 15, 38, 18, 15, 22, 25, 21, 64, 13, 24, 52, 21, 20, 77, 15, 67, 14, 139, 17, 23, 73, 21, 15, 25, 15, 19, 13, 31, 19, 43, 13, 22, 15, 31, 37, 13, 21, 17, 30, 29, 17, 13, 94, 77, 13, 18, 23, 20, 25, 23, 15, 16, 15, 26, 40, 16, 16, 37, 68, 26, 186, 37, 17, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.440064860364552, "mean_inference_ms": 1.2399285562787974, "mean_action_processing_ms": 0.12202992039724721, "mean_env_wait_ms": 0.3694107037071159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00490880012512207, "ViewRequirementAgentConnector_ms": 0.15686774253845215}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42240, "num_agent_steps_trained": 42240, "num_env_steps_sampled": 42240, "num_env_steps_trained": 42240, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 42240, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 42240, "timers": {"training_iteration_time_ms": 2594.35, "sample_time_ms": 361.132, "load_time_ms": 0.511, "load_throughput": 2503011.385, "learn_time_ms": 2216.739, "learn_throughput": 577.425, "synch_weights_time_ms": 15.388}, "counters": {"num_env_steps_sampled": 42240, "num_env_steps_trained": 42240, "num_agent_steps_sampled": 42240, "num_agent_steps_trained": 42240}, "done": false, "episodes_total": 962, "training_iteration": 33, "trial_id": "7d771_00000", "date": "2023-08-04_22-43-17", "timestamp": 1691203397, "time_this_iter_s": 11.720141887664795, "time_total_s": 557.4595258235931, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 557.4595258235931, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 68.24117647058823, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7148279999999998, "episode_len_mean": 67.45, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 250, 250, 250, 13, 250, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 250, 13, 250, 250, 13, 13, 13, 13, 13, 15, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29732888662861706, "mean_inference_ms": 0.8957074283331159, "mean_action_processing_ms": 0.0945787128120482, "mean_env_wait_ms": 0.30824942719725773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049097537994384766, "ViewRequirementAgentConnector_ms": 0.1452784538269043}, "clean_success_rate": 0.75, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 43.75, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 16, 14, 14, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2974710815405551, "mean_inference_ms": 0.895718088381608, "mean_action_processing_ms": 0.09459389663331268, "mean_env_wait_ms": 0.3082802893389799, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004975080490112305, "ViewRequirementAgentConnector_ms": 0.1405634880065918}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.410456841091315, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.017777821893493334, "policy_loss": -0.049959316315750284, "vf_loss": 0.020648966326067844, "vf_explained_var": 0.7110425206025441, "kl": 0.011390152569316948, "entropy": 0.6650870863596599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 5025.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8273920000000002, "episode_len_mean": 32.51, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8128, 0.9244, 0.9279999999999999, 0.7228, 0.946, 0.7587999999999999, 0.9496, 0.49959999999999993, 0.9388, 0.9172, 0.7372000000000001, 0.9244, 0.946, 0.91, 0.946, 0.9316, 0.9532, 0.8884, 0.9316, 0.8452, 0.9532, 0.9208000000000001, 0.946, 0.8884, 0.8668, 0.9532, 0.9244, 0.9388, 0.892, 0.8956, 0.9388, 0.9532, 0.6616, 0.7228, 0.9532, 0.9352, 0.9172, 0.9279999999999999, 0.91, 0.9172, 0.946, 0.9424, 0.946, 0.9064, 0.0, 0.9424, 0.9424, 0.8668, 0.7552, 0.9064, 0.3304, 0.8668, 0.9388, 0.946, 0.43479999999999996, 0.8956, 0.9316, 0.0, 0.946, 0.9532, 0.946, 0.9532, 0.9316, 0.9172, 0.9388, 0.9064, 0.9244, 0.8956, 0.8524, 0.946, 0.9496, 0.8236, 0.8632, 0.9496, 0.0, 0.9388, 0.9172, 0.7767999999999999, 0.3556, 0.9172, 0.0, 0.8668, 0.9496, 0.9388, 0.9316, 0.6904, 0.9424, 0.9388, 0.8596, 0.0, 0.9172, 0.9136, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9424, 0.5895999999999999, 0.9424, 0.0], "episode_lengths": [52, 21, 20, 77, 15, 67, 14, 139, 17, 23, 73, 21, 15, 25, 15, 19, 13, 31, 19, 43, 13, 22, 15, 31, 37, 13, 21, 17, 30, 29, 17, 13, 94, 77, 13, 18, 23, 20, 25, 23, 15, 16, 15, 26, 40, 16, 16, 37, 68, 26, 186, 37, 17, 15, 157, 29, 19, 31, 15, 13, 15, 13, 19, 23, 17, 26, 21, 29, 41, 15, 14, 49, 38, 14, 14, 17, 23, 62, 179, 23, 6, 37, 14, 17, 19, 86, 16, 17, 39, 6, 23, 24, 20, 13, 13, 13, 16, 114, 16, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44371853699362, "mean_inference_ms": 1.2432885342035664, "mean_action_processing_ms": 0.12288223428312112, "mean_env_wait_ms": 0.3703629094523547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.013098716735839844, "ViewRequirementAgentConnector_ms": 0.16492414474487305}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8273920000000002, "episode_len_mean": 32.51, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8128, 0.9244, 0.9279999999999999, 0.7228, 0.946, 0.7587999999999999, 0.9496, 0.49959999999999993, 0.9388, 0.9172, 0.7372000000000001, 0.9244, 0.946, 0.91, 0.946, 0.9316, 0.9532, 0.8884, 0.9316, 0.8452, 0.9532, 0.9208000000000001, 0.946, 0.8884, 0.8668, 0.9532, 0.9244, 0.9388, 0.892, 0.8956, 0.9388, 0.9532, 0.6616, 0.7228, 0.9532, 0.9352, 0.9172, 0.9279999999999999, 0.91, 0.9172, 0.946, 0.9424, 0.946, 0.9064, 0.0, 0.9424, 0.9424, 0.8668, 0.7552, 0.9064, 0.3304, 0.8668, 0.9388, 0.946, 0.43479999999999996, 0.8956, 0.9316, 0.0, 0.946, 0.9532, 0.946, 0.9532, 0.9316, 0.9172, 0.9388, 0.9064, 0.9244, 0.8956, 0.8524, 0.946, 0.9496, 0.8236, 0.8632, 0.9496, 0.0, 0.9388, 0.9172, 0.7767999999999999, 0.3556, 0.9172, 0.0, 0.8668, 0.9496, 0.9388, 0.9316, 0.6904, 0.9424, 0.9388, 0.8596, 0.0, 0.9172, 0.9136, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9424, 0.5895999999999999, 0.9424, 0.0], "episode_lengths": [52, 21, 20, 77, 15, 67, 14, 139, 17, 23, 73, 21, 15, 25, 15, 19, 13, 31, 19, 43, 13, 22, 15, 31, 37, 13, 21, 17, 30, 29, 17, 13, 94, 77, 13, 18, 23, 20, 25, 23, 15, 16, 15, 26, 40, 16, 16, 37, 68, 26, 186, 37, 17, 15, 157, 29, 19, 31, 15, 13, 15, 13, 19, 23, 17, 26, 21, 29, 41, 15, 14, 49, 38, 14, 14, 17, 23, 62, 179, 23, 6, 37, 14, 17, 19, 86, 16, 17, 39, 6, 23, 24, 20, 13, 13, 13, 16, 114, 16, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44371853699362, "mean_inference_ms": 1.2432885342035664, "mean_action_processing_ms": 0.12288223428312112, "mean_env_wait_ms": 0.3703629094523547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.013098716735839844, "ViewRequirementAgentConnector_ms": 0.16492414474487305}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 43520, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 43520, "timers": {"training_iteration_time_ms": 2574.629, "sample_time_ms": 368.907, "load_time_ms": 0.526, "load_throughput": 2432913.001, "learn_time_ms": 2189.915, "learn_throughput": 584.497, "synch_weights_time_ms": 14.7}, "counters": {"num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "done": false, "episodes_total": 1008, "training_iteration": 34, "trial_id": "7d771_00000", "date": "2023-08-04_22-43-29", "timestamp": 1691203409, "time_this_iter_s": 11.218954086303711, "time_total_s": 568.6784799098969, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 568.6784799098969, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 68.5875, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7338199999999998, "episode_len_mean": 65.17, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 15, 13, 13, 13, 250, 250, 13, 250, 13, 250, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 250, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 6, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 15, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29772712844296445, "mean_inference_ms": 0.896356541418301, "mean_action_processing_ms": 0.0946292978054592, "mean_env_wait_ms": 0.30844780446111736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004940509796142578, "ViewRequirementAgentConnector_ms": 0.14069485664367676}, "clean_success_rate": 0.77, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 41.33, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 18, 14, 14, 14, 14, 13, 250, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 6, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.2979208464378135, "mean_inference_ms": 0.8975372480594658, "mean_action_processing_ms": 0.0946491202248777, "mean_env_wait_ms": 0.30861702816816605, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.009319782257080078, "ViewRequirementAgentConnector_ms": 0.13560962677001953}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3724793639779091, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.008257315469284852, "policy_loss": -0.04547284989307324, "vf_loss": 0.025511558931320906, "vf_explained_var": 0.7191396343708039, "kl": 0.011559482257822917, "entropy": 0.7125961303710937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 5175.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 44800, "num_env_steps_trained": 44800, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8186959999999998, "episode_len_mean": 30.12, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9279999999999999, 0.91, 0.9172, 0.946, 0.9424, 0.946, 0.9064, 0.0, 0.9424, 0.9424, 0.8668, 0.7552, 0.9064, 0.3304, 0.8668, 0.9388, 0.946, 0.43479999999999996, 0.8956, 0.9316, 0.0, 0.946, 0.9532, 0.946, 0.9532, 0.9316, 0.9172, 0.9388, 0.9064, 0.9244, 0.8956, 0.8524, 0.946, 0.9496, 0.8236, 0.8632, 0.9496, 0.0, 0.9388, 0.9172, 0.7767999999999999, 0.3556, 0.9172, 0.0, 0.8668, 0.9496, 0.9388, 0.9316, 0.6904, 0.9424, 0.9388, 0.8596, 0.0, 0.9172, 0.9136, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9424, 0.5895999999999999, 0.9424, 0.0, 0.9244, 0.9352, 0.9316, 0.9244, 0.9496, 0.9388, 0.6508, 0.9496, 0.9172, 0.946, 0.9172, 0.9028, 0.9532, 0.9244, 0.9532, 0.9316, 0.9136, 0.838, 0.0, 0.9532, 0.9208000000000001, 0.9028, 0.9532, 0.9424, 0.946, 0.7192000000000001, 0.9388, 0.946, 0.8812, 0.0, 0.9244, 0.9172, 0.9244, 0.9532, 0.874, 0.7948, 0.91], "episode_lengths": [20, 25, 23, 15, 16, 15, 26, 40, 16, 16, 37, 68, 26, 186, 37, 17, 15, 157, 29, 19, 31, 15, 13, 15, 13, 19, 23, 17, 26, 21, 29, 41, 15, 14, 49, 38, 14, 14, 17, 23, 62, 179, 23, 6, 37, 14, 17, 19, 86, 16, 17, 39, 6, 23, 24, 20, 13, 13, 13, 16, 114, 16, 26, 21, 18, 19, 21, 14, 17, 97, 14, 23, 15, 23, 27, 13, 21, 13, 19, 24, 45, 53, 13, 22, 27, 13, 16, 15, 78, 17, 15, 33, 22, 21, 23, 21, 13, 35, 57, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.445610501075492, "mean_inference_ms": 1.245327505854986, "mean_action_processing_ms": 0.12353327144713118, "mean_env_wait_ms": 0.3706540958654449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.013283252716064453, "ViewRequirementAgentConnector_ms": 0.16946625709533691}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8186959999999998, "episode_len_mean": 30.12, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9279999999999999, 0.91, 0.9172, 0.946, 0.9424, 0.946, 0.9064, 0.0, 0.9424, 0.9424, 0.8668, 0.7552, 0.9064, 0.3304, 0.8668, 0.9388, 0.946, 0.43479999999999996, 0.8956, 0.9316, 0.0, 0.946, 0.9532, 0.946, 0.9532, 0.9316, 0.9172, 0.9388, 0.9064, 0.9244, 0.8956, 0.8524, 0.946, 0.9496, 0.8236, 0.8632, 0.9496, 0.0, 0.9388, 0.9172, 0.7767999999999999, 0.3556, 0.9172, 0.0, 0.8668, 0.9496, 0.9388, 0.9316, 0.6904, 0.9424, 0.9388, 0.8596, 0.0, 0.9172, 0.9136, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9424, 0.5895999999999999, 0.9424, 0.0, 0.9244, 0.9352, 0.9316, 0.9244, 0.9496, 0.9388, 0.6508, 0.9496, 0.9172, 0.946, 0.9172, 0.9028, 0.9532, 0.9244, 0.9532, 0.9316, 0.9136, 0.838, 0.0, 0.9532, 0.9208000000000001, 0.9028, 0.9532, 0.9424, 0.946, 0.7192000000000001, 0.9388, 0.946, 0.8812, 0.0, 0.9244, 0.9172, 0.9244, 0.9532, 0.874, 0.7948, 0.91], "episode_lengths": [20, 25, 23, 15, 16, 15, 26, 40, 16, 16, 37, 68, 26, 186, 37, 17, 15, 157, 29, 19, 31, 15, 13, 15, 13, 19, 23, 17, 26, 21, 29, 41, 15, 14, 49, 38, 14, 14, 17, 23, 62, 179, 23, 6, 37, 14, 17, 19, 86, 16, 17, 39, 6, 23, 24, 20, 13, 13, 13, 16, 114, 16, 26, 21, 18, 19, 21, 14, 17, 97, 14, 23, 15, 23, 27, 13, 21, 13, 19, 24, 45, 53, 13, 22, 27, 13, 16, 15, 78, 17, 15, 33, 22, 21, 23, 21, 13, 35, 57, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.445610501075492, "mean_inference_ms": 1.245327505854986, "mean_action_processing_ms": 0.12353327144713118, "mean_env_wait_ms": 0.3706540958654449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.013283252716064453, "ViewRequirementAgentConnector_ms": 0.16946625709533691}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800, "num_env_steps_sampled": 44800, "num_env_steps_trained": 44800, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 44800, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 44800, "timers": {"training_iteration_time_ms": 2655.785, "sample_time_ms": 371.006, "load_time_ms": 0.542, "load_throughput": 2361636.88, "learn_time_ms": 2267.67, "learn_throughput": 564.456, "synch_weights_time_ms": 15.968}, "counters": {"num_env_steps_sampled": 44800, "num_env_steps_trained": 44800, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800}, "done": false, "episodes_total": 1045, "training_iteration": 35, "trial_id": "7d771_00000", "date": "2023-08-04_22-43-42", "timestamp": 1691203422, "time_this_iter_s": 12.750123500823975, "time_total_s": 581.4286034107208, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 581.4286034107208, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 69.37777777777778, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7623439999999998, "episode_len_mean": 58.08, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 250, 13, 13, 6, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 15, 250, 13, 13, 13, 13, 13, 13, 13, 15, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29812161529769826, "mean_inference_ms": 0.8988587859136256, "mean_action_processing_ms": 0.09468478147293202, "mean_env_wait_ms": 0.30876499888714715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004950523376464844, "ViewRequirementAgentConnector_ms": 0.14392542839050293}, "clean_success_rate": 0.8, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 58.02, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 13, 250, 6, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29823975104224926, "mean_inference_ms": 0.8987987698691613, "mean_action_processing_ms": 0.09467324100675142, "mean_env_wait_ms": 0.30883063358986507, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004961252212524414, "ViewRequirementAgentConnector_ms": 0.12898755073547363}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3353828845421473, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.017515381667762994, "policy_loss": -0.04761565883954366, "vf_loss": 0.01854691221068303, "vf_explained_var": 0.7329949824015299, "kl": 0.011410731194579663, "entropy": 0.6452628294626872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 5325.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.835428, "episode_len_mean": 30.14, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8668, 0.9496, 0.9388, 0.9316, 0.6904, 0.9424, 0.9388, 0.8596, 0.0, 0.9172, 0.9136, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9424, 0.5895999999999999, 0.9424, 0.0, 0.9244, 0.9352, 0.9316, 0.9244, 0.9496, 0.9388, 0.6508, 0.9496, 0.9172, 0.946, 0.9172, 0.9028, 0.9532, 0.9244, 0.9532, 0.9316, 0.9136, 0.838, 0.0, 0.9532, 0.9208000000000001, 0.9028, 0.9532, 0.9424, 0.946, 0.7192000000000001, 0.9388, 0.946, 0.8812, 0.0, 0.9244, 0.9172, 0.9244, 0.9532, 0.874, 0.7948, 0.91, 0.47440000000000004, 0.9532, 0.892, 0.604, 0.9388, 0.9208000000000001, 0.9172, 0.946, 0.9496, 0.946, 0.0, 0.9244, 0.9532, 0.9388, 0.9496, 0.9388, 0.0, 0.0, 0.9316, 0.9136, 0.6688000000000001, 0.8848, 0.9388, 0.9388, 0.9352, 0.9424, 0.9424, 0.9388, 0.9244, 0.9532, 0.586, 0.9136, 0.9532, 0.9316, 0.9172, 0.9388, 0.9316, 0.9316, 0.9316, 0.9172, 0.9244, 0.6112, 0.946, 0.9352], "episode_lengths": [37, 14, 17, 19, 86, 16, 17, 39, 6, 23, 24, 20, 13, 13, 13, 16, 114, 16, 26, 21, 18, 19, 21, 14, 17, 97, 14, 23, 15, 23, 27, 13, 21, 13, 19, 24, 45, 53, 13, 22, 27, 13, 16, 15, 78, 17, 15, 33, 22, 21, 23, 21, 13, 35, 57, 25, 146, 13, 30, 110, 17, 22, 23, 15, 14, 15, 21, 21, 13, 17, 14, 17, 9, 250, 19, 24, 92, 32, 17, 17, 18, 16, 16, 17, 21, 13, 115, 24, 13, 19, 23, 17, 19, 19, 19, 23, 21, 108, 15, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44592151978753725, "mean_inference_ms": 1.2486904911566725, "mean_action_processing_ms": 0.12368731987402862, "mean_env_wait_ms": 0.37073996876190757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049664974212646484, "ViewRequirementAgentConnector_ms": 0.15555953979492188}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.835428, "episode_len_mean": 30.14, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8668, 0.9496, 0.9388, 0.9316, 0.6904, 0.9424, 0.9388, 0.8596, 0.0, 0.9172, 0.9136, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9424, 0.5895999999999999, 0.9424, 0.0, 0.9244, 0.9352, 0.9316, 0.9244, 0.9496, 0.9388, 0.6508, 0.9496, 0.9172, 0.946, 0.9172, 0.9028, 0.9532, 0.9244, 0.9532, 0.9316, 0.9136, 0.838, 0.0, 0.9532, 0.9208000000000001, 0.9028, 0.9532, 0.9424, 0.946, 0.7192000000000001, 0.9388, 0.946, 0.8812, 0.0, 0.9244, 0.9172, 0.9244, 0.9532, 0.874, 0.7948, 0.91, 0.47440000000000004, 0.9532, 0.892, 0.604, 0.9388, 0.9208000000000001, 0.9172, 0.946, 0.9496, 0.946, 0.0, 0.9244, 0.9532, 0.9388, 0.9496, 0.9388, 0.0, 0.0, 0.9316, 0.9136, 0.6688000000000001, 0.8848, 0.9388, 0.9388, 0.9352, 0.9424, 0.9424, 0.9388, 0.9244, 0.9532, 0.586, 0.9136, 0.9532, 0.9316, 0.9172, 0.9388, 0.9316, 0.9316, 0.9316, 0.9172, 0.9244, 0.6112, 0.946, 0.9352], "episode_lengths": [37, 14, 17, 19, 86, 16, 17, 39, 6, 23, 24, 20, 13, 13, 13, 16, 114, 16, 26, 21, 18, 19, 21, 14, 17, 97, 14, 23, 15, 23, 27, 13, 21, 13, 19, 24, 45, 53, 13, 22, 27, 13, 16, 15, 78, 17, 15, 33, 22, 21, 23, 21, 13, 35, 57, 25, 146, 13, 30, 110, 17, 22, 23, 15, 14, 15, 21, 21, 13, 17, 14, 17, 9, 250, 19, 24, 92, 32, 17, 17, 18, 16, 16, 17, 21, 13, 115, 24, 13, 19, 23, 17, 19, 19, 19, 23, 21, 108, 15, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44592151978753725, "mean_inference_ms": 1.2486904911566725, "mean_action_processing_ms": 0.12368731987402862, "mean_env_wait_ms": 0.37073996876190757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049664974212646484, "ViewRequirementAgentConnector_ms": 0.15555953979492188}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 46080, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 2668.161, "sample_time_ms": 373.122, "load_time_ms": 0.574, "load_throughput": 2229993.404, "learn_time_ms": 2278.46, "learn_throughput": 561.783, "synch_weights_time_ms": 15.4}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "episodes_total": 1089, "training_iteration": 36, "trial_id": "7d771_00000", "date": "2023-08-04_22-43-53", "timestamp": 1691203433, "time_this_iter_s": 11.580581903457642, "time_total_s": 593.0091853141785, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 593.0091853141785, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 68.25, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7619119999999999, "episode_len_mean": 50.88, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.0, 0.946, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.91, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 16, 250, 250, 13, 13, 250, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 250, 13, 13, 6, 13, 13, 250, 250, 250, 13, 6, 15, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 25, 13, 250, 13, 13, 250, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29844112169003983, "mean_inference_ms": 0.8990412305385428, "mean_action_processing_ms": 0.09469423075899344, "mean_env_wait_ms": 0.30895326585100646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004988193511962891, "ViewRequirementAgentConnector_ms": 0.1708359718322754}, "clean_success_rate": 0.8, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.039136000000000004, "poison_episode_len_mean": 55.48, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 16, 14, 14, 14, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 6, 250, 13, 13, 6, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.298619318145899, "mean_inference_ms": 0.8991391930442144, "mean_action_processing_ms": 0.09472180388568274, "mean_env_wait_ms": 0.30900891846164524, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.00520634651184082, "ViewRequirementAgentConnector_ms": 0.15442371368408203}, "poison_success_rate": 0.04, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3782219930489858, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.015375945990284284, "policy_loss": -0.0440446121028314, "vf_loss": 0.018054151618853213, "vf_explained_var": 0.41907317280769346, "kl": 0.010483470448258838, "entropy": 0.6172027200460434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 5475.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 47360, "num_env_steps_trained": 47360, "num_agent_steps_sampled": 47360, "num_agent_steps_trained": 47360}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.852332, "episode_len_mean": 30.44, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.874, 0.7948, 0.91, 0.47440000000000004, 0.9532, 0.892, 0.604, 0.9388, 0.9208000000000001, 0.9172, 0.946, 0.9496, 0.946, 0.0, 0.9244, 0.9532, 0.9388, 0.9496, 0.9388, 0.0, 0.0, 0.9316, 0.9136, 0.6688000000000001, 0.8848, 0.9388, 0.9388, 0.9352, 0.9424, 0.9424, 0.9388, 0.9244, 0.9532, 0.586, 0.9136, 0.9532, 0.9316, 0.9172, 0.9388, 0.9316, 0.9316, 0.9316, 0.9172, 0.9244, 0.6112, 0.946, 0.9352, 0.9388, 0.9172, 0.9244, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.8956, 0.9532, 0.9172, 0.9388, 0.9279999999999999, 0.8308, 0.5895999999999999, 0.9172, 0.9424, 0.946, 0.9028, 0.9532, 0.9316, 0.9388, 0.8271999999999999, 0.9424, 0.6616, 0.946, 0.7767999999999999, 0.0, 0.9388, 0.9532, 0.9424, 0.8668, 0.9424, 0.40959999999999996, 0.946, 0.9496, 0.9532, 0.9352, 0.9244, 0.9136, 0.9532, 0.8271999999999999, 0.9172, 0.0, 0.9532, 0.9316, 0.9424, 0.9532, 0.8992, 0.9496], "episode_lengths": [13, 35, 57, 25, 146, 13, 30, 110, 17, 22, 23, 15, 14, 15, 21, 21, 13, 17, 14, 17, 9, 250, 19, 24, 92, 32, 17, 17, 18, 16, 16, 17, 21, 13, 115, 24, 13, 19, 23, 17, 19, 19, 19, 23, 21, 108, 15, 18, 17, 23, 21, 13, 13, 13, 17, 15, 13, 13, 29, 13, 23, 17, 20, 47, 114, 23, 16, 15, 27, 13, 19, 17, 48, 16, 94, 15, 62, 45, 17, 13, 16, 37, 16, 164, 15, 14, 13, 18, 21, 24, 13, 48, 23, 6, 13, 19, 16, 13, 28, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4434015007234005, "mean_inference_ms": 1.244430376113297, "mean_action_processing_ms": 0.12291770201849449, "mean_env_wait_ms": 0.3682822941300748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.007760524749755859, "ViewRequirementAgentConnector_ms": 0.14247918128967285}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.852332, "episode_len_mean": 30.44, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.874, 0.7948, 0.91, 0.47440000000000004, 0.9532, 0.892, 0.604, 0.9388, 0.9208000000000001, 0.9172, 0.946, 0.9496, 0.946, 0.0, 0.9244, 0.9532, 0.9388, 0.9496, 0.9388, 0.0, 0.0, 0.9316, 0.9136, 0.6688000000000001, 0.8848, 0.9388, 0.9388, 0.9352, 0.9424, 0.9424, 0.9388, 0.9244, 0.9532, 0.586, 0.9136, 0.9532, 0.9316, 0.9172, 0.9388, 0.9316, 0.9316, 0.9316, 0.9172, 0.9244, 0.6112, 0.946, 0.9352, 0.9388, 0.9172, 0.9244, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.8956, 0.9532, 0.9172, 0.9388, 0.9279999999999999, 0.8308, 0.5895999999999999, 0.9172, 0.9424, 0.946, 0.9028, 0.9532, 0.9316, 0.9388, 0.8271999999999999, 0.9424, 0.6616, 0.946, 0.7767999999999999, 0.0, 0.9388, 0.9532, 0.9424, 0.8668, 0.9424, 0.40959999999999996, 0.946, 0.9496, 0.9532, 0.9352, 0.9244, 0.9136, 0.9532, 0.8271999999999999, 0.9172, 0.0, 0.9532, 0.9316, 0.9424, 0.9532, 0.8992, 0.9496], "episode_lengths": [13, 35, 57, 25, 146, 13, 30, 110, 17, 22, 23, 15, 14, 15, 21, 21, 13, 17, 14, 17, 9, 250, 19, 24, 92, 32, 17, 17, 18, 16, 16, 17, 21, 13, 115, 24, 13, 19, 23, 17, 19, 19, 19, 23, 21, 108, 15, 18, 17, 23, 21, 13, 13, 13, 17, 15, 13, 13, 29, 13, 23, 17, 20, 47, 114, 23, 16, 15, 27, 13, 19, 17, 48, 16, 94, 15, 62, 45, 17, 13, 16, 37, 16, 164, 15, 14, 13, 18, 21, 24, 13, 48, 23, 6, 13, 19, 16, 13, 28, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4434015007234005, "mean_inference_ms": 1.244430376113297, "mean_action_processing_ms": 0.12291770201849449, "mean_env_wait_ms": 0.3682822941300748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.007760524749755859, "ViewRequirementAgentConnector_ms": 0.14247918128967285}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47360, "num_agent_steps_trained": 47360, "num_env_steps_sampled": 47360, "num_env_steps_trained": 47360, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 47360, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 47360, "timers": {"training_iteration_time_ms": 2685.622, "sample_time_ms": 363.748, "load_time_ms": 0.555, "load_throughput": 2307236.718, "learn_time_ms": 2305.775, "learn_throughput": 555.128, "synch_weights_time_ms": 14.95}, "counters": {"num_env_steps_sampled": 47360, "num_env_steps_trained": 47360, "num_agent_steps_sampled": 47360, "num_agent_steps_trained": 47360}, "done": false, "episodes_total": 1141, "training_iteration": 37, "trial_id": "7d771_00000", "date": "2023-08-04_22-44-05", "timestamp": 1691203445, "time_this_iter_s": 12.05268383026123, "time_total_s": 605.0618691444397, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 605.0618691444397, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 67.54705882352941, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7901839999999999, "episode_len_mean": 43.86, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9352, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 16, 16, 250, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 6, 18, 250, 250, 13, 13, 13, 13, 20, 13, 13, 13, 250, 13, 13, 13, 20, 13, 13, 13, 13, 13, 13, 13, 15, 250, 13, 6, 13, 250, 13, 13, 6, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2988107124943947, "mean_inference_ms": 0.8994367929805303, "mean_action_processing_ms": 0.09473714971971982, "mean_env_wait_ms": 0.30916657604748526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005207538604736328, "ViewRequirementAgentConnector_ms": 0.15428614616394043}, "clean_success_rate": 0.83, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 51.03, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 250, 13, 21, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 6, 13, 13, 13, 15, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 21, 13, 250, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 21, 250, 13, 13, 13, 13, 13, 250, 13, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29899690038587057, "mean_inference_ms": 0.8996528490557592, "mean_action_processing_ms": 0.09476822819188044, "mean_env_wait_ms": 0.30925468901005887, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.009627819061279297, "ViewRequirementAgentConnector_ms": 0.1448042392730713}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4368116057912509, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.009208327581485112, "policy_loss": -0.0515212049583594, "vf_loss": 0.02865482840066155, "vf_explained_var": 0.5314590259393056, "kl": 0.013489432681283992, "entropy": 0.6564761900901794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 5625.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.813204, "episode_len_mean": 26.48, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9244, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.8956, 0.9532, 0.9172, 0.9388, 0.9279999999999999, 0.8308, 0.5895999999999999, 0.9172, 0.9424, 0.946, 0.9028, 0.9532, 0.9316, 0.9388, 0.8271999999999999, 0.9424, 0.6616, 0.946, 0.7767999999999999, 0.0, 0.9388, 0.9532, 0.9424, 0.8668, 0.9424, 0.40959999999999996, 0.946, 0.9496, 0.9532, 0.9352, 0.9244, 0.9136, 0.9532, 0.8271999999999999, 0.9172, 0.0, 0.9532, 0.9316, 0.9424, 0.9532, 0.8992, 0.9496, 0.9424, 0.9136, 0.9279999999999999, 0.82, 0.946, 0.9532, 0.9532, 0.892, 0.7984, 0.9388, 0.0, 0.946, 0.9316, 0.712, 0.0, 0.9496, 0.8884, 0.9424, 0.9279999999999999, 0.9388, 0.6508, 0.9316, 0.946, 0.9532, 0.9352, 0.9352, 0.9388, 0.9316, 0.9352, 0.946, 0.946, 0.8596, 0.9244, 0.9316, 0.9316, 0.0, 0.9316, 0.0, 0.0, 0.0, 0.8056, 0.946, 0.892, 0.9496, 0.0, 0.0, 0.9388, 0.9316, 0.9316, 0.6579999999999999], "episode_lengths": [21, 13, 13, 13, 17, 15, 13, 13, 29, 13, 23, 17, 20, 47, 114, 23, 16, 15, 27, 13, 19, 17, 48, 16, 94, 15, 62, 45, 17, 13, 16, 37, 16, 164, 15, 14, 13, 18, 21, 24, 13, 48, 23, 6, 13, 19, 16, 13, 28, 14, 16, 24, 20, 50, 15, 13, 13, 30, 56, 17, 6, 15, 19, 80, 6, 14, 31, 16, 20, 17, 97, 19, 15, 13, 18, 18, 17, 19, 18, 15, 15, 39, 21, 19, 19, 25, 19, 6, 19, 51, 54, 15, 30, 14, 24, 49, 17, 19, 19, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4430376131878704, "mean_inference_ms": 1.2416649392635366, "mean_action_processing_ms": 0.12258171837601632, "mean_env_wait_ms": 0.3676107946133269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008473634719848633, "ViewRequirementAgentConnector_ms": 0.1729412078857422}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.813204, "episode_len_mean": 26.48, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9244, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.8956, 0.9532, 0.9172, 0.9388, 0.9279999999999999, 0.8308, 0.5895999999999999, 0.9172, 0.9424, 0.946, 0.9028, 0.9532, 0.9316, 0.9388, 0.8271999999999999, 0.9424, 0.6616, 0.946, 0.7767999999999999, 0.0, 0.9388, 0.9532, 0.9424, 0.8668, 0.9424, 0.40959999999999996, 0.946, 0.9496, 0.9532, 0.9352, 0.9244, 0.9136, 0.9532, 0.8271999999999999, 0.9172, 0.0, 0.9532, 0.9316, 0.9424, 0.9532, 0.8992, 0.9496, 0.9424, 0.9136, 0.9279999999999999, 0.82, 0.946, 0.9532, 0.9532, 0.892, 0.7984, 0.9388, 0.0, 0.946, 0.9316, 0.712, 0.0, 0.9496, 0.8884, 0.9424, 0.9279999999999999, 0.9388, 0.6508, 0.9316, 0.946, 0.9532, 0.9352, 0.9352, 0.9388, 0.9316, 0.9352, 0.946, 0.946, 0.8596, 0.9244, 0.9316, 0.9316, 0.0, 0.9316, 0.0, 0.0, 0.0, 0.8056, 0.946, 0.892, 0.9496, 0.0, 0.0, 0.9388, 0.9316, 0.9316, 0.6579999999999999], "episode_lengths": [21, 13, 13, 13, 17, 15, 13, 13, 29, 13, 23, 17, 20, 47, 114, 23, 16, 15, 27, 13, 19, 17, 48, 16, 94, 15, 62, 45, 17, 13, 16, 37, 16, 164, 15, 14, 13, 18, 21, 24, 13, 48, 23, 6, 13, 19, 16, 13, 28, 14, 16, 24, 20, 50, 15, 13, 13, 30, 56, 17, 6, 15, 19, 80, 6, 14, 31, 16, 20, 17, 97, 19, 15, 13, 18, 18, 17, 19, 18, 15, 15, 39, 21, 19, 19, 25, 19, 6, 19, 51, 54, 15, 30, 14, 24, 49, 17, 19, 19, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4430376131878704, "mean_inference_ms": 1.2416649392635366, "mean_action_processing_ms": 0.12258171837601632, "mean_env_wait_ms": 0.3676107946133269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008473634719848633, "ViewRequirementAgentConnector_ms": 0.1729412078857422}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 48640, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 48640, "timers": {"training_iteration_time_ms": 2690.775, "sample_time_ms": 372.546, "load_time_ms": 0.581, "load_throughput": 2204537.067, "learn_time_ms": 2301.857, "learn_throughput": 556.073, "synch_weights_time_ms": 15.167}, "counters": {"num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "done": false, "episodes_total": 1191, "training_iteration": 38, "trial_id": "7d771_00000", "date": "2023-08-04_22-44-16", "timestamp": 1691203456, "time_this_iter_s": 10.893329858779907, "time_total_s": 615.9551990032196, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 615.9551990032196, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 68.1875, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7901839999999999, "episode_len_mean": 46.3, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.946, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9388, 0.9352, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 18, 14, 14, 14, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 13, 13, 6, 13, 17, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 250, 13, 250, 13, 250, 250, 13, 13, 15, 250, 250, 13, 13, 13, 250, 13, 17, 18, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 17, 13, 13, 13, 6, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 15, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2992455465337808, "mean_inference_ms": 0.9001985861979567, "mean_action_processing_ms": 0.09480154959160558, "mean_env_wait_ms": 0.30937562783468553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0051991939544677734, "ViewRequirementAgentConnector_ms": 0.22668766975402832}, "clean_success_rate": 0.83, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.039136000000000004, "poison_episode_len_mean": 55.48, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 6, 13, 13, 13, 250, 13, 6, 13, 15, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 15, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 6, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 6, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29944606840520255, "mean_inference_ms": 0.9004475902256146, "mean_action_processing_ms": 0.09482137468228849, "mean_env_wait_ms": 0.3094335967861858, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004901409149169922, "ViewRequirementAgentConnector_ms": 0.1459484100341797}, "poison_success_rate": 0.04, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3536343384782473, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.031515697812040645, "policy_loss": -0.05408084193865458, "vf_loss": 0.010110198268666864, "vf_explained_var": 0.5489222343762715, "kl": 0.012301180946597014, "entropy": 0.6537010546525319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 5775.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 49920, "num_env_steps_trained": 49920, "num_agent_steps_sampled": 49920, "num_agent_steps_trained": 49920}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8040679999999999, "episode_len_mean": 26.06, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9424, 0.9136, 0.9279999999999999, 0.82, 0.946, 0.9532, 0.9532, 0.892, 0.7984, 0.9388, 0.0, 0.946, 0.9316, 0.712, 0.0, 0.9496, 0.8884, 0.9424, 0.9279999999999999, 0.9388, 0.6508, 0.9316, 0.946, 0.9532, 0.9352, 0.9352, 0.9388, 0.9316, 0.9352, 0.946, 0.946, 0.8596, 0.9244, 0.9316, 0.9316, 0.0, 0.9316, 0.0, 0.0, 0.0, 0.8056, 0.946, 0.892, 0.9496, 0.0, 0.0, 0.9388, 0.9316, 0.9316, 0.6579999999999999, 0.946, 0.946, 0.8632, 0.9064, 0.9244, 0.0, 0.7912, 0.7696, 0.9316, 0.73, 0.946, 0.9352, 0.748, 0.9532, 0.9316, 0.9388, 0.9388, 0.8992, 0.9279999999999999, 0.9388, 0.0, 0.6579999999999999, 0.946, 0.91, 0.9064, 0.9279999999999999, 0.9388, 0.91, 0.8956, 0.9388, 0.9532, 0.6616, 0.0, 0.9244, 0.9316, 0.9532, 0.9388, 0.8704000000000001, 0.9136, 0.8956, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.8956, 0.9279999999999999, 0.9208000000000001, 0.9388, 0.9388, 0.9532], "episode_lengths": [16, 24, 20, 50, 15, 13, 13, 30, 56, 17, 6, 15, 19, 80, 6, 14, 31, 16, 20, 17, 97, 19, 15, 13, 18, 18, 17, 19, 18, 15, 15, 39, 21, 19, 19, 25, 19, 6, 19, 51, 54, 15, 30, 14, 24, 49, 17, 19, 19, 95, 15, 15, 38, 26, 21, 14, 58, 64, 19, 75, 15, 18, 70, 13, 19, 17, 17, 28, 20, 17, 8, 95, 15, 25, 26, 20, 17, 25, 29, 17, 13, 94, 11, 21, 19, 13, 17, 36, 24, 29, 13, 20, 13, 13, 29, 20, 22, 17, 17, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4443932754347025, "mean_inference_ms": 1.238730851054766, "mean_action_processing_ms": 0.12318189957627994, "mean_env_wait_ms": 0.36643122536396205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.01472020149230957, "ViewRequirementAgentConnector_ms": 0.17938685417175293}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8040679999999999, "episode_len_mean": 26.06, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9424, 0.9136, 0.9279999999999999, 0.82, 0.946, 0.9532, 0.9532, 0.892, 0.7984, 0.9388, 0.0, 0.946, 0.9316, 0.712, 0.0, 0.9496, 0.8884, 0.9424, 0.9279999999999999, 0.9388, 0.6508, 0.9316, 0.946, 0.9532, 0.9352, 0.9352, 0.9388, 0.9316, 0.9352, 0.946, 0.946, 0.8596, 0.9244, 0.9316, 0.9316, 0.0, 0.9316, 0.0, 0.0, 0.0, 0.8056, 0.946, 0.892, 0.9496, 0.0, 0.0, 0.9388, 0.9316, 0.9316, 0.6579999999999999, 0.946, 0.946, 0.8632, 0.9064, 0.9244, 0.0, 0.7912, 0.7696, 0.9316, 0.73, 0.946, 0.9352, 0.748, 0.9532, 0.9316, 0.9388, 0.9388, 0.8992, 0.9279999999999999, 0.9388, 0.0, 0.6579999999999999, 0.946, 0.91, 0.9064, 0.9279999999999999, 0.9388, 0.91, 0.8956, 0.9388, 0.9532, 0.6616, 0.0, 0.9244, 0.9316, 0.9532, 0.9388, 0.8704000000000001, 0.9136, 0.8956, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.8956, 0.9279999999999999, 0.9208000000000001, 0.9388, 0.9388, 0.9532], "episode_lengths": [16, 24, 20, 50, 15, 13, 13, 30, 56, 17, 6, 15, 19, 80, 6, 14, 31, 16, 20, 17, 97, 19, 15, 13, 18, 18, 17, 19, 18, 15, 15, 39, 21, 19, 19, 25, 19, 6, 19, 51, 54, 15, 30, 14, 24, 49, 17, 19, 19, 95, 15, 15, 38, 26, 21, 14, 58, 64, 19, 75, 15, 18, 70, 13, 19, 17, 17, 28, 20, 17, 8, 95, 15, 25, 26, 20, 17, 25, 29, 17, 13, 94, 11, 21, 19, 13, 17, 36, 24, 29, 13, 20, 13, 13, 29, 20, 22, 17, 17, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4443932754347025, "mean_inference_ms": 1.238730851054766, "mean_action_processing_ms": 0.12318189957627994, "mean_env_wait_ms": 0.36643122536396205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.01472020149230957, "ViewRequirementAgentConnector_ms": 0.17938685417175293}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49920, "num_agent_steps_trained": 49920, "num_env_steps_sampled": 49920, "num_env_steps_trained": 49920, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 49920, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 49920, "timers": {"training_iteration_time_ms": 2753.871, "sample_time_ms": 378.563, "load_time_ms": 0.592, "load_throughput": 2162796.245, "learn_time_ms": 2359.381, "learn_throughput": 542.515, "synch_weights_time_ms": 14.727}, "counters": {"num_env_steps_sampled": 49920, "num_env_steps_trained": 49920, "num_agent_steps_sampled": 49920, "num_agent_steps_trained": 49920}, "done": false, "episodes_total": 1241, "training_iteration": 39, "trial_id": "7d771_00000", "date": "2023-08-04_22-44-29", "timestamp": 1691203469, "time_this_iter_s": 12.297027587890625, "time_total_s": 628.2522265911102, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 628.2522265911102, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 69.48888888888888, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7997879999999998, "episode_len_mean": 39.03, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.0, 0.946, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 6, 13, 13, 13, 13, 13, 13, 15, 250, 13, 13, 250, 15, 6, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 15, 13, 13, 250, 13, 13, 15, 13, 250, 13, 250, 6, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 15, 250, 13, 13, 13, 13, 13, 13, 13, 18, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 250, 6, 13, 13, 13, 250, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29966940576007695, "mean_inference_ms": 0.9006248285296051, "mean_action_processing_ms": 0.09483726225312344, "mean_env_wait_ms": 0.3094598005862503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.007877826690673828, "ViewRequirementAgentConnector_ms": 0.16335248947143555}, "clean_success_rate": 0.84, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 60.46, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 251, 14, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.29980004840145486, "mean_inference_ms": 0.9007717221856444, "mean_action_processing_ms": 0.09483578416651932, "mean_env_wait_ms": 0.3094991318875623, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004801511764526367, "ViewRequirementAgentConnector_ms": 0.13002681732177734}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39165052682161333, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.008227004905541738, "policy_loss": -0.04256789783636729, "vf_loss": 0.02311497887596488, "vf_explained_var": 0.28205957969029744, "kl": 0.011087320225063499, "entropy": 0.6187030076980591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 5925.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8589199999999999, "episode_len_mean": 25.74, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9316, 0.6579999999999999, 0.946, 0.946, 0.8632, 0.9064, 0.9244, 0.0, 0.7912, 0.7696, 0.9316, 0.73, 0.946, 0.9352, 0.748, 0.9532, 0.9316, 0.9388, 0.9388, 0.8992, 0.9279999999999999, 0.9388, 0.0, 0.6579999999999999, 0.946, 0.91, 0.9064, 0.9279999999999999, 0.9388, 0.91, 0.8956, 0.9388, 0.9532, 0.6616, 0.0, 0.9244, 0.9316, 0.9532, 0.9388, 0.8704000000000001, 0.9136, 0.8956, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.8956, 0.9279999999999999, 0.9208000000000001, 0.9388, 0.9388, 0.9532, 0.9316, 0.8884, 0.9532, 0.9244, 0.946, 0.946, 0.748, 0.9316, 0.6184000000000001, 0.9172, 0.9388, 0.9028, 0.7012, 0.9532, 0.0, 0.9316, 0.9279999999999999, 0.946, 0.9388, 0.8956, 0.8884, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9352, 0.9244, 0.9316, 0.8668, 0.946, 0.9136, 0.8775999999999999, 0.9424, 0.9388, 0.9532, 0.9172, 0.91, 0.0, 0.9208000000000001, 0.9316, 0.9388, 0.8596, 0.8524, 0.9388, 0.9352], "episode_lengths": [19, 95, 15, 15, 38, 26, 21, 14, 58, 64, 19, 75, 15, 18, 70, 13, 19, 17, 17, 28, 20, 17, 8, 95, 15, 25, 26, 20, 17, 25, 29, 17, 13, 94, 11, 21, 19, 13, 17, 36, 24, 29, 13, 20, 13, 13, 29, 20, 22, 17, 17, 13, 19, 31, 13, 21, 15, 15, 70, 19, 106, 23, 17, 27, 83, 13, 6, 19, 20, 15, 17, 29, 31, 13, 17, 13, 13, 13, 19, 13, 18, 21, 19, 37, 15, 24, 34, 16, 17, 13, 23, 25, 5, 22, 19, 17, 39, 41, 17, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4456095065560457, "mean_inference_ms": 1.239736026858362, "mean_action_processing_ms": 0.12321884582538072, "mean_env_wait_ms": 0.36615993211790476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.014325618743896484, "ViewRequirementAgentConnector_ms": 0.19284534454345703}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8589199999999999, "episode_len_mean": 25.74, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9316, 0.6579999999999999, 0.946, 0.946, 0.8632, 0.9064, 0.9244, 0.0, 0.7912, 0.7696, 0.9316, 0.73, 0.946, 0.9352, 0.748, 0.9532, 0.9316, 0.9388, 0.9388, 0.8992, 0.9279999999999999, 0.9388, 0.0, 0.6579999999999999, 0.946, 0.91, 0.9064, 0.9279999999999999, 0.9388, 0.91, 0.8956, 0.9388, 0.9532, 0.6616, 0.0, 0.9244, 0.9316, 0.9532, 0.9388, 0.8704000000000001, 0.9136, 0.8956, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.8956, 0.9279999999999999, 0.9208000000000001, 0.9388, 0.9388, 0.9532, 0.9316, 0.8884, 0.9532, 0.9244, 0.946, 0.946, 0.748, 0.9316, 0.6184000000000001, 0.9172, 0.9388, 0.9028, 0.7012, 0.9532, 0.0, 0.9316, 0.9279999999999999, 0.946, 0.9388, 0.8956, 0.8884, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9352, 0.9244, 0.9316, 0.8668, 0.946, 0.9136, 0.8775999999999999, 0.9424, 0.9388, 0.9532, 0.9172, 0.91, 0.0, 0.9208000000000001, 0.9316, 0.9388, 0.8596, 0.8524, 0.9388, 0.9352], "episode_lengths": [19, 95, 15, 15, 38, 26, 21, 14, 58, 64, 19, 75, 15, 18, 70, 13, 19, 17, 17, 28, 20, 17, 8, 95, 15, 25, 26, 20, 17, 25, 29, 17, 13, 94, 11, 21, 19, 13, 17, 36, 24, 29, 13, 20, 13, 13, 29, 20, 22, 17, 17, 13, 19, 31, 13, 21, 15, 15, 70, 19, 106, 23, 17, 27, 83, 13, 6, 19, 20, 15, 17, 29, 31, 13, 17, 13, 13, 13, 19, 13, 18, 21, 19, 37, 15, 24, 34, 16, 17, 13, 23, 25, 5, 22, 19, 17, 39, 41, 17, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4456095065560457, "mean_inference_ms": 1.239736026858362, "mean_action_processing_ms": 0.12321884582538072, "mean_env_wait_ms": 0.36615993211790476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.014325618743896484, "ViewRequirementAgentConnector_ms": 0.19284534454345703}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 51200, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 2676.102, "sample_time_ms": 363.785, "load_time_ms": 0.568, "load_throughput": 2252258.724, "learn_time_ms": 2297.629, "learn_throughput": 557.096, "synch_weights_time_ms": 13.532}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "episodes_total": 1289, "training_iteration": 40, "trial_id": "7d771_00000", "date": "2023-08-04_22-44-39", "timestamp": 1691203479, "time_this_iter_s": 10.409461975097656, "time_total_s": 638.6616885662079, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 638.6616885662079, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 67.86428571428573, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8287079999999999, "episode_len_mean": 41.59, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 18, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 250, 6, 250, 13, 13, 250, 13, 250, 250, 13, 13, 15, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29993011519796875, "mean_inference_ms": 0.9008907743027835, "mean_action_processing_ms": 0.09484421335195135, "mean_env_wait_ms": 0.30953113817682715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005808591842651367, "ViewRequirementAgentConnector_ms": 0.13832330703735352}, "clean_success_rate": 0.87, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 46.33, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 16, 14, 13, 13, 15, 13, 13, 13, 13, 18, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 6, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 18, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3001046713646207, "mean_inference_ms": 0.9010503407474444, "mean_action_processing_ms": 0.09486080485296554, "mean_env_wait_ms": 0.30953699777431676, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004777669906616211, "ViewRequirementAgentConnector_ms": 0.13438844680786133}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35679705679416657, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.018147800862789155, "policy_loss": -0.046255761682987215, "vf_loss": 0.017401769291609526, "vf_explained_var": 0.457433541615804, "kl": 0.010574015142362139, "entropy": 0.5537740323940913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 6075.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 52480, "num_env_steps_trained": 52480, "num_agent_steps_sampled": 52480, "num_agent_steps_trained": 52480}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.873312, "episode_len_mean": 24.56, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.748, 0.9316, 0.6184000000000001, 0.9172, 0.9388, 0.9028, 0.7012, 0.9532, 0.0, 0.9316, 0.9279999999999999, 0.946, 0.9388, 0.8956, 0.8884, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9352, 0.9244, 0.9316, 0.8668, 0.946, 0.9136, 0.8775999999999999, 0.9424, 0.9388, 0.9532, 0.9172, 0.91, 0.0, 0.9208000000000001, 0.9316, 0.9388, 0.8596, 0.8524, 0.9388, 0.9352, 0.6112, 0.478, 0.9352, 0.9496, 0.9316, 0.9136, 0.9244, 0.712, 0.8956, 0.9028, 0.9316, 0.8812, 0.748, 0.9532, 0.9532, 0.9388, 0.9244, 0.8704000000000001, 0.9424, 0.9172, 0.9136, 0.9424, 0.9172, 0.8992, 0.9388, 0.946, 0.946, 0.946, 0.946, 0.0, 0.9352, 0.9352, 0.9172, 0.9244, 0.9532, 0.8956, 0.9532, 0.9244, 0.9352, 0.9388, 0.9279999999999999, 0.946, 0.9388, 0.9316, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.8956, 0.9244, 0.9532, 0.0, 0.9532], "episode_lengths": [15, 70, 19, 106, 23, 17, 27, 83, 13, 6, 19, 20, 15, 17, 29, 31, 13, 17, 13, 13, 13, 19, 13, 18, 21, 19, 37, 15, 24, 34, 16, 17, 13, 23, 25, 5, 22, 19, 17, 39, 41, 17, 18, 108, 145, 18, 14, 19, 24, 21, 80, 29, 27, 19, 33, 70, 13, 13, 17, 21, 36, 16, 23, 24, 16, 23, 28, 17, 15, 15, 15, 15, 23, 18, 18, 23, 21, 13, 29, 13, 21, 18, 17, 20, 15, 17, 19, 17, 17, 13, 13, 13, 17, 13, 13, 29, 21, 13, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44893092389008016, "mean_inference_ms": 1.2466792320631443, "mean_action_processing_ms": 0.12349781563060011, "mean_env_wait_ms": 0.36826008046888525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00535273551940918, "ViewRequirementAgentConnector_ms": 0.1603095531463623}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.873312, "episode_len_mean": 24.56, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.946, 0.748, 0.9316, 0.6184000000000001, 0.9172, 0.9388, 0.9028, 0.7012, 0.9532, 0.0, 0.9316, 0.9279999999999999, 0.946, 0.9388, 0.8956, 0.8884, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9352, 0.9244, 0.9316, 0.8668, 0.946, 0.9136, 0.8775999999999999, 0.9424, 0.9388, 0.9532, 0.9172, 0.91, 0.0, 0.9208000000000001, 0.9316, 0.9388, 0.8596, 0.8524, 0.9388, 0.9352, 0.6112, 0.478, 0.9352, 0.9496, 0.9316, 0.9136, 0.9244, 0.712, 0.8956, 0.9028, 0.9316, 0.8812, 0.748, 0.9532, 0.9532, 0.9388, 0.9244, 0.8704000000000001, 0.9424, 0.9172, 0.9136, 0.9424, 0.9172, 0.8992, 0.9388, 0.946, 0.946, 0.946, 0.946, 0.0, 0.9352, 0.9352, 0.9172, 0.9244, 0.9532, 0.8956, 0.9532, 0.9244, 0.9352, 0.9388, 0.9279999999999999, 0.946, 0.9388, 0.9316, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.8956, 0.9244, 0.9532, 0.0, 0.9532], "episode_lengths": [15, 70, 19, 106, 23, 17, 27, 83, 13, 6, 19, 20, 15, 17, 29, 31, 13, 17, 13, 13, 13, 19, 13, 18, 21, 19, 37, 15, 24, 34, 16, 17, 13, 23, 25, 5, 22, 19, 17, 39, 41, 17, 18, 108, 145, 18, 14, 19, 24, 21, 80, 29, 27, 19, 33, 70, 13, 13, 17, 21, 36, 16, 23, 24, 16, 23, 28, 17, 15, 15, 15, 15, 23, 18, 18, 23, 21, 13, 29, 13, 21, 18, 17, 20, 15, 17, 19, 17, 17, 13, 13, 13, 17, 13, 13, 29, 21, 13, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44893092389008016, "mean_inference_ms": 1.2466792320631443, "mean_action_processing_ms": 0.12349781563060011, "mean_env_wait_ms": 0.36826008046888525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00535273551940918, "ViewRequirementAgentConnector_ms": 0.1603095531463623}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52480, "num_agent_steps_trained": 52480, "num_env_steps_sampled": 52480, "num_env_steps_trained": 52480, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 52480, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 52480, "timers": {"training_iteration_time_ms": 2636.852, "sample_time_ms": 352.609, "load_time_ms": 0.551, "load_throughput": 2321905.164, "learn_time_ms": 2270.972, "learn_throughput": 563.635, "synch_weights_time_ms": 12.137}, "counters": {"num_env_steps_sampled": 52480, "num_env_steps_trained": 52480, "num_agent_steps_sampled": 52480, "num_agent_steps_trained": 52480}, "done": false, "episodes_total": 1346, "training_iteration": 41, "trial_id": "7d771_00000", "date": "2023-08-04_22-44-49", "timestamp": 1691203489, "time_this_iter_s": 10.13013744354248, "time_total_s": 648.7918260097504, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 648.7918260097504, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 69.00666666666667, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.7525959999999998, "episode_len_mean": 58.07, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 16, 14, 14, 14, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13, 13, 6, 250, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 15, 250, 13, 13, 13, 13, 13, 13, 15, 250, 13, 13, 13, 250, 250, 250, 250, 13, 13, 6, 13, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3002766954321705, "mean_inference_ms": 0.901326840257001, "mean_action_processing_ms": 0.09490985065147368, "mean_env_wait_ms": 0.3095695857502859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004899263381958008, "ViewRequirementAgentConnector_ms": 0.1458590030670166}, "clean_success_rate": 0.79, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 72.24, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 13, 250, 13, 13, 13, 250, 6, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30027565555195357, "mean_inference_ms": 0.9011436270531558, "mean_action_processing_ms": 0.09489935122599032, "mean_env_wait_ms": 0.3095791314031515, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.00474858283996582, "ViewRequirementAgentConnector_ms": 0.12229609489440918}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3238551351428032, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.019908508608738582, "policy_loss": -0.042119499705731867, "vf_loss": 0.012774543839817246, "vf_explained_var": 0.5515038812160492, "kl": 0.009319947283608295, "entropy": 0.5731956060727438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 6225.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8818799999999999, "episode_len_mean": 22.37, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8956, 0.9028, 0.9316, 0.8812, 0.748, 0.9532, 0.9532, 0.9388, 0.9244, 0.8704000000000001, 0.9424, 0.9172, 0.9136, 0.9424, 0.9172, 0.8992, 0.9388, 0.946, 0.946, 0.946, 0.946, 0.0, 0.9352, 0.9352, 0.9172, 0.9244, 0.9532, 0.8956, 0.9532, 0.9244, 0.9352, 0.9388, 0.9279999999999999, 0.946, 0.9388, 0.9316, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.8956, 0.9244, 0.9532, 0.0, 0.9532, 0.6832, 0.9424, 0.9316, 0.8271999999999999, 0.9424, 0.9244, 0.946, 0.9532, 0.8956, 0.8956, 0.9208000000000001, 0.9352, 0.8164, 0.9316, 0.0, 0.946, 0.9316, 0.9388, 0.6796, 0.9388, 0.9244, 0.8668, 0.9532, 0.9532, 0.8992, 0.8416, 0.946, 0.91, 0.9316, 0.9136, 0.9064, 0.9532, 0.9244, 0.9532, 0.9532, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.9388, 0.9244, 0.0, 0.9532, 0.946, 0.7083999999999999, 0.9532, 0.9532, 0.946, 0.7696, 0.946, 0.946], "episode_lengths": [29, 27, 19, 33, 70, 13, 13, 17, 21, 36, 16, 23, 24, 16, 23, 28, 17, 15, 15, 15, 15, 23, 18, 18, 23, 21, 13, 29, 13, 21, 18, 17, 20, 15, 17, 19, 17, 17, 13, 13, 13, 17, 13, 13, 29, 21, 13, 14, 13, 88, 16, 19, 48, 16, 21, 15, 13, 29, 29, 22, 18, 51, 19, 15, 15, 19, 17, 89, 17, 21, 37, 13, 13, 28, 44, 15, 25, 19, 24, 26, 13, 21, 13, 13, 17, 20, 13, 13, 17, 21, 15, 13, 15, 81, 13, 13, 15, 64, 15, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4466959208058114, "mean_inference_ms": 1.2414819677997155, "mean_action_processing_ms": 0.12308460487825582, "mean_env_wait_ms": 0.366636278222892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005337715148925781, "ViewRequirementAgentConnector_ms": 0.15662550926208496}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8818799999999999, "episode_len_mean": 22.37, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8956, 0.9028, 0.9316, 0.8812, 0.748, 0.9532, 0.9532, 0.9388, 0.9244, 0.8704000000000001, 0.9424, 0.9172, 0.9136, 0.9424, 0.9172, 0.8992, 0.9388, 0.946, 0.946, 0.946, 0.946, 0.0, 0.9352, 0.9352, 0.9172, 0.9244, 0.9532, 0.8956, 0.9532, 0.9244, 0.9352, 0.9388, 0.9279999999999999, 0.946, 0.9388, 0.9316, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.8956, 0.9244, 0.9532, 0.0, 0.9532, 0.6832, 0.9424, 0.9316, 0.8271999999999999, 0.9424, 0.9244, 0.946, 0.9532, 0.8956, 0.8956, 0.9208000000000001, 0.9352, 0.8164, 0.9316, 0.0, 0.946, 0.9316, 0.9388, 0.6796, 0.9388, 0.9244, 0.8668, 0.9532, 0.9532, 0.8992, 0.8416, 0.946, 0.91, 0.9316, 0.9136, 0.9064, 0.9532, 0.9244, 0.9532, 0.9532, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.9388, 0.9244, 0.0, 0.9532, 0.946, 0.7083999999999999, 0.9532, 0.9532, 0.946, 0.7696, 0.946, 0.946], "episode_lengths": [29, 27, 19, 33, 70, 13, 13, 17, 21, 36, 16, 23, 24, 16, 23, 28, 17, 15, 15, 15, 15, 23, 18, 18, 23, 21, 13, 29, 13, 21, 18, 17, 20, 15, 17, 19, 17, 17, 13, 13, 13, 17, 13, 13, 29, 21, 13, 14, 13, 88, 16, 19, 48, 16, 21, 15, 13, 29, 29, 22, 18, 51, 19, 15, 15, 19, 17, 89, 17, 21, 37, 13, 13, 28, 44, 15, 25, 19, 24, 26, 13, 21, 13, 13, 17, 20, 13, 13, 17, 21, 15, 13, 15, 81, 13, 13, 15, 64, 15, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4466959208058114, "mean_inference_ms": 1.2414819677997155, "mean_action_processing_ms": 0.12308460487825582, "mean_env_wait_ms": 0.366636278222892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005337715148925781, "ViewRequirementAgentConnector_ms": 0.15662550926208496}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 53760, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 2585.758, "sample_time_ms": 351.209, "load_time_ms": 0.567, "load_throughput": 2258607.118, "learn_time_ms": 2220.203, "learn_throughput": 576.524, "synch_weights_time_ms": 13.191}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 1397, "training_iteration": 42, "trial_id": "7d771_00000", "date": "2023-08-04_22-45-03", "timestamp": 1691203503, "time_this_iter_s": 14.092623472213745, "time_total_s": 662.8844494819641, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 662.8844494819641, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 68.35, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.819392, "episode_len_mean": 39.02, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 6, 13, 13, 13, 250, 250, 6, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 15, 15, 13, 13, 6, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3003905239254796, "mean_inference_ms": 0.9010883981061683, "mean_action_processing_ms": 0.09488886521565072, "mean_env_wait_ms": 0.3095812200152905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005025386810302734, "ViewRequirementAgentConnector_ms": 0.14651894569396973}, "clean_success_rate": 0.86, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 69.87, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 250, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 6, 250, 250, 13, 13, 250, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3004213998509611, "mean_inference_ms": 0.9009605703674991, "mean_action_processing_ms": 0.09487693183668969, "mean_env_wait_ms": 0.3095814876245583, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004676103591918945, "ViewRequirementAgentConnector_ms": 0.12849211692810059}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.34119160413742067, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.032771471589803695, "policy_loss": -0.04887930730978648, "vf_loss": 0.005207459179994961, "vf_explained_var": 0.6167665266990662, "kl": 0.010765802570640517, "entropy": 0.5453436706463496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 6375.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 55040, "num_env_steps_trained": 55040, "num_agent_steps_sampled": 55040, "num_agent_steps_trained": 55040}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8921680000000001, "episode_len_mean": 21.98, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9352, 0.8164, 0.9316, 0.0, 0.946, 0.9316, 0.9388, 0.6796, 0.9388, 0.9244, 0.8668, 0.9532, 0.9532, 0.8992, 0.8416, 0.946, 0.91, 0.9316, 0.9136, 0.9064, 0.9532, 0.9244, 0.9532, 0.9532, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.9388, 0.9244, 0.0, 0.9532, 0.946, 0.7083999999999999, 0.9532, 0.9532, 0.946, 0.7696, 0.946, 0.946, 0.9244, 0.9388, 0.946, 0.9388, 0.9532, 0.0, 0.9279999999999999, 0.9424, 0.9532, 0.946, 0.9424, 0.9424, 0.8812, 0.9244, 0.8128, 0.9424, 0.9388, 0.9532, 0.9279999999999999, 0.946, 0.9532, 0.9388, 0.8992, 0.946, 0.7876, 0.9244, 0.8452, 0.946, 0.9532, 0.9208000000000001, 0.9316, 0.9172, 0.9316, 0.9532, 0.946, 0.9388, 0.9352, 0.8271999999999999, 0.946, 0.9424, 0.9244, 0.8956, 0.748, 0.9136, 0.8884, 0.9532, 0.9352, 0.9388, 0.9388, 0.9352, 0.9532, 0.9279999999999999, 0.946, 0.9388, 0.9532, 0.946, 0.9244, 0.9028, 0.9388, 0.9424], "episode_lengths": [18, 51, 19, 15, 15, 19, 17, 89, 17, 21, 37, 13, 13, 28, 44, 15, 25, 19, 24, 26, 13, 21, 13, 13, 17, 20, 13, 13, 17, 21, 15, 13, 15, 81, 13, 13, 15, 64, 15, 15, 21, 17, 15, 17, 13, 6, 20, 16, 13, 15, 16, 16, 33, 21, 52, 16, 17, 13, 20, 15, 13, 17, 28, 15, 59, 21, 43, 15, 13, 22, 19, 23, 19, 13, 15, 17, 18, 48, 15, 16, 21, 29, 70, 24, 31, 13, 18, 17, 17, 18, 13, 20, 15, 17, 13, 15, 21, 27, 17, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44572342562018535, "mean_inference_ms": 1.2407446615015796, "mean_action_processing_ms": 0.12264913292975596, "mean_env_wait_ms": 0.3656855101969894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00478672981262207, "ViewRequirementAgentConnector_ms": 0.1536424160003662}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8921680000000001, "episode_len_mean": 21.98, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9352, 0.8164, 0.9316, 0.0, 0.946, 0.9316, 0.9388, 0.6796, 0.9388, 0.9244, 0.8668, 0.9532, 0.9532, 0.8992, 0.8416, 0.946, 0.91, 0.9316, 0.9136, 0.9064, 0.9532, 0.9244, 0.9532, 0.9532, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.9388, 0.9244, 0.0, 0.9532, 0.946, 0.7083999999999999, 0.9532, 0.9532, 0.946, 0.7696, 0.946, 0.946, 0.9244, 0.9388, 0.946, 0.9388, 0.9532, 0.0, 0.9279999999999999, 0.9424, 0.9532, 0.946, 0.9424, 0.9424, 0.8812, 0.9244, 0.8128, 0.9424, 0.9388, 0.9532, 0.9279999999999999, 0.946, 0.9532, 0.9388, 0.8992, 0.946, 0.7876, 0.9244, 0.8452, 0.946, 0.9532, 0.9208000000000001, 0.9316, 0.9172, 0.9316, 0.9532, 0.946, 0.9388, 0.9352, 0.8271999999999999, 0.946, 0.9424, 0.9244, 0.8956, 0.748, 0.9136, 0.8884, 0.9532, 0.9352, 0.9388, 0.9388, 0.9352, 0.9532, 0.9279999999999999, 0.946, 0.9388, 0.9532, 0.946, 0.9244, 0.9028, 0.9388, 0.9424], "episode_lengths": [18, 51, 19, 15, 15, 19, 17, 89, 17, 21, 37, 13, 13, 28, 44, 15, 25, 19, 24, 26, 13, 21, 13, 13, 17, 20, 13, 13, 17, 21, 15, 13, 15, 81, 13, 13, 15, 64, 15, 15, 21, 17, 15, 17, 13, 6, 20, 16, 13, 15, 16, 16, 33, 21, 52, 16, 17, 13, 20, 15, 13, 17, 28, 15, 59, 21, 43, 15, 13, 22, 19, 23, 19, 13, 15, 17, 18, 48, 15, 16, 21, 29, 70, 24, 31, 13, 18, 17, 17, 18, 13, 20, 15, 17, 13, 15, 21, 27, 17, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44572342562018535, "mean_inference_ms": 1.2407446615015796, "mean_action_processing_ms": 0.12264913292975596, "mean_env_wait_ms": 0.3656855101969894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00478672981262207, "ViewRequirementAgentConnector_ms": 0.1536424160003662}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55040, "num_agent_steps_trained": 55040, "num_env_steps_sampled": 55040, "num_env_steps_trained": 55040, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 55040, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 55040, "timers": {"training_iteration_time_ms": 2586.486, "sample_time_ms": 345.891, "load_time_ms": 0.569, "load_throughput": 2249899.053, "learn_time_ms": 2226.374, "learn_throughput": 574.926, "synch_weights_time_ms": 13.07}, "counters": {"num_env_steps_sampled": 55040, "num_env_steps_trained": 55040, "num_agent_steps_sampled": 55040, "num_agent_steps_trained": 55040}, "done": false, "episodes_total": 1457, "training_iteration": 43, "trial_id": "7d771_00000", "date": "2023-08-04_22-45-14", "timestamp": 1691203514, "time_this_iter_s": 10.341518878936768, "time_total_s": 673.2259683609009, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 673.2259683609009, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 68.56666666666666, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8100039999999998, "episode_len_mean": 46.23, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 15, 13, 250, 13, 13, 6, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3005485427930123, "mean_inference_ms": 0.9014788120657969, "mean_action_processing_ms": 0.09490078813651918, "mean_env_wait_ms": 0.3096653051051935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004826545715332031, "ViewRequirementAgentConnector_ms": 0.13596200942993164}, "clean_success_rate": 0.85, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 67.43, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.9784, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 6, 6, 13, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30061469053115, "mean_inference_ms": 0.901543866599008, "mean_action_processing_ms": 0.09489721938280252, "mean_env_wait_ms": 0.30962777951972065, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0047893524169921875, "ViewRequirementAgentConnector_ms": 0.13003945350646973}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31270474861065545, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.022959423114856083, "policy_loss": -0.045309863528236745, "vf_loss": 0.0128528257428358, "vf_explained_var": 0.4316051149368286, "kl": 0.009380361746249642, "entropy": 0.524262534181277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 6525.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.903716, "episode_len_mean": 21.61, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8992, 0.946, 0.7876, 0.9244, 0.8452, 0.946, 0.9532, 0.9208000000000001, 0.9316, 0.9172, 0.9316, 0.9532, 0.946, 0.9388, 0.9352, 0.8271999999999999, 0.946, 0.9424, 0.9244, 0.8956, 0.748, 0.9136, 0.8884, 0.9532, 0.9352, 0.9388, 0.9388, 0.9352, 0.9532, 0.9279999999999999, 0.946, 0.9388, 0.9532, 0.946, 0.9244, 0.9028, 0.9388, 0.9424, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9532, 0.9388, 0.946, 0.9496, 0.6724, 0.9028, 0.91, 0.9244, 0.9352, 0.946, 0.9532, 0.9532, 0.8524, 0.8884, 0.9532, 0.9279999999999999, 0.9532, 0.8848, 0.9532, 0.9388, 0.91, 0.946, 0.9496, 0.9316, 0.9352, 0.9532, 0.9388, 0.9388, 0.9244, 0.9244, 0.946, 0.8488, 0.91, 0.9244, 0.8992, 0.9352, 0.8092, 0.0, 0.9172, 0.9532, 0.9028, 0.946, 0.0, 0.9424, 0.7804, 0.946, 0.9388, 0.946, 0.9316, 0.946, 0.946, 0.9388, 0.9388, 0.9532, 0.9388, 0.946, 0.9064], "episode_lengths": [28, 15, 59, 21, 43, 15, 13, 22, 19, 23, 19, 13, 15, 17, 18, 48, 15, 16, 21, 29, 70, 24, 31, 13, 18, 17, 17, 18, 13, 20, 15, 17, 13, 15, 21, 27, 17, 16, 13, 13, 13, 13, 16, 13, 17, 15, 14, 91, 27, 25, 21, 18, 15, 13, 13, 41, 31, 13, 20, 13, 32, 13, 17, 25, 15, 14, 19, 18, 13, 17, 17, 21, 21, 15, 42, 25, 21, 28, 18, 53, 9, 23, 13, 27, 15, 33, 16, 61, 15, 17, 15, 19, 15, 15, 17, 17, 13, 17, 15, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45065127360015195, "mean_inference_ms": 1.2446212901805276, "mean_action_processing_ms": 0.12313834567774809, "mean_env_wait_ms": 0.3671280551199258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005201578140258789, "ViewRequirementAgentConnector_ms": 0.16832923889160156}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.903716, "episode_len_mean": 21.61, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8992, 0.946, 0.7876, 0.9244, 0.8452, 0.946, 0.9532, 0.9208000000000001, 0.9316, 0.9172, 0.9316, 0.9532, 0.946, 0.9388, 0.9352, 0.8271999999999999, 0.946, 0.9424, 0.9244, 0.8956, 0.748, 0.9136, 0.8884, 0.9532, 0.9352, 0.9388, 0.9388, 0.9352, 0.9532, 0.9279999999999999, 0.946, 0.9388, 0.9532, 0.946, 0.9244, 0.9028, 0.9388, 0.9424, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9532, 0.9388, 0.946, 0.9496, 0.6724, 0.9028, 0.91, 0.9244, 0.9352, 0.946, 0.9532, 0.9532, 0.8524, 0.8884, 0.9532, 0.9279999999999999, 0.9532, 0.8848, 0.9532, 0.9388, 0.91, 0.946, 0.9496, 0.9316, 0.9352, 0.9532, 0.9388, 0.9388, 0.9244, 0.9244, 0.946, 0.8488, 0.91, 0.9244, 0.8992, 0.9352, 0.8092, 0.0, 0.9172, 0.9532, 0.9028, 0.946, 0.0, 0.9424, 0.7804, 0.946, 0.9388, 0.946, 0.9316, 0.946, 0.946, 0.9388, 0.9388, 0.9532, 0.9388, 0.946, 0.9064], "episode_lengths": [28, 15, 59, 21, 43, 15, 13, 22, 19, 23, 19, 13, 15, 17, 18, 48, 15, 16, 21, 29, 70, 24, 31, 13, 18, 17, 17, 18, 13, 20, 15, 17, 13, 15, 21, 27, 17, 16, 13, 13, 13, 13, 16, 13, 17, 15, 14, 91, 27, 25, 21, 18, 15, 13, 13, 41, 31, 13, 20, 13, 32, 13, 17, 25, 15, 14, 19, 18, 13, 17, 17, 21, 21, 15, 42, 25, 21, 28, 18, 53, 9, 23, 13, 27, 15, 33, 16, 61, 15, 17, 15, 19, 15, 15, 17, 17, 13, 17, 15, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45065127360015195, "mean_inference_ms": 1.2446212901805276, "mean_action_processing_ms": 0.12313834567774809, "mean_env_wait_ms": 0.3671280551199258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005201578140258789, "ViewRequirementAgentConnector_ms": 0.16832923889160156}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 56320, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 2675.688, "sample_time_ms": 347.174, "load_time_ms": 0.585, "load_throughput": 2188897.59, "learn_time_ms": 2313.556, "learn_throughput": 553.261, "synch_weights_time_ms": 13.78}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "done": false, "episodes_total": 1519, "training_iteration": 44, "trial_id": "7d771_00000", "date": "2023-08-04_22-45-26", "timestamp": 1691203526, "time_this_iter_s": 12.172613620758057, "time_total_s": 685.3985819816589, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 685.3985819816589, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 69.21176470588236, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8477000000000001, "episode_len_mean": 34.43, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 15, 250, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 15, 15, 13, 13, 13, 13, 13, 15, 6, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3008779605244985, "mean_inference_ms": 0.9023157981759428, "mean_action_processing_ms": 0.09495565402410026, "mean_env_wait_ms": 0.30980973789109884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005088329315185547, "ViewRequirementAgentConnector_ms": 0.15715980529785156}, "clean_success_rate": 0.89, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 62.69, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 6, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3009783542635094, "mean_inference_ms": 0.9024251215210048, "mean_action_processing_ms": 0.09495571477529863, "mean_env_wait_ms": 0.30981651637969526, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0047779083251953125, "ViewRequirementAgentConnector_ms": 0.12479639053344727}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3561555380622546, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.025872222806016604, "policy_loss": -0.0486107714412113, "vf_loss": 0.01173413850987951, "vf_explained_var": 0.5287482059001922, "kl": 0.010868554815776104, "entropy": 0.5785042542219162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 6675.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 57600, "num_env_steps_trained": 57600, "num_agent_steps_sampled": 57600, "num_agent_steps_trained": 57600}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.88936, "episode_len_mean": 22.88, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9352, 0.946, 0.9532, 0.9532, 0.8524, 0.8884, 0.9532, 0.9279999999999999, 0.9532, 0.8848, 0.9532, 0.9388, 0.91, 0.946, 0.9496, 0.9316, 0.9352, 0.9532, 0.9388, 0.9388, 0.9244, 0.9244, 0.946, 0.8488, 0.91, 0.9244, 0.8992, 0.9352, 0.8092, 0.0, 0.9172, 0.9532, 0.9028, 0.946, 0.0, 0.9424, 0.7804, 0.946, 0.9388, 0.946, 0.9316, 0.946, 0.946, 0.9388, 0.9388, 0.9532, 0.9388, 0.946, 0.9064, 0.9532, 0.8992, 0.9244, 0.9532, 0.946, 0.9532, 0.9316, 0.9532, 0.9244, 0.9424, 0.6796, 0.9424, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.892, 0.8416, 0.9532, 0.9172, 0.946, 0.8344, 0.9424, 0.6904, 0.0, 0.874, 0.9028, 0.946, 0.9532, 0.9316, 0.9532, 0.9316, 0.8992, 0.9279999999999999, 0.9388, 0.9532, 0.9172, 0.9532, 0.9136, 0.8344, 0.9172, 0.8848, 0.946, 0.9279999999999999, 0.9532, 0.9172, 0.9316, 0.5031999999999999, 0.9316, 0.9532], "episode_lengths": [18, 15, 13, 13, 41, 31, 13, 20, 13, 32, 13, 17, 25, 15, 14, 19, 18, 13, 17, 17, 21, 21, 15, 42, 25, 21, 28, 18, 53, 9, 23, 13, 27, 15, 33, 16, 61, 15, 17, 15, 19, 15, 15, 17, 17, 13, 17, 15, 26, 13, 28, 21, 13, 15, 13, 19, 13, 21, 16, 89, 16, 19, 15, 13, 13, 13, 30, 44, 13, 23, 15, 46, 16, 86, 6, 35, 27, 15, 13, 19, 13, 19, 28, 20, 17, 13, 23, 13, 24, 46, 23, 32, 15, 20, 13, 23, 19, 138, 19, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.450410205133613, "mean_inference_ms": 1.246327691178413, "mean_action_processing_ms": 0.12258392066188602, "mean_env_wait_ms": 0.3674158763127563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0051724910736083984, "ViewRequirementAgentConnector_ms": 0.16046881675720215}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.88936, "episode_len_mean": 22.88, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9352, 0.946, 0.9532, 0.9532, 0.8524, 0.8884, 0.9532, 0.9279999999999999, 0.9532, 0.8848, 0.9532, 0.9388, 0.91, 0.946, 0.9496, 0.9316, 0.9352, 0.9532, 0.9388, 0.9388, 0.9244, 0.9244, 0.946, 0.8488, 0.91, 0.9244, 0.8992, 0.9352, 0.8092, 0.0, 0.9172, 0.9532, 0.9028, 0.946, 0.0, 0.9424, 0.7804, 0.946, 0.9388, 0.946, 0.9316, 0.946, 0.946, 0.9388, 0.9388, 0.9532, 0.9388, 0.946, 0.9064, 0.9532, 0.8992, 0.9244, 0.9532, 0.946, 0.9532, 0.9316, 0.9532, 0.9244, 0.9424, 0.6796, 0.9424, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.892, 0.8416, 0.9532, 0.9172, 0.946, 0.8344, 0.9424, 0.6904, 0.0, 0.874, 0.9028, 0.946, 0.9532, 0.9316, 0.9532, 0.9316, 0.8992, 0.9279999999999999, 0.9388, 0.9532, 0.9172, 0.9532, 0.9136, 0.8344, 0.9172, 0.8848, 0.946, 0.9279999999999999, 0.9532, 0.9172, 0.9316, 0.5031999999999999, 0.9316, 0.9532], "episode_lengths": [18, 15, 13, 13, 41, 31, 13, 20, 13, 32, 13, 17, 25, 15, 14, 19, 18, 13, 17, 17, 21, 21, 15, 42, 25, 21, 28, 18, 53, 9, 23, 13, 27, 15, 33, 16, 61, 15, 17, 15, 19, 15, 15, 17, 17, 13, 17, 15, 26, 13, 28, 21, 13, 15, 13, 19, 13, 21, 16, 89, 16, 19, 15, 13, 13, 13, 30, 44, 13, 23, 15, 46, 16, 86, 6, 35, 27, 15, 13, 19, 13, 19, 28, 20, 17, 13, 23, 13, 24, 46, 23, 32, 15, 20, 13, 23, 19, 138, 19, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.450410205133613, "mean_inference_ms": 1.246327691178413, "mean_action_processing_ms": 0.12258392066188602, "mean_env_wait_ms": 0.3674158763127563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0051724910736083984, "ViewRequirementAgentConnector_ms": 0.16046881675720215}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57600, "num_agent_steps_trained": 57600, "num_env_steps_sampled": 57600, "num_env_steps_trained": 57600, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 57600, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 57600, "timers": {"training_iteration_time_ms": 2692.927, "sample_time_ms": 338.153, "load_time_ms": 0.592, "load_throughput": 2163842.296, "learn_time_ms": 2341.269, "learn_throughput": 546.712, "synch_weights_time_ms": 12.315}, "counters": {"num_env_steps_sampled": 57600, "num_env_steps_trained": 57600, "num_agent_steps_sampled": 57600, "num_agent_steps_trained": 57600}, "done": false, "episodes_total": 1570, "training_iteration": 45, "trial_id": "7d771_00000", "date": "2023-08-04_22-45-37", "timestamp": 1691203537, "time_this_iter_s": 10.489748239517212, "time_total_s": 695.8883302211761, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 695.8883302211761, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 67.94666666666667, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.875504, "episode_len_mean": 32.42, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9352, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 16, 14, 13, 13, 13, 18, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 15, 15, 13, 13, 13, 13, 250, 15, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 15, 13, 13, 15, 13, 13, 13, 15, 250, 13, 13, 13, 13, 13, 15, 13, 250, 13, 250, 15, 13, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 250, 13, 18, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3011913827667381, "mean_inference_ms": 0.9028436701076873, "mean_action_processing_ms": 0.09497894262884587, "mean_env_wait_ms": 0.30991414287701596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005013227462768555, "ViewRequirementAgentConnector_ms": 0.16861867904663086}, "clean_success_rate": 0.92, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 74.68, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 251, 14, 14, 14, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 250, 250, 13, 13, 250, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30134158180770965, "mean_inference_ms": 0.903095981743324, "mean_action_processing_ms": 0.0949780905384522, "mean_env_wait_ms": 0.3099600103854956, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004492044448852539, "ViewRequirementAgentConnector_ms": 0.12184381484985352}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35619314074516295, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.03641245134795706, "policy_loss": -0.05401796548316876, "vf_loss": 0.006466448103698591, "vf_explained_var": 0.7935139934221903, "kl": 0.011001545206284694, "entropy": 0.5634353484710057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 6825.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8829879999999999, "episode_len_mean": 24.35, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9244, 0.9424, 0.6796, 0.9424, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.892, 0.8416, 0.9532, 0.9172, 0.946, 0.8344, 0.9424, 0.6904, 0.0, 0.874, 0.9028, 0.946, 0.9532, 0.9316, 0.9532, 0.9316, 0.8992, 0.9279999999999999, 0.9388, 0.9532, 0.9172, 0.9532, 0.9136, 0.8344, 0.9172, 0.8848, 0.946, 0.9279999999999999, 0.9532, 0.9172, 0.9316, 0.5031999999999999, 0.9316, 0.9532, 0.6399999999999999, 0.946, 0.946, 0.9316, 0.8668, 0.9532, 0.9532, 0.9532, 0.9136, 0.9352, 0.9532, 0.9208000000000001, 0.9532, 0.946, 0.0, 0.946, 0.9316, 0.9028, 0.9532, 0.946, 0.8992, 0.8884, 0.8452, 0.946, 0.9316, 0.9244, 0.9244, 0.9208000000000001, 0.9532, 0.9496, 0.9532, 0.9352, 0.9532, 0.0, 0.9244, 0.9388, 0.9064, 0.9208000000000001, 0.8308, 0.946, 0.9532, 0.9279999999999999, 0.9388, 0.7624, 0.9532, 0.9388, 0.766, 0.9532, 0.8164, 0.946, 0.9424, 0.8884, 0.9532, 0.9532, 0.9172, 0.946, 0.82], "episode_lengths": [21, 16, 89, 16, 19, 15, 13, 13, 13, 30, 44, 13, 23, 15, 46, 16, 86, 6, 35, 27, 15, 13, 19, 13, 19, 28, 20, 17, 13, 23, 13, 24, 46, 23, 32, 15, 20, 13, 23, 19, 138, 19, 13, 100, 15, 15, 19, 37, 13, 13, 13, 24, 18, 13, 22, 13, 15, 6, 15, 19, 27, 13, 15, 28, 31, 43, 15, 19, 21, 21, 22, 13, 14, 13, 18, 13, 6, 21, 17, 26, 22, 47, 15, 13, 20, 17, 66, 13, 17, 65, 13, 51, 15, 16, 31, 13, 13, 23, 15, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4516205511157185, "mean_inference_ms": 1.2487352983345885, "mean_action_processing_ms": 0.12246712331340497, "mean_env_wait_ms": 0.36743089270916046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.1618034839630127}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8829879999999999, "episode_len_mean": 24.35, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9244, 0.9424, 0.6796, 0.9424, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.892, 0.8416, 0.9532, 0.9172, 0.946, 0.8344, 0.9424, 0.6904, 0.0, 0.874, 0.9028, 0.946, 0.9532, 0.9316, 0.9532, 0.9316, 0.8992, 0.9279999999999999, 0.9388, 0.9532, 0.9172, 0.9532, 0.9136, 0.8344, 0.9172, 0.8848, 0.946, 0.9279999999999999, 0.9532, 0.9172, 0.9316, 0.5031999999999999, 0.9316, 0.9532, 0.6399999999999999, 0.946, 0.946, 0.9316, 0.8668, 0.9532, 0.9532, 0.9532, 0.9136, 0.9352, 0.9532, 0.9208000000000001, 0.9532, 0.946, 0.0, 0.946, 0.9316, 0.9028, 0.9532, 0.946, 0.8992, 0.8884, 0.8452, 0.946, 0.9316, 0.9244, 0.9244, 0.9208000000000001, 0.9532, 0.9496, 0.9532, 0.9352, 0.9532, 0.0, 0.9244, 0.9388, 0.9064, 0.9208000000000001, 0.8308, 0.946, 0.9532, 0.9279999999999999, 0.9388, 0.7624, 0.9532, 0.9388, 0.766, 0.9532, 0.8164, 0.946, 0.9424, 0.8884, 0.9532, 0.9532, 0.9172, 0.946, 0.82], "episode_lengths": [21, 16, 89, 16, 19, 15, 13, 13, 13, 30, 44, 13, 23, 15, 46, 16, 86, 6, 35, 27, 15, 13, 19, 13, 19, 28, 20, 17, 13, 23, 13, 24, 46, 23, 32, 15, 20, 13, 23, 19, 138, 19, 13, 100, 15, 15, 19, 37, 13, 13, 13, 24, 18, 13, 22, 13, 15, 6, 15, 19, 27, 13, 15, 28, 31, 43, 15, 19, 21, 21, 22, 13, 14, 13, 18, 13, 6, 21, 17, 26, 22, 47, 15, 13, 20, 17, 66, 13, 17, 65, 13, 51, 15, 16, 31, 13, 13, 23, 15, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4516205511157185, "mean_inference_ms": 1.2487352983345885, "mean_action_processing_ms": 0.12246712331340497, "mean_env_wait_ms": 0.36743089270916046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.1618034839630127}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 58880, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 58880, "timers": {"training_iteration_time_ms": 2710.128, "sample_time_ms": 347.824, "load_time_ms": 0.601, "load_throughput": 2129003.894, "learn_time_ms": 2347.9, "learn_throughput": 545.168, "synch_weights_time_ms": 13.194}, "counters": {"num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "done": false, "episodes_total": 1627, "training_iteration": 46, "trial_id": "7d771_00000", "date": "2023-08-04_22-45-48", "timestamp": 1691203548, "time_this_iter_s": 11.218642950057983, "time_total_s": 707.1069731712341, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 707.1069731712341, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 67.50625, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8380239999999999, "episode_len_mean": 39.28, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0], "episode_lengths": [14, 18, 14, 14, 14, 14, 13, 13, 13, 15, 13, 13, 13, 15, 13, 250, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 15, 13, 13, 13, 13, 250, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 15, 6, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 250, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30142989890250044, "mean_inference_ms": 0.9031229211911351, "mean_action_processing_ms": 0.09498303893622168, "mean_env_wait_ms": 0.3099658063699179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0050389766693115234, "ViewRequirementAgentConnector_ms": 0.1754899024963379}, "clean_success_rate": 0.88, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.048920000000000005, "poison_episode_len_mean": 62.5, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 6, 13, 13, 13, 13, 6, 250, 13, 13, 13, 6, 250, 15, 13, 13, 250, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 6, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 6, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3016151184676426, "mean_inference_ms": 0.9032362292545073, "mean_action_processing_ms": 0.09500806493350078, "mean_env_wait_ms": 0.3099898294243144, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.005071163177490234, "ViewRequirementAgentConnector_ms": 0.1443800926208496}, "poison_success_rate": 0.05, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33026543746391934, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.031238531718651454, "policy_loss": -0.05074245732277632, "vf_loss": 0.008328897058963775, "vf_explained_var": 0.7265638955434164, "kl": 0.011037064338036846, "entropy": 0.5369187631209691, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 60160, "num_env_steps_trained": 60160, "num_agent_steps_sampled": 60160, "num_agent_steps_trained": 60160}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8895399999999998, "episode_len_mean": 22.57, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9316, 0.9028, 0.9532, 0.946, 0.8992, 0.8884, 0.8452, 0.946, 0.9316, 0.9244, 0.9244, 0.9208000000000001, 0.9532, 0.9496, 0.9532, 0.9352, 0.9532, 0.0, 0.9244, 0.9388, 0.9064, 0.9208000000000001, 0.8308, 0.946, 0.9532, 0.9279999999999999, 0.9388, 0.7624, 0.9532, 0.9388, 0.766, 0.9532, 0.8164, 0.946, 0.9424, 0.8884, 0.9532, 0.9532, 0.9172, 0.946, 0.82, 0.946, 0.9388, 0.9424, 0.9532, 0.8488, 0.9532, 0.9316, 0.9388, 0.946, 0.0, 0.9244, 0.9064, 0.946, 0.9532, 0.8344, 0.9388, 0.946, 0.946, 0.8236, 0.9532, 0.946, 0.7372000000000001, 0.9532, 0.9532, 0.946, 0.7552, 0.9496, 0.946, 0.9244, 0.8668, 0.946, 0.9388, 0.8775999999999999, 0.9388, 0.9388, 0.8668, 0.9532, 0.8452, 0.9388, 0.9532, 0.9496, 0.73, 0.9172, 0.9424, 0.946, 0.9064, 0.9388, 0.0, 0.9316, 0.946, 0.9279999999999999, 0.8812, 0.9532, 0.946, 0.9532, 0.946, 0.892, 0.9532], "episode_lengths": [15, 19, 27, 13, 15, 28, 31, 43, 15, 19, 21, 21, 22, 13, 14, 13, 18, 13, 6, 21, 17, 26, 22, 47, 15, 13, 20, 17, 66, 13, 17, 65, 13, 51, 15, 16, 31, 13, 13, 23, 15, 50, 15, 17, 16, 13, 42, 13, 19, 17, 15, 8, 21, 26, 15, 13, 46, 17, 15, 15, 49, 13, 15, 73, 13, 13, 15, 68, 14, 15, 21, 37, 15, 17, 34, 17, 17, 37, 13, 43, 17, 13, 14, 75, 23, 16, 15, 26, 17, 8, 19, 15, 20, 33, 13, 15, 13, 15, 30, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4514221210702874, "mean_inference_ms": 1.245332710220626, "mean_action_processing_ms": 0.12238095766762956, "mean_env_wait_ms": 0.36583304105178316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.15615057945251465}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8895399999999998, "episode_len_mean": 22.57, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.946, 0.9316, 0.9028, 0.9532, 0.946, 0.8992, 0.8884, 0.8452, 0.946, 0.9316, 0.9244, 0.9244, 0.9208000000000001, 0.9532, 0.9496, 0.9532, 0.9352, 0.9532, 0.0, 0.9244, 0.9388, 0.9064, 0.9208000000000001, 0.8308, 0.946, 0.9532, 0.9279999999999999, 0.9388, 0.7624, 0.9532, 0.9388, 0.766, 0.9532, 0.8164, 0.946, 0.9424, 0.8884, 0.9532, 0.9532, 0.9172, 0.946, 0.82, 0.946, 0.9388, 0.9424, 0.9532, 0.8488, 0.9532, 0.9316, 0.9388, 0.946, 0.0, 0.9244, 0.9064, 0.946, 0.9532, 0.8344, 0.9388, 0.946, 0.946, 0.8236, 0.9532, 0.946, 0.7372000000000001, 0.9532, 0.9532, 0.946, 0.7552, 0.9496, 0.946, 0.9244, 0.8668, 0.946, 0.9388, 0.8775999999999999, 0.9388, 0.9388, 0.8668, 0.9532, 0.8452, 0.9388, 0.9532, 0.9496, 0.73, 0.9172, 0.9424, 0.946, 0.9064, 0.9388, 0.0, 0.9316, 0.946, 0.9279999999999999, 0.8812, 0.9532, 0.946, 0.9532, 0.946, 0.892, 0.9532], "episode_lengths": [15, 19, 27, 13, 15, 28, 31, 43, 15, 19, 21, 21, 22, 13, 14, 13, 18, 13, 6, 21, 17, 26, 22, 47, 15, 13, 20, 17, 66, 13, 17, 65, 13, 51, 15, 16, 31, 13, 13, 23, 15, 50, 15, 17, 16, 13, 42, 13, 19, 17, 15, 8, 21, 26, 15, 13, 46, 17, 15, 15, 49, 13, 15, 73, 13, 13, 15, 68, 14, 15, 21, 37, 15, 17, 34, 17, 17, 37, 13, 43, 17, 13, 14, 75, 23, 16, 15, 26, 17, 8, 19, 15, 20, 33, 13, 15, 13, 15, 30, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4514221210702874, "mean_inference_ms": 1.245332710220626, "mean_action_processing_ms": 0.12238095766762956, "mean_env_wait_ms": 0.36583304105178316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.15615057945251465}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60160, "num_agent_steps_trained": 60160, "num_env_steps_sampled": 60160, "num_env_steps_trained": 60160, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 60160, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 60160, "timers": {"training_iteration_time_ms": 2667.082, "sample_time_ms": 346.601, "load_time_ms": 0.624, "load_throughput": 2050769.365, "learn_time_ms": 2302.61, "learn_throughput": 555.891, "synch_weights_time_ms": 16.619}, "counters": {"num_env_steps_sampled": 60160, "num_env_steps_trained": 60160, "num_agent_steps_sampled": 60160, "num_agent_steps_trained": 60160}, "done": false, "episodes_total": 1685, "training_iteration": 47, "trial_id": "7d771_00000", "date": "2023-08-04_22-45-59", "timestamp": 1691203559, "time_this_iter_s": 11.145357131958008, "time_total_s": 718.2523303031921, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 718.2523303031921, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 69.11875, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8569439999999999, "episode_len_mean": 37.02, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.946, 0.9532, 0.946, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 15, 13, 15, 13, 15, 13, 13, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 15, 13, 13, 15, 250, 13, 13, 13, 250, 15, 15, 13, 15, 250, 13, 15, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13, 250, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30174381768696257, "mean_inference_ms": 0.9034440828678123, "mean_action_processing_ms": 0.09502723220016933, "mean_env_wait_ms": 0.310059483234397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005074977874755859, "ViewRequirementAgentConnector_ms": 0.13655543327331543}, "clean_success_rate": 0.9, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 53.28, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 250, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3018230472447568, "mean_inference_ms": 0.9034400590730626, "mean_action_processing_ms": 0.09502787257540221, "mean_env_wait_ms": 0.3100783063648454, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004957437515258789, "ViewRequirementAgentConnector_ms": 0.13098740577697754}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30313140188654264, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.030769372706611953, "policy_loss": -0.045250767891605696, "vf_loss": 0.003989700112336626, "vf_explained_var": 0.7551845888296763, "kl": 0.010362167862185743, "entropy": 0.4541142018636068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 7125.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.897712, "episode_len_mean": 20.28, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7552, 0.9496, 0.946, 0.9244, 0.8668, 0.946, 0.9388, 0.8775999999999999, 0.9388, 0.9388, 0.8668, 0.9532, 0.8452, 0.9388, 0.9532, 0.9496, 0.73, 0.9172, 0.9424, 0.946, 0.9064, 0.9388, 0.0, 0.9316, 0.946, 0.9279999999999999, 0.8812, 0.9532, 0.946, 0.9532, 0.946, 0.892, 0.9532, 0.946, 0.9388, 0.0, 0.9532, 0.9064, 0.8884, 0.9208000000000001, 0.9424, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9388, 0.9064, 0.9532, 0.9316, 0.9532, 0.9316, 0.9532, 0.9316, 0.91, 0.946, 0.9316, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9424, 0.9532, 0.9208000000000001, 0.946, 0.9388, 0.9532, 0.9532, 0.946, 0.6579999999999999, 0.7948, 0.9279999999999999, 0.9388, 0.9532, 0.9388, 0.9244, 0.9244, 0.9532, 0.9532, 0.9279999999999999, 0.91, 0.9532, 0.9532, 0.9028, 0.9532, 0.9388, 0.9064, 0.0, 0.91, 0.9532, 0.946, 0.9244, 0.9532, 0.7732, 0.9532, 0.9532], "episode_lengths": [68, 14, 15, 21, 37, 15, 17, 34, 17, 17, 37, 13, 43, 17, 13, 14, 75, 23, 16, 15, 26, 17, 8, 19, 15, 20, 33, 13, 15, 13, 15, 30, 13, 15, 17, 6, 13, 26, 31, 22, 16, 15, 13, 13, 13, 13, 19, 13, 13, 17, 26, 13, 19, 13, 19, 13, 19, 25, 15, 19, 13, 13, 13, 15, 13, 16, 13, 22, 15, 17, 13, 13, 15, 95, 57, 20, 17, 13, 17, 21, 21, 13, 13, 20, 25, 13, 13, 27, 13, 17, 26, 6, 25, 13, 15, 21, 13, 63, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44949606224454386, "mean_inference_ms": 1.2381058405785856, "mean_action_processing_ms": 0.12177774012955375, "mean_env_wait_ms": 0.3641272445928368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004708051681518555, "ViewRequirementAgentConnector_ms": 0.13703608512878418}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.897712, "episode_len_mean": 20.28, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7552, 0.9496, 0.946, 0.9244, 0.8668, 0.946, 0.9388, 0.8775999999999999, 0.9388, 0.9388, 0.8668, 0.9532, 0.8452, 0.9388, 0.9532, 0.9496, 0.73, 0.9172, 0.9424, 0.946, 0.9064, 0.9388, 0.0, 0.9316, 0.946, 0.9279999999999999, 0.8812, 0.9532, 0.946, 0.9532, 0.946, 0.892, 0.9532, 0.946, 0.9388, 0.0, 0.9532, 0.9064, 0.8884, 0.9208000000000001, 0.9424, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9388, 0.9064, 0.9532, 0.9316, 0.9532, 0.9316, 0.9532, 0.9316, 0.91, 0.946, 0.9316, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9424, 0.9532, 0.9208000000000001, 0.946, 0.9388, 0.9532, 0.9532, 0.946, 0.6579999999999999, 0.7948, 0.9279999999999999, 0.9388, 0.9532, 0.9388, 0.9244, 0.9244, 0.9532, 0.9532, 0.9279999999999999, 0.91, 0.9532, 0.9532, 0.9028, 0.9532, 0.9388, 0.9064, 0.0, 0.91, 0.9532, 0.946, 0.9244, 0.9532, 0.7732, 0.9532, 0.9532], "episode_lengths": [68, 14, 15, 21, 37, 15, 17, 34, 17, 17, 37, 13, 43, 17, 13, 14, 75, 23, 16, 15, 26, 17, 8, 19, 15, 20, 33, 13, 15, 13, 15, 30, 13, 15, 17, 6, 13, 26, 31, 22, 16, 15, 13, 13, 13, 13, 19, 13, 13, 17, 26, 13, 19, 13, 19, 13, 19, 25, 15, 19, 13, 13, 13, 15, 13, 16, 13, 22, 15, 17, 13, 13, 15, 95, 57, 20, 17, 13, 17, 21, 21, 13, 13, 20, 25, 13, 13, 27, 13, 17, 26, 6, 25, 13, 15, 21, 13, 63, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44949606224454386, "mean_inference_ms": 1.2381058405785856, "mean_action_processing_ms": 0.12177774012955375, "mean_env_wait_ms": 0.3641272445928368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004708051681518555, "ViewRequirementAgentConnector_ms": 0.13703608512878418}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 61440, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 2670.462, "sample_time_ms": 337.207, "load_time_ms": 0.637, "load_throughput": 2007969.899, "learn_time_ms": 2315.17, "learn_throughput": 552.875, "synch_weights_time_ms": 16.81}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "episodes_total": 1752, "training_iteration": 48, "trial_id": "7d771_00000", "date": "2023-08-04_22-46-10", "timestamp": 1691203570, "time_this_iter_s": 10.459146738052368, "time_total_s": 728.7114770412445, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 728.7114770412445, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 65.67333333333333, "ram_util_percent": 19.506666666666668}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8287799999999999, "episode_len_mean": 39.13, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.946, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 15, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250, 250, 13, 13, 13, 13, 250, 6, 13, 15, 13, 13, 13, 13, 13, 13, 15, 13, 15, 13, 13, 13, 13, 15, 13, 13, 13, 250, 13, 13, 13, 250, 13, 15, 13, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3019903520928872, "mean_inference_ms": 0.9036426515409264, "mean_action_processing_ms": 0.09505208929792026, "mean_env_wait_ms": 0.3101233995834362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005033969879150391, "ViewRequirementAgentConnector_ms": 0.14835262298583984}, "clean_success_rate": 0.87, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 48.67, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 6, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 15, 250, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 250, 15, 13, 250, 250, 13, 13, 15, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 15, 13, 15, 250, 13, 15, 250, 13, 250, 13, 13, 13, 15, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 17, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3020928764406907, "mean_inference_ms": 0.9036323225480514, "mean_action_processing_ms": 0.09506012508145076, "mean_env_wait_ms": 0.3101105755415874, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004984140396118164, "ViewRequirementAgentConnector_ms": 0.1458289623260498}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3125364421804746, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02911267598470052, "policy_loss": -0.04671530852715174, "vf_loss": 0.007005491331219673, "vf_explained_var": 0.6818434723218282, "kl": 0.010466310062050373, "entropy": 0.532504278421402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 7275.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 62720, "num_env_steps_trained": 62720, "num_agent_steps_sampled": 62720, "num_agent_steps_trained": 62720}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8944719999999999, "episode_len_mean": 21.26, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9424, 0.9532, 0.9208000000000001, 0.946, 0.9388, 0.9532, 0.9532, 0.946, 0.6579999999999999, 0.7948, 0.9279999999999999, 0.9388, 0.9532, 0.9388, 0.9244, 0.9244, 0.9532, 0.9532, 0.9279999999999999, 0.91, 0.9532, 0.9532, 0.9028, 0.9532, 0.9388, 0.9064, 0.0, 0.91, 0.9532, 0.946, 0.9244, 0.9532, 0.7732, 0.9532, 0.9532, 0.9532, 0.892, 0.946, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9172, 0.8848, 0.9532, 0.8884, 0.7156, 0.9496, 0.0, 0.946, 0.874, 0.9532, 0.9388, 0.91, 0.9352, 0.0, 0.9532, 0.9388, 0.946, 0.9172, 0.8704000000000001, 0.9532, 0.9279999999999999, 0.7984, 0.9532, 0.946, 0.9532, 0.8056, 0.9532, 0.7228, 0.9388, 0.9316, 0.9532, 0.9532, 0.946, 0.9388, 0.7228, 0.946, 0.9532, 0.856, 0.8812, 0.9532, 0.9532, 0.9244, 0.9388, 0.9388, 0.9532, 0.9316, 0.946, 0.9532, 0.9532, 0.9532], "episode_lengths": [13, 13, 13, 15, 13, 16, 13, 22, 15, 17, 13, 13, 15, 95, 57, 20, 17, 13, 17, 21, 21, 13, 13, 20, 25, 13, 13, 27, 13, 17, 26, 6, 25, 13, 15, 21, 13, 63, 13, 13, 13, 30, 15, 13, 15, 15, 13, 13, 16, 15, 23, 32, 13, 31, 79, 14, 8, 15, 35, 13, 17, 25, 18, 14, 13, 17, 15, 23, 36, 13, 20, 56, 13, 15, 13, 54, 13, 77, 17, 19, 13, 13, 15, 17, 77, 15, 13, 40, 33, 13, 13, 21, 17, 17, 13, 19, 15, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44881522666590745, "mean_inference_ms": 1.2348221101574577, "mean_action_processing_ms": 0.12180012574432354, "mean_env_wait_ms": 0.3626493847006621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004958391189575195, "ViewRequirementAgentConnector_ms": 0.14716386795043945}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8944719999999999, "episode_len_mean": 21.26, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9424, 0.9532, 0.9208000000000001, 0.946, 0.9388, 0.9532, 0.9532, 0.946, 0.6579999999999999, 0.7948, 0.9279999999999999, 0.9388, 0.9532, 0.9388, 0.9244, 0.9244, 0.9532, 0.9532, 0.9279999999999999, 0.91, 0.9532, 0.9532, 0.9028, 0.9532, 0.9388, 0.9064, 0.0, 0.91, 0.9532, 0.946, 0.9244, 0.9532, 0.7732, 0.9532, 0.9532, 0.9532, 0.892, 0.946, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9172, 0.8848, 0.9532, 0.8884, 0.7156, 0.9496, 0.0, 0.946, 0.874, 0.9532, 0.9388, 0.91, 0.9352, 0.0, 0.9532, 0.9388, 0.946, 0.9172, 0.8704000000000001, 0.9532, 0.9279999999999999, 0.7984, 0.9532, 0.946, 0.9532, 0.8056, 0.9532, 0.7228, 0.9388, 0.9316, 0.9532, 0.9532, 0.946, 0.9388, 0.7228, 0.946, 0.9532, 0.856, 0.8812, 0.9532, 0.9532, 0.9244, 0.9388, 0.9388, 0.9532, 0.9316, 0.946, 0.9532, 0.9532, 0.9532], "episode_lengths": [13, 13, 13, 15, 13, 16, 13, 22, 15, 17, 13, 13, 15, 95, 57, 20, 17, 13, 17, 21, 21, 13, 13, 20, 25, 13, 13, 27, 13, 17, 26, 6, 25, 13, 15, 21, 13, 63, 13, 13, 13, 30, 15, 13, 15, 15, 13, 13, 16, 15, 23, 32, 13, 31, 79, 14, 8, 15, 35, 13, 17, 25, 18, 14, 13, 17, 15, 23, 36, 13, 20, 56, 13, 15, 13, 54, 13, 77, 17, 19, 13, 13, 15, 17, 77, 15, 13, 40, 33, 13, 13, 21, 17, 17, 13, 19, 15, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44881522666590745, "mean_inference_ms": 1.2348221101574577, "mean_action_processing_ms": 0.12180012574432354, "mean_env_wait_ms": 0.3626493847006621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004958391189575195, "ViewRequirementAgentConnector_ms": 0.14716386795043945}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62720, "num_agent_steps_trained": 62720, "num_env_steps_sampled": 62720, "num_env_steps_trained": 62720, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 62720, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 62720, "timers": {"training_iteration_time_ms": 2580.328, "sample_time_ms": 334.685, "load_time_ms": 0.636, "load_throughput": 2013769.362, "learn_time_ms": 2226.646, "learn_throughput": 574.856, "synch_weights_time_ms": 17.702}, "counters": {"num_env_steps_sampled": 62720, "num_env_steps_trained": 62720, "num_agent_steps_sampled": 62720, "num_agent_steps_trained": 62720}, "done": false, "episodes_total": 1812, "training_iteration": 49, "trial_id": "7d771_00000", "date": "2023-08-04_22-46-19", "timestamp": 1691203579, "time_this_iter_s": 9.299079179763794, "time_total_s": 738.0105562210083, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 738.0105562210083, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 68.07692307692308, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8475919999999998, "episode_len_mean": 34.46, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 18, 13, 13, 13, 13, 250, 13, 15, 13, 13, 13, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 6, 15, 13, 13, 250, 13, 13, 250, 13, 13, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30231228373588026, "mean_inference_ms": 0.9040638276330902, "mean_action_processing_ms": 0.09511278958861338, "mean_env_wait_ms": 0.310197972328784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005416154861450195, "ViewRequirementAgentConnector_ms": 0.15265750885009766}, "clean_success_rate": 0.89, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 43.87, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 250, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 16, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 6, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3024588902343848, "mean_inference_ms": 0.9042213679422387, "mean_action_processing_ms": 0.09512743424865794, "mean_env_wait_ms": 0.31021331808494107, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004729747772216797, "ViewRequirementAgentConnector_ms": 0.12577247619628906}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3200507200260957, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.012842066586017609, "policy_loss": -0.030914224982261658, "vf_loss": 0.009510912484644602, "vf_explained_var": 0.6453717271486918, "kl": 0.008455549876574271, "entropy": 0.45167539834976195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 7425.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8981079999999999, "episode_len_mean": 20.82, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9388, 0.946, 0.9172, 0.8704000000000001, 0.9532, 0.9279999999999999, 0.7984, 0.9532, 0.946, 0.9532, 0.8056, 0.9532, 0.7228, 0.9388, 0.9316, 0.9532, 0.9532, 0.946, 0.9388, 0.7228, 0.946, 0.9532, 0.856, 0.8812, 0.9532, 0.9532, 0.9244, 0.9388, 0.9388, 0.9532, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9388, 0.9424, 0.91, 0.9388, 0.9244, 0.946, 0.946, 0.9532, 0.0, 0.9532, 0.946, 0.9496, 0.7444, 0.9316, 0.9532, 0.9532, 0.946, 0.82, 0.8344, 0.9532, 0.9352, 0.9532, 0.9388, 0.9532, 0.9532, 0.9424, 0.9532, 0.9316, 0.946, 0.9424, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9316, 0.946, 0.9352, 0.0, 0.838, 0.9532, 0.8308, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9316, 0.9532, 0.9279999999999999, 0.892, 0.946, 0.946, 0.91, 0.9532, 0.9532, 0.9352, 0.8271999999999999, 0.946, 0.9388, 0.9316, 0.9532, 0.9532, 0.946], "episode_lengths": [17, 15, 23, 36, 13, 20, 56, 13, 15, 13, 54, 13, 77, 17, 19, 13, 13, 15, 17, 77, 15, 13, 40, 33, 13, 13, 21, 17, 17, 13, 19, 15, 13, 13, 13, 73, 17, 16, 25, 17, 21, 15, 15, 13, 6, 13, 15, 14, 71, 19, 13, 13, 15, 50, 46, 13, 18, 13, 17, 13, 13, 16, 13, 19, 15, 16, 13, 13, 13, 17, 13, 19, 15, 18, 6, 45, 13, 47, 15, 13, 13, 16, 15, 19, 13, 20, 30, 15, 15, 25, 13, 13, 18, 48, 15, 17, 19, 13, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45275737139330663, "mean_inference_ms": 1.2359298404427606, "mean_action_processing_ms": 0.12260971015834325, "mean_env_wait_ms": 0.36329652828159575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0051190853118896484, "ViewRequirementAgentConnector_ms": 0.18105030059814453}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8981079999999999, "episode_len_mean": 20.82, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9388, 0.946, 0.9172, 0.8704000000000001, 0.9532, 0.9279999999999999, 0.7984, 0.9532, 0.946, 0.9532, 0.8056, 0.9532, 0.7228, 0.9388, 0.9316, 0.9532, 0.9532, 0.946, 0.9388, 0.7228, 0.946, 0.9532, 0.856, 0.8812, 0.9532, 0.9532, 0.9244, 0.9388, 0.9388, 0.9532, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9388, 0.9424, 0.91, 0.9388, 0.9244, 0.946, 0.946, 0.9532, 0.0, 0.9532, 0.946, 0.9496, 0.7444, 0.9316, 0.9532, 0.9532, 0.946, 0.82, 0.8344, 0.9532, 0.9352, 0.9532, 0.9388, 0.9532, 0.9532, 0.9424, 0.9532, 0.9316, 0.946, 0.9424, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9316, 0.946, 0.9352, 0.0, 0.838, 0.9532, 0.8308, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9316, 0.9532, 0.9279999999999999, 0.892, 0.946, 0.946, 0.91, 0.9532, 0.9532, 0.9352, 0.8271999999999999, 0.946, 0.9388, 0.9316, 0.9532, 0.9532, 0.946], "episode_lengths": [17, 15, 23, 36, 13, 20, 56, 13, 15, 13, 54, 13, 77, 17, 19, 13, 13, 15, 17, 77, 15, 13, 40, 33, 13, 13, 21, 17, 17, 13, 19, 15, 13, 13, 13, 73, 17, 16, 25, 17, 21, 15, 15, 13, 6, 13, 15, 14, 71, 19, 13, 13, 15, 50, 46, 13, 18, 13, 17, 13, 13, 16, 13, 19, 15, 16, 13, 13, 13, 17, 13, 19, 15, 18, 6, 45, 13, 47, 15, 13, 13, 16, 15, 19, 13, 20, 30, 15, 15, 25, 13, 13, 18, 48, 15, 17, 19, 13, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45275737139330663, "mean_inference_ms": 1.2359298404427606, "mean_action_processing_ms": 0.12260971015834325, "mean_env_wait_ms": 0.36329652828159575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0051190853118896484, "ViewRequirementAgentConnector_ms": 0.18105030059814453}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 64000, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 2615.604, "sample_time_ms": 343.531, "load_time_ms": 0.636, "load_throughput": 2013014.293, "learn_time_ms": 2252.965, "learn_throughput": 568.14, "synch_weights_time_ms": 17.805}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 1877, "training_iteration": 50, "trial_id": "7d771_00000", "date": "2023-08-04_22-46-28", "timestamp": 1691203588, "time_this_iter_s": 9.061855792999268, "time_total_s": 747.0724120140076, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 747.0724120140076, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 68.01538461538462, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8850359999999999, "episode_len_mean": 22.73, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9388, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9352, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 6, 13, 15, 13, 17, 13, 15, 13, 13, 13, 13, 18, 13, 13, 13, 13, 18, 13, 18, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 15, 13, 18, 15, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 6, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 15, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3027253222495089, "mean_inference_ms": 0.9048609201391122, "mean_action_processing_ms": 0.09519110009004761, "mean_env_wait_ms": 0.3103817468709042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.018546342849731445, "ViewRequirementAgentConnector_ms": 0.17628717422485352}, "clean_success_rate": 0.93, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 46.32, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 250, 250, 13, 13, 15, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 250, 13, 15, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 15, 13, 13, 250, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3028732741972625, "mean_inference_ms": 0.9051241743978358, "mean_action_processing_ms": 0.09521464150360329, "mean_env_wait_ms": 0.31041245203589884, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004899263381958008, "ViewRequirementAgentConnector_ms": 0.14249348640441895}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32691900700330734, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02383282233029604, "policy_loss": -0.04296947911692162, "vf_loss": 0.01064124921647211, "vf_explained_var": 0.5837273160616557, "kl": 0.008390527413527403, "entropy": 0.44641929864883423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 7575.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 65280, "num_env_steps_trained": 65280, "num_agent_steps_sampled": 65280, "num_agent_steps_trained": 65280}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9028240000000001, "episode_len_mean": 18.92, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9316, 0.946, 0.9352, 0.0, 0.838, 0.9532, 0.8308, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9316, 0.9532, 0.9279999999999999, 0.892, 0.946, 0.946, 0.91, 0.9532, 0.9532, 0.9352, 0.8271999999999999, 0.946, 0.9388, 0.9316, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.694, 0.9532, 0.9388, 0.9208000000000001, 0.9352, 0.9532, 0.946, 0.9388, 0.946, 0.9352, 0.9424, 0.9532, 0.91, 0.946, 0.9532, 0.9532, 0.9532, 0.8524, 0.946, 0.9532, 0.946, 0.9532, 0.0, 0.9388, 0.8704000000000001, 0.946, 0.9388, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9352, 0.9532, 0.9532, 0.748, 0.9388, 0.946, 0.9316, 0.9424, 0.9532, 0.9388, 0.9532, 0.9532, 0.7984, 0.8632, 0.9352, 0.946, 0.9388, 0.9532, 0.9532, 0.9424, 0.9532, 0.9244, 0.9316, 0.946, 0.946, 0.8704000000000001, 0.9496, 0.9388], "episode_lengths": [13, 13, 13, 17, 13, 19, 15, 18, 6, 45, 13, 47, 15, 13, 13, 16, 15, 19, 13, 20, 30, 15, 15, 25, 13, 13, 18, 48, 15, 17, 19, 13, 13, 15, 15, 13, 85, 13, 17, 22, 18, 13, 15, 17, 15, 18, 16, 13, 25, 15, 13, 13, 13, 41, 15, 13, 15, 13, 14, 17, 36, 15, 17, 13, 6, 13, 15, 13, 13, 13, 13, 30, 18, 13, 13, 70, 17, 15, 19, 16, 13, 17, 13, 13, 56, 38, 18, 15, 17, 13, 13, 16, 13, 21, 19, 15, 15, 36, 14, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46094176863941927, "mean_inference_ms": 1.2572503092151934, "mean_action_processing_ms": 0.12318369436568563, "mean_env_wait_ms": 0.3684223374257639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00555419921875, "ViewRequirementAgentConnector_ms": 0.37628841400146484}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9028240000000001, "episode_len_mean": 18.92, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9316, 0.946, 0.9352, 0.0, 0.838, 0.9532, 0.8308, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9316, 0.9532, 0.9279999999999999, 0.892, 0.946, 0.946, 0.91, 0.9532, 0.9532, 0.9352, 0.8271999999999999, 0.946, 0.9388, 0.9316, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.694, 0.9532, 0.9388, 0.9208000000000001, 0.9352, 0.9532, 0.946, 0.9388, 0.946, 0.9352, 0.9424, 0.9532, 0.91, 0.946, 0.9532, 0.9532, 0.9532, 0.8524, 0.946, 0.9532, 0.946, 0.9532, 0.0, 0.9388, 0.8704000000000001, 0.946, 0.9388, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9352, 0.9532, 0.9532, 0.748, 0.9388, 0.946, 0.9316, 0.9424, 0.9532, 0.9388, 0.9532, 0.9532, 0.7984, 0.8632, 0.9352, 0.946, 0.9388, 0.9532, 0.9532, 0.9424, 0.9532, 0.9244, 0.9316, 0.946, 0.946, 0.8704000000000001, 0.9496, 0.9388], "episode_lengths": [13, 13, 13, 17, 13, 19, 15, 18, 6, 45, 13, 47, 15, 13, 13, 16, 15, 19, 13, 20, 30, 15, 15, 25, 13, 13, 18, 48, 15, 17, 19, 13, 13, 15, 15, 13, 85, 13, 17, 22, 18, 13, 15, 17, 15, 18, 16, 13, 25, 15, 13, 13, 13, 41, 15, 13, 15, 13, 14, 17, 36, 15, 17, 13, 6, 13, 15, 13, 13, 13, 13, 30, 18, 13, 13, 70, 17, 15, 19, 16, 13, 17, 13, 13, 56, 38, 18, 15, 17, 13, 13, 16, 13, 21, 19, 15, 15, 36, 14, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46094176863941927, "mean_inference_ms": 1.2572503092151934, "mean_action_processing_ms": 0.12318369436568563, "mean_env_wait_ms": 0.3684223374257639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00555419921875, "ViewRequirementAgentConnector_ms": 0.37628841400146484}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65280, "num_agent_steps_trained": 65280, "num_env_steps_sampled": 65280, "num_env_steps_trained": 65280, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 65280, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 65280, "timers": {"training_iteration_time_ms": 2725.554, "sample_time_ms": 381.456, "load_time_ms": 0.644, "load_throughput": 1986424.361, "learn_time_ms": 2325.749, "learn_throughput": 550.36, "synch_weights_time_ms": 17.043}, "counters": {"num_env_steps_sampled": 65280, "num_env_steps_trained": 65280, "num_agent_steps_sampled": 65280, "num_agent_steps_trained": 65280}, "done": false, "episodes_total": 1943, "training_iteration": 51, "trial_id": "7d771_00000", "date": "2023-08-04_22-46-36", "timestamp": 1691203596, "time_this_iter_s": 7.884495735168457, "time_total_s": 754.956907749176, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 754.956907749176, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 68.63636363636363, "ram_util_percent": 19.518181818181816}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8568359999999999, "episode_len_mean": 29.73, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 15, 13, 13, 250, 250, 15, 13, 13, 13, 18, 13, 13, 13, 13, 15, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 250, 13, 13, 18, 13, 13, 13, 13, 13, 15, 6, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 15, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3031380787589904, "mean_inference_ms": 0.9056042490207225, "mean_action_processing_ms": 0.09525050955137117, "mean_env_wait_ms": 0.3105109185362107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008462905883789062, "ViewRequirementAgentConnector_ms": 0.15050029754638672}, "clean_success_rate": 0.9, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 34.91, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0], "episode_lengths": [16, 14, 18, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 21, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 15, 19, 13, 13, 13, 13, 13, 13, 15, 13, 13, 19, 15, 13, 19, 19, 13, 13, 19, 13, 250, 13, 13, 13, 13, 13, 13, 21, 13, 6, 13, 13, 250, 19, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3032870740982835, "mean_inference_ms": 0.905807028662742, "mean_action_processing_ms": 0.09525962562099988, "mean_env_wait_ms": 0.310548115259605, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004643440246582031, "ViewRequirementAgentConnector_ms": 0.125}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3916551834344864, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.027539338270823163, "policy_loss": -0.0498160590728124, "vf_loss": 0.008635725403049339, "vf_explained_var": 0.5477714685599009, "kl": 0.013472591261039876, "entropy": 0.47239793300628663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 7725.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9052279999999999, "episode_len_mean": 20.91, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8704000000000001, 0.946, 0.9388, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9352, 0.9532, 0.9532, 0.748, 0.9388, 0.946, 0.9316, 0.9424, 0.9532, 0.9388, 0.9532, 0.9532, 0.7984, 0.8632, 0.9352, 0.946, 0.9388, 0.9532, 0.9532, 0.9424, 0.9532, 0.9244, 0.9316, 0.946, 0.946, 0.8704000000000001, 0.9496, 0.9388, 0.9496, 0.946, 0.8848, 0.8452, 0.9532, 0.9532, 0.8668, 0.9316, 0.946, 0.9316, 0.9388, 0.9388, 0.9388, 0.9532, 0.9244, 0.9532, 0.946, 0.9532, 0.9388, 0.946, 0.9532, 0.874, 0.9064, 0.9316, 0.9388, 0.91, 0.946, 0.9532, 0.9172, 0.9532, 0.9496, 0.946, 0.9208000000000001, 0.946, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9316, 0.9279999999999999, 0.9532, 0.9388, 0.478, 0.9532, 0.9496, 0.9424, 0.6652, 0.8812, 0.8884, 0.8704000000000001, 0.946, 0.9532, 0.9532, 0.8236, 0.9532, 0.9279999999999999, 0.9532, 0.9388], "episode_lengths": [36, 15, 17, 13, 6, 13, 15, 13, 13, 13, 13, 30, 18, 13, 13, 70, 17, 15, 19, 16, 13, 17, 13, 13, 56, 38, 18, 15, 17, 13, 13, 16, 13, 21, 19, 15, 15, 36, 14, 17, 14, 15, 32, 43, 13, 13, 37, 19, 15, 19, 17, 17, 17, 13, 21, 13, 15, 13, 17, 15, 13, 35, 26, 19, 17, 25, 15, 13, 23, 13, 14, 15, 22, 15, 15, 13, 13, 8, 13, 13, 19, 20, 13, 17, 145, 13, 14, 16, 93, 33, 31, 36, 15, 13, 13, 49, 13, 20, 13, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4650587350287924, "mean_inference_ms": 1.2628506637138315, "mean_action_processing_ms": 0.12463545117016533, "mean_env_wait_ms": 0.37035314634750266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005215883255004883, "ViewRequirementAgentConnector_ms": 0.2582571506500244}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9052279999999999, "episode_len_mean": 20.91, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8704000000000001, 0.946, 0.9388, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9352, 0.9532, 0.9532, 0.748, 0.9388, 0.946, 0.9316, 0.9424, 0.9532, 0.9388, 0.9532, 0.9532, 0.7984, 0.8632, 0.9352, 0.946, 0.9388, 0.9532, 0.9532, 0.9424, 0.9532, 0.9244, 0.9316, 0.946, 0.946, 0.8704000000000001, 0.9496, 0.9388, 0.9496, 0.946, 0.8848, 0.8452, 0.9532, 0.9532, 0.8668, 0.9316, 0.946, 0.9316, 0.9388, 0.9388, 0.9388, 0.9532, 0.9244, 0.9532, 0.946, 0.9532, 0.9388, 0.946, 0.9532, 0.874, 0.9064, 0.9316, 0.9388, 0.91, 0.946, 0.9532, 0.9172, 0.9532, 0.9496, 0.946, 0.9208000000000001, 0.946, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9316, 0.9279999999999999, 0.9532, 0.9388, 0.478, 0.9532, 0.9496, 0.9424, 0.6652, 0.8812, 0.8884, 0.8704000000000001, 0.946, 0.9532, 0.9532, 0.8236, 0.9532, 0.9279999999999999, 0.9532, 0.9388], "episode_lengths": [36, 15, 17, 13, 6, 13, 15, 13, 13, 13, 13, 30, 18, 13, 13, 70, 17, 15, 19, 16, 13, 17, 13, 13, 56, 38, 18, 15, 17, 13, 13, 16, 13, 21, 19, 15, 15, 36, 14, 17, 14, 15, 32, 43, 13, 13, 37, 19, 15, 19, 17, 17, 17, 13, 21, 13, 15, 13, 17, 15, 13, 35, 26, 19, 17, 25, 15, 13, 23, 13, 14, 15, 22, 15, 15, 13, 13, 8, 13, 13, 19, 20, 13, 17, 145, 13, 14, 16, 93, 33, 31, 36, 15, 13, 13, 49, 13, 20, 13, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4650587350287924, "mean_inference_ms": 1.2628506637138315, "mean_action_processing_ms": 0.12463545117016533, "mean_env_wait_ms": 0.37035314634750266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005215883255004883, "ViewRequirementAgentConnector_ms": 0.2582571506500244}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 66560, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 66560, "timers": {"training_iteration_time_ms": 2770.081, "sample_time_ms": 384.404, "load_time_ms": 0.655, "load_throughput": 1954034.257, "learn_time_ms": 2369.573, "learn_throughput": 540.182, "synch_weights_time_ms": 14.803}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "done": false, "episodes_total": 2003, "training_iteration": 52, "trial_id": "7d771_00000", "date": "2023-08-04_22-46-44", "timestamp": 1691203604, "time_this_iter_s": 8.088067531585693, "time_total_s": 763.0449752807617, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 763.0449752807617, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 67.54166666666667, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8843519999999999, "episode_len_mean": 27.8, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9352, 0.9532, 0.9352, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9352, 0.0, 0.946, 0.9532, 0.946, 0.9532, 0.9352, 0.946, 0.946, 0.9532, 0.946, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 16, 14, 14, 13, 13, 13, 13, 13, 250, 13, 13, 15, 15, 13, 13, 13, 13, 15, 13, 15, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 15, 13, 13, 13, 13, 13, 15, 13, 13, 13, 15, 13, 13, 15, 18, 13, 18, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 15, 250, 13, 15, 13, 13, 18, 250, 15, 13, 15, 13, 18, 15, 15, 13, 15, 250, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30348906401539355, "mean_inference_ms": 0.9060952229379967, "mean_action_processing_ms": 0.0952775850631466, "mean_env_wait_ms": 0.31057330961628826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004842996597290039, "ViewRequirementAgentConnector_ms": 0.14155817031860352}, "clean_success_rate": 0.93, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.039136000000000004, "poison_episode_len_mean": 48.53, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 250, 13, 13, 250, 250, 13, 13, 6, 13, 6, 13, 13, 13, 13, 19, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 19, 13, 13, 13, 13, 13, 13, 250, 13, 13, 19, 13, 13, 13, 13, 13, 13, 6, 250, 13, 13, 13, 13, 13, 13, 13, 13, 6, 15, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30361667499948064, "mean_inference_ms": 0.9061450126730403, "mean_action_processing_ms": 0.09529265669198067, "mean_env_wait_ms": 0.31053672813434885, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0049936771392822266, "ViewRequirementAgentConnector_ms": 0.137406587600708}, "poison_success_rate": 0.04, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.340704232553641, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.03192368563264608, "policy_loss": -0.04797453723847866, "vf_loss": 0.004536860873146604, "vf_explained_var": 0.6204980997244517, "kl": 0.011371843947296536, "entropy": 0.449302529891332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 7875.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 67840, "num_env_steps_trained": 67840, "num_agent_steps_sampled": 67840, "num_agent_steps_trained": 67840}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.906596, "episode_len_mean": 20.53, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9496, 0.946, 0.9208000000000001, 0.946, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9316, 0.9279999999999999, 0.9532, 0.9388, 0.478, 0.9532, 0.9496, 0.9424, 0.6652, 0.8812, 0.8884, 0.8704000000000001, 0.946, 0.9532, 0.9532, 0.8236, 0.9532, 0.9279999999999999, 0.9532, 0.9388, 0.946, 0.946, 0.8884, 0.946, 0.9532, 0.946, 0.9532, 0.9424, 0.9532, 0.9388, 0.9279999999999999, 0.0, 0.9532, 0.7876, 0.874, 0.9388, 0.9388, 0.946, 0.946, 0.9316, 0.9532, 0.9532, 0.9136, 0.9532, 0.9388, 0.9316, 0.946, 0.8956, 0.9388, 0.9532, 0.856, 0.9352, 0.9532, 0.946, 0.9496, 0.946, 0.9279999999999999, 0.9532, 0.9532, 0.9388, 0.9136, 0.946, 0.9532, 0.946, 0.9388, 0.9532, 0.7732, 0.8488, 0.9064, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9028, 0.9532, 0.9532, 0.9532, 0.9532, 0.8416, 0.946, 0.9316, 0.9316, 0.9388, 0.9532, 0.9532, 0.9424, 0.9316], "episode_lengths": [13, 14, 15, 22, 15, 15, 13, 13, 8, 13, 13, 19, 20, 13, 17, 145, 13, 14, 16, 93, 33, 31, 36, 15, 13, 13, 49, 13, 20, 13, 17, 15, 15, 31, 15, 13, 15, 13, 16, 13, 17, 20, 6, 13, 59, 35, 17, 17, 15, 15, 19, 13, 13, 24, 13, 17, 19, 15, 29, 17, 13, 40, 18, 13, 15, 14, 15, 20, 13, 13, 17, 24, 15, 13, 15, 17, 13, 63, 42, 26, 13, 13, 19, 13, 13, 13, 27, 13, 13, 13, 13, 44, 15, 19, 19, 17, 13, 13, 16, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46479967443107695, "mean_inference_ms": 1.260034950887606, "mean_action_processing_ms": 0.12446416074405173, "mean_env_wait_ms": 0.3697834341961979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.17155098915100098}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.906596, "episode_len_mean": 20.53, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9496, 0.946, 0.9208000000000001, 0.946, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9316, 0.9279999999999999, 0.9532, 0.9388, 0.478, 0.9532, 0.9496, 0.9424, 0.6652, 0.8812, 0.8884, 0.8704000000000001, 0.946, 0.9532, 0.9532, 0.8236, 0.9532, 0.9279999999999999, 0.9532, 0.9388, 0.946, 0.946, 0.8884, 0.946, 0.9532, 0.946, 0.9532, 0.9424, 0.9532, 0.9388, 0.9279999999999999, 0.0, 0.9532, 0.7876, 0.874, 0.9388, 0.9388, 0.946, 0.946, 0.9316, 0.9532, 0.9532, 0.9136, 0.9532, 0.9388, 0.9316, 0.946, 0.8956, 0.9388, 0.9532, 0.856, 0.9352, 0.9532, 0.946, 0.9496, 0.946, 0.9279999999999999, 0.9532, 0.9532, 0.9388, 0.9136, 0.946, 0.9532, 0.946, 0.9388, 0.9532, 0.7732, 0.8488, 0.9064, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9028, 0.9532, 0.9532, 0.9532, 0.9532, 0.8416, 0.946, 0.9316, 0.9316, 0.9388, 0.9532, 0.9532, 0.9424, 0.9316], "episode_lengths": [13, 14, 15, 22, 15, 15, 13, 13, 8, 13, 13, 19, 20, 13, 17, 145, 13, 14, 16, 93, 33, 31, 36, 15, 13, 13, 49, 13, 20, 13, 17, 15, 15, 31, 15, 13, 15, 13, 16, 13, 17, 20, 6, 13, 59, 35, 17, 17, 15, 15, 19, 13, 13, 24, 13, 17, 19, 15, 29, 17, 13, 40, 18, 13, 15, 14, 15, 20, 13, 13, 17, 24, 15, 13, 15, 17, 13, 63, 42, 26, 13, 13, 19, 13, 13, 13, 27, 13, 13, 13, 13, 44, 15, 19, 19, 17, 13, 13, 16, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46479967443107695, "mean_inference_ms": 1.260034950887606, "mean_action_processing_ms": 0.12446416074405173, "mean_env_wait_ms": 0.3697834341961979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.17155098915100098}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67840, "num_agent_steps_trained": 67840, "num_env_steps_sampled": 67840, "num_env_steps_trained": 67840, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 67840, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 67840, "timers": {"training_iteration_time_ms": 2787.777, "sample_time_ms": 388.768, "load_time_ms": 0.654, "load_throughput": 1956597.952, "learn_time_ms": 2381.788, "learn_throughput": 537.411, "synch_weights_time_ms": 15.918}, "counters": {"num_env_steps_sampled": 67840, "num_env_steps_trained": 67840, "num_agent_steps_sampled": 67840, "num_agent_steps_trained": 67840}, "done": false, "episodes_total": 2072, "training_iteration": 53, "trial_id": "7d771_00000", "date": "2023-08-04_22-46-53", "timestamp": 1691203613, "time_this_iter_s": 8.627827405929565, "time_total_s": 771.6728026866913, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 771.6728026866913, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 65.8, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.884604, "episode_len_mean": 22.85, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.946, 0.0, 0.946, 0.946, 0.9352, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9352, 0.9532, 0.9532, 0.9352, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [16, 16, 14, 14, 14, 16, 13, 13, 13, 15, 13, 6, 13, 13, 15, 13, 6, 13, 15, 13, 13, 13, 13, 13, 18, 13, 13, 13, 6, 13, 13, 15, 13, 250, 15, 250, 15, 15, 18, 250, 13, 15, 13, 13, 13, 13, 15, 18, 13, 13, 18, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 15, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.303827267104767, "mean_inference_ms": 0.9063098718944534, "mean_action_processing_ms": 0.09530708643031147, "mean_env_wait_ms": 0.3106030668107189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005091190338134766, "ViewRequirementAgentConnector_ms": 0.1578655242919922}, "clean_success_rate": 0.93, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 48.72, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 15, 250, 250, 13, 13, 250, 13, 6, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 250, 13, 250, 13, 13, 13, 15, 13, 15, 13, 13, 13, 13, 250, 13, 13, 13, 13, 15, 13, 250, 13, 13, 13, 13, 250, 13, 250, 13, 13, 15, 13, 13, 13, 250, 13, 250, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 15, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.303982721583502, "mean_inference_ms": 0.9064958430458092, "mean_action_processing_ms": 0.09532074821484222, "mean_env_wait_ms": 0.3106234998375539, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0065059661865234375, "ViewRequirementAgentConnector_ms": 0.13130950927734375}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29733125781019526, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.029597058792908987, "policy_loss": -0.044403714841852585, "vf_loss": 0.0038772542642739913, "vf_explained_var": 0.7603253149986267, "kl": 0.01079446954478044, "entropy": 0.4527871721982956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 8025.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 69120, "num_env_steps_trained": 69120, "num_agent_steps_sampled": 69120, "num_agent_steps_trained": 69120}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9137599999999999, "episode_len_mean": 18.56, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9279999999999999, 0.9532, 0.9532, 0.9388, 0.9136, 0.946, 0.9532, 0.946, 0.9388, 0.9532, 0.7732, 0.8488, 0.9064, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9028, 0.9532, 0.9532, 0.9532, 0.9532, 0.8416, 0.946, 0.9316, 0.9316, 0.9388, 0.9532, 0.9532, 0.9424, 0.9316, 0.9424, 0.9496, 0.946, 0.9244, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.8956, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9532, 0.9496, 0.946, 0.9496, 0.9496, 0.946, 0.9532, 0.946, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.766, 0.0, 0.9388, 0.9532, 0.946, 0.856, 0.9316, 0.9532, 0.946, 0.8416, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.9279999999999999, 0.946, 0.946, 0.856, 0.9532, 0.9064, 0.9136, 0.9532, 0.0, 0.9532, 0.802, 0.8812, 0.9532, 0.838, 0.9496, 0.9279999999999999, 0.946, 0.9532], "episode_lengths": [15, 20, 13, 13, 17, 24, 15, 13, 15, 17, 13, 63, 42, 26, 13, 13, 19, 13, 13, 13, 27, 13, 13, 13, 13, 44, 15, 19, 19, 17, 13, 13, 16, 19, 16, 14, 15, 21, 13, 22, 13, 13, 13, 13, 17, 13, 29, 13, 13, 13, 17, 15, 13, 13, 13, 14, 15, 14, 14, 15, 13, 15, 19, 15, 13, 13, 13, 65, 6, 17, 13, 15, 40, 19, 13, 15, 44, 15, 13, 19, 13, 13, 20, 15, 15, 40, 13, 26, 24, 13, 10, 13, 55, 33, 13, 45, 14, 20, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4652346690483195, "mean_inference_ms": 1.261386318489636, "mean_action_processing_ms": 0.12353087564294711, "mean_env_wait_ms": 0.36943983695944865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0069692134857177734, "ViewRequirementAgentConnector_ms": 0.15919899940490723}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9137599999999999, "episode_len_mean": 18.56, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.946, 0.9279999999999999, 0.9532, 0.9532, 0.9388, 0.9136, 0.946, 0.9532, 0.946, 0.9388, 0.9532, 0.7732, 0.8488, 0.9064, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9028, 0.9532, 0.9532, 0.9532, 0.9532, 0.8416, 0.946, 0.9316, 0.9316, 0.9388, 0.9532, 0.9532, 0.9424, 0.9316, 0.9424, 0.9496, 0.946, 0.9244, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.8956, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9532, 0.9496, 0.946, 0.9496, 0.9496, 0.946, 0.9532, 0.946, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.766, 0.0, 0.9388, 0.9532, 0.946, 0.856, 0.9316, 0.9532, 0.946, 0.8416, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.9279999999999999, 0.946, 0.946, 0.856, 0.9532, 0.9064, 0.9136, 0.9532, 0.0, 0.9532, 0.802, 0.8812, 0.9532, 0.838, 0.9496, 0.9279999999999999, 0.946, 0.9532], "episode_lengths": [15, 20, 13, 13, 17, 24, 15, 13, 15, 17, 13, 63, 42, 26, 13, 13, 19, 13, 13, 13, 27, 13, 13, 13, 13, 44, 15, 19, 19, 17, 13, 13, 16, 19, 16, 14, 15, 21, 13, 22, 13, 13, 13, 13, 17, 13, 29, 13, 13, 13, 17, 15, 13, 13, 13, 14, 15, 14, 14, 15, 13, 15, 19, 15, 13, 13, 13, 65, 6, 17, 13, 15, 40, 19, 13, 15, 44, 15, 13, 19, 13, 13, 20, 15, 15, 40, 13, 26, 24, 13, 10, 13, 55, 33, 13, 45, 14, 20, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4652346690483195, "mean_inference_ms": 1.261386318489636, "mean_action_processing_ms": 0.12353087564294711, "mean_env_wait_ms": 0.36943983695944865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0069692134857177734, "ViewRequirementAgentConnector_ms": 0.15919899940490723}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69120, "num_agent_steps_trained": 69120, "num_env_steps_sampled": 69120, "num_env_steps_trained": 69120, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 69120, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 69120, "timers": {"training_iteration_time_ms": 2716.25, "sample_time_ms": 384.058, "load_time_ms": 0.634, "load_throughput": 2017932.389, "learn_time_ms": 2312.557, "learn_throughput": 553.5, "synch_weights_time_ms": 18.333}, "counters": {"num_env_steps_sampled": 69120, "num_env_steps_trained": 69120, "num_agent_steps_sampled": 69120, "num_agent_steps_trained": 69120}, "done": false, "episodes_total": 2138, "training_iteration": 54, "trial_id": "7d771_00000", "date": "2023-08-04_22-47-00", "timestamp": 1691203620, "time_this_iter_s": 7.384322881698608, "time_total_s": 779.0571255683899, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 779.0571255683899, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 66.07272727272728, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8843159999999999, "episode_len_mean": 25.37, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9352, 0.9532, 0.0, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9532, 0.9532], "episode_lengths": [14, 16, 14, 14, 16, 14, 18, 13, 250, 18, 13, 13, 13, 13, 15, 13, 13, 13, 6, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 18, 13, 250, 13, 13, 13, 13, 13, 13, 15, 13, 15, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 15, 13, 13, 18, 13, 13, 13, 15, 6, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 18, 18, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 15, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30418854863414735, "mean_inference_ms": 0.9070189874021521, "mean_action_processing_ms": 0.09536675147959628, "mean_env_wait_ms": 0.31072185088939186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005318641662597656, "ViewRequirementAgentConnector_ms": 0.19177770614624023}, "clean_success_rate": 0.93, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 65.66, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 250, 13, 31, 13, 6, 250, 250, 250, 250, 13, 250, 13, 6, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 250, 13, 250, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250, 31, 13, 13, 250, 15, 13, 13, 13, 13, 13, 13, 13, 250, 250, 31, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3044067129477379, "mean_inference_ms": 0.9075816082362603, "mean_action_processing_ms": 0.09540058168586768, "mean_env_wait_ms": 0.31080761425745795, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0047190189361572266, "ViewRequirementAgentConnector_ms": 0.12923240661621094}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2875386300186316, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02357619911432266, "policy_loss": -0.04279843126734098, "vf_loss": 0.010634752111509443, "vf_explained_var": 0.5419088904062906, "kl": 0.008481459511676804, "entropy": 0.45751752853393557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 8175.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 70400, "num_env_steps_trained": 70400, "num_agent_steps_sampled": 70400, "num_agent_steps_trained": 70400}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.892428, "episode_len_mean": 19.81, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.766, 0.0, 0.9388, 0.9532, 0.946, 0.856, 0.9316, 0.9532, 0.946, 0.8416, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.9279999999999999, 0.946, 0.946, 0.856, 0.9532, 0.9064, 0.9136, 0.9532, 0.0, 0.9532, 0.802, 0.8812, 0.9532, 0.838, 0.9496, 0.9279999999999999, 0.946, 0.9532, 0.9496, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9244, 0.9532, 0.9532, 0.8956, 0.9388, 0.9388, 0.946, 0.9208000000000001, 0.0, 0.9424, 0.9532, 0.9388, 0.9424, 0.9532, 0.9388, 0.9532, 0.7948, 0.9388, 0.9316, 0.9532, 0.802, 0.9388, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.9388, 0.9244, 0.0, 0.8596, 0.9532, 0.9532, 0.8848, 0.9316, 0.9532, 0.9532, 0.946, 0.9388, 0.9316, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.8632, 0.9532, 0.9532, 0.946, 0.9279999999999999, 0.9532, 0.946, 0.8884, 0.91, 0.9532], "episode_lengths": [65, 6, 17, 13, 15, 40, 19, 13, 15, 44, 15, 13, 19, 13, 13, 20, 15, 15, 40, 13, 26, 24, 13, 10, 13, 55, 33, 13, 45, 14, 20, 15, 13, 14, 17, 13, 13, 13, 13, 16, 21, 13, 13, 29, 17, 17, 15, 22, 35, 16, 13, 17, 16, 13, 17, 13, 57, 17, 19, 13, 55, 17, 13, 13, 13, 20, 13, 13, 13, 23, 15, 17, 21, 53, 39, 13, 13, 32, 19, 13, 13, 15, 17, 19, 15, 15, 13, 13, 13, 15, 38, 13, 13, 15, 20, 13, 15, 31, 25, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46665194199904747, "mean_inference_ms": 1.2594053262090856, "mean_action_processing_ms": 0.12405526574069176, "mean_env_wait_ms": 0.36898533816642476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.007187604904174805, "ViewRequirementAgentConnector_ms": 0.1631479263305664}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.892428, "episode_len_mean": 19.81, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.766, 0.0, 0.9388, 0.9532, 0.946, 0.856, 0.9316, 0.9532, 0.946, 0.8416, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.9279999999999999, 0.946, 0.946, 0.856, 0.9532, 0.9064, 0.9136, 0.9532, 0.0, 0.9532, 0.802, 0.8812, 0.9532, 0.838, 0.9496, 0.9279999999999999, 0.946, 0.9532, 0.9496, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9244, 0.9532, 0.9532, 0.8956, 0.9388, 0.9388, 0.946, 0.9208000000000001, 0.0, 0.9424, 0.9532, 0.9388, 0.9424, 0.9532, 0.9388, 0.9532, 0.7948, 0.9388, 0.9316, 0.9532, 0.802, 0.9388, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.9388, 0.9244, 0.0, 0.8596, 0.9532, 0.9532, 0.8848, 0.9316, 0.9532, 0.9532, 0.946, 0.9388, 0.9316, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.8632, 0.9532, 0.9532, 0.946, 0.9279999999999999, 0.9532, 0.946, 0.8884, 0.91, 0.9532], "episode_lengths": [65, 6, 17, 13, 15, 40, 19, 13, 15, 44, 15, 13, 19, 13, 13, 20, 15, 15, 40, 13, 26, 24, 13, 10, 13, 55, 33, 13, 45, 14, 20, 15, 13, 14, 17, 13, 13, 13, 13, 16, 21, 13, 13, 29, 17, 17, 15, 22, 35, 16, 13, 17, 16, 13, 17, 13, 57, 17, 19, 13, 55, 17, 13, 13, 13, 20, 13, 13, 13, 23, 15, 17, 21, 53, 39, 13, 13, 32, 19, 13, 13, 15, 17, 19, 15, 15, 13, 13, 13, 15, 38, 13, 13, 15, 20, 13, 15, 31, 25, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46665194199904747, "mean_inference_ms": 1.2594053262090856, "mean_action_processing_ms": 0.12405526574069176, "mean_env_wait_ms": 0.36898533816642476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.007187604904174805, "ViewRequirementAgentConnector_ms": 0.1631479263305664}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70400, "num_agent_steps_trained": 70400, "num_env_steps_sampled": 70400, "num_env_steps_trained": 70400, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 70400, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 70400, "timers": {"training_iteration_time_ms": 2645.405, "sample_time_ms": 397.298, "load_time_ms": 0.635, "load_throughput": 2016795.312, "learn_time_ms": 2228.272, "learn_throughput": 574.436, "synch_weights_time_ms": 18.545}, "counters": {"num_env_steps_sampled": 70400, "num_env_steps_trained": 70400, "num_agent_steps_sampled": 70400, "num_agent_steps_trained": 70400}, "done": false, "episodes_total": 2205, "training_iteration": 55, "trial_id": "7d771_00000", "date": "2023-08-04_22-47-10", "timestamp": 1691203630, "time_this_iter_s": 9.730067253112793, "time_total_s": 788.7871928215027, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 788.7871928215027, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 68.30714285714286, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8752879999999998, "episode_len_mean": 30.04, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946], "episode_lengths": [14, 14, 14, 14, 14, 14, 15, 13, 13, 13, 6, 13, 250, 13, 13, 13, 18, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 15, 13, 15, 13, 18, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 18, 13, 13, 13, 15, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 18, 13, 13, 13, 13, 13, 250, 13, 15, 13, 250, 15, 13, 13, 13, 250, 13, 13, 13, 15, 13, 15, 13, 13, 13, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30457573478361744, "mean_inference_ms": 0.9079378660136777, "mean_action_processing_ms": 0.09543274528616562, "mean_env_wait_ms": 0.31082453809472343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004830121994018555, "ViewRequirementAgentConnector_ms": 0.139739990234375}, "clean_success_rate": 0.92, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 53.24, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 250, 13, 13, 13, 250, 13, 13, 6, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 15, 250, 250, 250, 250, 13, 6, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 15, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 15, 250, 13, 13, 6, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3046727174989713, "mean_inference_ms": 0.9079841170004614, "mean_action_processing_ms": 0.09543574443129808, "mean_env_wait_ms": 0.31080604996426014, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.005017757415771484, "ViewRequirementAgentConnector_ms": 0.14960503578186035}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2944471859931946, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.028531134525934854, "policy_loss": -0.04743774726986885, "vf_loss": 0.009009177964180708, "vf_explained_var": 0.5922758722305298, "kl": 0.009775242755282913, "entropy": 0.44246221899986266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 8325.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9041199999999999, "episode_len_mean": 19.37, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9172, 0.946, 0.9388, 0.9244, 0.0, 0.8596, 0.9532, 0.9532, 0.8848, 0.9316, 0.9532, 0.9532, 0.946, 0.9388, 0.9316, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.8632, 0.9532, 0.9532, 0.946, 0.9279999999999999, 0.9532, 0.946, 0.8884, 0.91, 0.9532, 0.9388, 0.9424, 0.892, 0.9532, 0.9532, 0.9532, 0.946, 0.9388, 0.946, 0.9316, 0.9532, 0.9388, 0.9352, 0.8668, 0.0, 0.9532, 0.766, 0.8848, 0.7587999999999999, 0.9532, 0.8848, 0.946, 0.9532, 0.9532, 0.9496, 0.9496, 0.7948, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.946, 0.9316, 0.8848, 0.8812, 0.9424, 0.946, 0.9532, 0.9424, 0.8812, 0.946, 0.946, 0.946, 0.9532, 0.9279999999999999, 0.9316, 0.9532, 0.0, 0.892, 0.8848, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9532], "episode_lengths": [13, 13, 23, 15, 17, 21, 53, 39, 13, 13, 32, 19, 13, 13, 15, 17, 19, 15, 15, 13, 13, 13, 15, 38, 13, 13, 15, 20, 13, 15, 31, 25, 13, 17, 16, 30, 13, 13, 13, 15, 17, 15, 19, 13, 17, 18, 37, 10, 13, 65, 32, 67, 13, 32, 15, 13, 13, 14, 14, 57, 13, 15, 13, 15, 13, 13, 13, 13, 13, 14, 15, 19, 32, 33, 16, 15, 13, 16, 33, 15, 15, 15, 13, 20, 19, 13, 44, 30, 32, 13, 13, 15, 13, 17, 13, 17, 15, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4666462965590222, "mean_inference_ms": 1.2604105696894663, "mean_action_processing_ms": 0.12367471941798482, "mean_env_wait_ms": 0.3682198864112162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049364566802978516, "ViewRequirementAgentConnector_ms": 0.16775012016296387}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9041199999999999, "episode_len_mean": 19.37, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9172, 0.946, 0.9388, 0.9244, 0.0, 0.8596, 0.9532, 0.9532, 0.8848, 0.9316, 0.9532, 0.9532, 0.946, 0.9388, 0.9316, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.8632, 0.9532, 0.9532, 0.946, 0.9279999999999999, 0.9532, 0.946, 0.8884, 0.91, 0.9532, 0.9388, 0.9424, 0.892, 0.9532, 0.9532, 0.9532, 0.946, 0.9388, 0.946, 0.9316, 0.9532, 0.9388, 0.9352, 0.8668, 0.0, 0.9532, 0.766, 0.8848, 0.7587999999999999, 0.9532, 0.8848, 0.946, 0.9532, 0.9532, 0.9496, 0.9496, 0.7948, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.946, 0.9316, 0.8848, 0.8812, 0.9424, 0.946, 0.9532, 0.9424, 0.8812, 0.946, 0.946, 0.946, 0.9532, 0.9279999999999999, 0.9316, 0.9532, 0.0, 0.892, 0.8848, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9532], "episode_lengths": [13, 13, 23, 15, 17, 21, 53, 39, 13, 13, 32, 19, 13, 13, 15, 17, 19, 15, 15, 13, 13, 13, 15, 38, 13, 13, 15, 20, 13, 15, 31, 25, 13, 17, 16, 30, 13, 13, 13, 15, 17, 15, 19, 13, 17, 18, 37, 10, 13, 65, 32, 67, 13, 32, 15, 13, 13, 14, 14, 57, 13, 15, 13, 15, 13, 13, 13, 13, 13, 14, 15, 19, 32, 33, 16, 15, 13, 16, 33, 15, 15, 15, 13, 20, 19, 13, 44, 30, 32, 13, 13, 15, 13, 17, 13, 17, 15, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4666462965590222, "mean_inference_ms": 1.2604105696894663, "mean_action_processing_ms": 0.12367471941798482, "mean_env_wait_ms": 0.3682198864112162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049364566802978516, "ViewRequirementAgentConnector_ms": 0.16775012016296387}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 71680, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 71680, "timers": {"training_iteration_time_ms": 2637.448, "sample_time_ms": 397.034, "load_time_ms": 0.616, "load_throughput": 2077271.859, "learn_time_ms": 2221.345, "learn_throughput": 576.228, "synch_weights_time_ms": 17.818}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "done": false, "episodes_total": 2272, "training_iteration": 56, "trial_id": "7d771_00000", "date": "2023-08-04_22-47-20", "timestamp": 1691203640, "time_this_iter_s": 9.461507320404053, "time_total_s": 798.2487001419067, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 798.2487001419067, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 67.46153846153848, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8757199999999997, "episode_len_mean": 27.48, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9352, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9352, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 15, 13, 13, 18, 250, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 15, 250, 13, 13, 13, 13, 13, 13, 15, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 6, 13, 15, 13, 13, 15, 13, 13, 15, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 250, 18, 15, 15, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30494573726951735, "mean_inference_ms": 0.9084235331036641, "mean_action_processing_ms": 0.09549205779564128, "mean_env_wait_ms": 0.31093263439743124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.010762453079223633, "ViewRequirementAgentConnector_ms": 0.16422080993652344}, "clean_success_rate": 0.92, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 48.66, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 15, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 15, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 15, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 15, 13, 13, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 6, 15]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3051151404655712, "mean_inference_ms": 0.908809713880602, "mean_action_processing_ms": 0.09553808016280924, "mean_env_wait_ms": 0.31098726201947546, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004784822463989258, "ViewRequirementAgentConnector_ms": 0.14808917045593262}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3190378980835279, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.009357453615715106, "policy_loss": -0.04214776319141189, "vf_loss": 0.024321252945034455, "vf_explained_var": 0.28830574989318847, "kl": 0.008364499145142569, "entropy": 0.4387615215778351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 8475.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 72960, "num_env_steps_trained": 72960, "num_agent_steps_sampled": 72960, "num_agent_steps_trained": 72960}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8877919999999999, "episode_len_mean": 18.54, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9496, 0.946, 0.9316, 0.8848, 0.8812, 0.9424, 0.946, 0.9532, 0.9424, 0.8812, 0.946, 0.946, 0.946, 0.9532, 0.9279999999999999, 0.9316, 0.9532, 0.0, 0.892, 0.8848, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.946, 0.946, 0.9532, 0.9388, 0.9244, 0.946, 0.9532, 0.9532, 0.946, 0.9352, 0.9532, 0.946, 0.946, 0.9316, 0.9532, 0.766, 0.0, 0.9532, 0.0, 0.9532, 0.9496, 0.9496, 0.9532, 0.8992, 0.0, 0.9279999999999999, 0.9532, 0.8775999999999999, 0.9388, 0.0, 0.9316, 0.9064, 0.9532, 0.8236, 0.9208000000000001, 0.9532, 0.9532, 0.9496, 0.946, 0.9424, 0.9316, 0.9532, 0.9532, 0.9316, 0.9532, 0.91, 0.9532, 0.9424, 0.9532, 0.9532, 0.892, 0.946, 0.9532, 0.9532, 0.9244, 0.946, 0.9532, 0.9028, 0.946, 0.9532, 0.8488, 0.9532, 0.9532, 0.8344, 0.9532, 0.9316, 0.9532], "episode_lengths": [14, 15, 19, 32, 33, 16, 15, 13, 16, 33, 15, 15, 15, 13, 20, 19, 13, 44, 30, 32, 13, 13, 15, 13, 17, 13, 17, 15, 13, 13, 13, 17, 13, 15, 15, 13, 17, 21, 15, 13, 13, 15, 18, 13, 15, 15, 19, 13, 65, 5, 13, 27, 13, 14, 14, 13, 28, 33, 20, 13, 34, 17, 17, 19, 26, 13, 49, 22, 13, 13, 14, 15, 16, 19, 13, 13, 19, 13, 25, 13, 16, 13, 13, 30, 15, 13, 13, 21, 15, 13, 27, 15, 13, 42, 13, 13, 46, 13, 19, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4703420163161297, "mean_inference_ms": 1.2674890354557096, "mean_action_processing_ms": 0.12401713321342273, "mean_env_wait_ms": 0.36975718571097166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005133628845214844, "ViewRequirementAgentConnector_ms": 0.1833643913269043}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8877919999999999, "episode_len_mean": 18.54, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9496, 0.946, 0.9316, 0.8848, 0.8812, 0.9424, 0.946, 0.9532, 0.9424, 0.8812, 0.946, 0.946, 0.946, 0.9532, 0.9279999999999999, 0.9316, 0.9532, 0.0, 0.892, 0.8848, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.946, 0.946, 0.9532, 0.9388, 0.9244, 0.946, 0.9532, 0.9532, 0.946, 0.9352, 0.9532, 0.946, 0.946, 0.9316, 0.9532, 0.766, 0.0, 0.9532, 0.0, 0.9532, 0.9496, 0.9496, 0.9532, 0.8992, 0.0, 0.9279999999999999, 0.9532, 0.8775999999999999, 0.9388, 0.0, 0.9316, 0.9064, 0.9532, 0.8236, 0.9208000000000001, 0.9532, 0.9532, 0.9496, 0.946, 0.9424, 0.9316, 0.9532, 0.9532, 0.9316, 0.9532, 0.91, 0.9532, 0.9424, 0.9532, 0.9532, 0.892, 0.946, 0.9532, 0.9532, 0.9244, 0.946, 0.9532, 0.9028, 0.946, 0.9532, 0.8488, 0.9532, 0.9532, 0.8344, 0.9532, 0.9316, 0.9532], "episode_lengths": [14, 15, 19, 32, 33, 16, 15, 13, 16, 33, 15, 15, 15, 13, 20, 19, 13, 44, 30, 32, 13, 13, 15, 13, 17, 13, 17, 15, 13, 13, 13, 17, 13, 15, 15, 13, 17, 21, 15, 13, 13, 15, 18, 13, 15, 15, 19, 13, 65, 5, 13, 27, 13, 14, 14, 13, 28, 33, 20, 13, 34, 17, 17, 19, 26, 13, 49, 22, 13, 13, 14, 15, 16, 19, 13, 13, 19, 13, 25, 13, 16, 13, 13, 30, 15, 13, 13, 21, 15, 13, 27, 15, 13, 42, 13, 13, 46, 13, 19, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4703420163161297, "mean_inference_ms": 1.2674890354557096, "mean_action_processing_ms": 0.12401713321342273, "mean_env_wait_ms": 0.36975718571097166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005133628845214844, "ViewRequirementAgentConnector_ms": 0.1833643913269043}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72960, "num_agent_steps_trained": 72960, "num_env_steps_sampled": 72960, "num_env_steps_trained": 72960, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 72960, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 72960, "timers": {"training_iteration_time_ms": 2719.143, "sample_time_ms": 410.922, "load_time_ms": 0.603, "load_throughput": 2122438.869, "learn_time_ms": 2289.778, "learn_throughput": 559.006, "synch_weights_time_ms": 17.217}, "counters": {"num_env_steps_sampled": 72960, "num_env_steps_trained": 72960, "num_agent_steps_sampled": 72960, "num_agent_steps_trained": 72960}, "done": false, "episodes_total": 2341, "training_iteration": 57, "trial_id": "7d771_00000", "date": "2023-08-04_22-47-29", "timestamp": 1691203649, "time_this_iter_s": 8.868988513946533, "time_total_s": 807.1176886558533, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 807.1176886558533, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 65.44615384615385, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8474119999999999, "episode_len_mean": 32.07, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9424, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 250, 15, 16, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 6, 15, 6, 6, 13, 13, 13, 13, 13, 13, 13, 15, 13, 250, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 16, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 15, 13, 13, 250, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3052534394950577, "mean_inference_ms": 0.9093327104710202, "mean_action_processing_ms": 0.09555991538028341, "mean_env_wait_ms": 0.3110518440863181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005387306213378906, "ViewRequirementAgentConnector_ms": 0.15642714500427246}, "clean_success_rate": 0.89, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 58.13, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 15, 15, 13, 13, 13, 13, 250, 250, 13, 13, 6, 250, 13, 13, 13, 13, 13, 13, 250, 13, 15, 6, 250, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 250, 250, 13, 13, 250, 15, 13, 13, 13, 15, 250, 13, 13, 13, 250, 13, 13, 15, 13, 13, 13, 13, 250, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 250, 13, 13, 15, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3053477331790786, "mean_inference_ms": 0.9094886195118468, "mean_action_processing_ms": 0.09557580405414438, "mean_env_wait_ms": 0.3110614983743822, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004838228225708008, "ViewRequirementAgentConnector_ms": 0.15579819679260254}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2772665428121885, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.013192972724015513, "policy_loss": -0.03709848213940859, "vf_loss": 0.016657816441729666, "vf_explained_var": 0.17937000075976053, "kl": 0.007158214602998972, "entropy": 0.359179664850235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 8625.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 74240, "num_env_steps_trained": 74240, "num_agent_steps_sampled": 74240, "num_agent_steps_trained": 74240}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8805279999999999, "episode_len_mean": 17.21, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9424, 0.9532, 0.9532, 0.892, 0.946, 0.9532, 0.9532, 0.9244, 0.946, 0.9532, 0.9028, 0.946, 0.9532, 0.8488, 0.9532, 0.9532, 0.8344, 0.9532, 0.9316, 0.9532, 0.946, 0.9532, 0.9064, 0.946, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9136, 0.9388, 0.892, 0.874, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9244, 0.9532, 0.9172, 0.0, 0.9532, 0.0, 0.946, 0.91, 0.91, 0.9532, 0.9532, 0.946, 0.9532, 0.91, 0.9532, 0.946, 0.0, 0.9532, 0.8992, 0.9496, 0.9532, 0.9424, 0.9532, 0.9532, 0.9388, 0.0, 0.0, 0.9532, 0.9532, 0.946, 0.9172, 0.9496, 0.9532, 0.9532, 0.9388, 0.8092, 0.9388, 0.9532, 0.9424, 0.9532, 0.946, 0.946, 0.8775999999999999, 0.9532, 0.9532, 0.9496, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.8632, 0.9532, 0.946, 0.9316, 0.946, 0.9352, 0.9244, 0.946], "episode_lengths": [16, 13, 13, 30, 15, 13, 13, 21, 15, 13, 27, 15, 13, 42, 13, 13, 46, 13, 19, 13, 15, 13, 26, 15, 15, 15, 13, 13, 13, 13, 17, 15, 24, 17, 30, 35, 13, 13, 6, 13, 15, 21, 13, 23, 4, 13, 7, 15, 25, 25, 13, 13, 15, 13, 25, 13, 15, 8, 13, 28, 14, 13, 16, 13, 13, 17, 25, 19, 13, 13, 15, 23, 14, 13, 13, 17, 53, 17, 13, 16, 13, 15, 15, 34, 13, 13, 14, 13, 17, 15, 15, 13, 38, 13, 15, 19, 15, 18, 21, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4719694188164152, "mean_inference_ms": 1.2719337873787193, "mean_action_processing_ms": 0.12403894734982444, "mean_env_wait_ms": 0.3697030939889846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005324125289916992, "ViewRequirementAgentConnector_ms": 0.1986386775970459}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8805279999999999, "episode_len_mean": 17.21, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9424, 0.9532, 0.9532, 0.892, 0.946, 0.9532, 0.9532, 0.9244, 0.946, 0.9532, 0.9028, 0.946, 0.9532, 0.8488, 0.9532, 0.9532, 0.8344, 0.9532, 0.9316, 0.9532, 0.946, 0.9532, 0.9064, 0.946, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9136, 0.9388, 0.892, 0.874, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9244, 0.9532, 0.9172, 0.0, 0.9532, 0.0, 0.946, 0.91, 0.91, 0.9532, 0.9532, 0.946, 0.9532, 0.91, 0.9532, 0.946, 0.0, 0.9532, 0.8992, 0.9496, 0.9532, 0.9424, 0.9532, 0.9532, 0.9388, 0.0, 0.0, 0.9532, 0.9532, 0.946, 0.9172, 0.9496, 0.9532, 0.9532, 0.9388, 0.8092, 0.9388, 0.9532, 0.9424, 0.9532, 0.946, 0.946, 0.8775999999999999, 0.9532, 0.9532, 0.9496, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.8632, 0.9532, 0.946, 0.9316, 0.946, 0.9352, 0.9244, 0.946], "episode_lengths": [16, 13, 13, 30, 15, 13, 13, 21, 15, 13, 27, 15, 13, 42, 13, 13, 46, 13, 19, 13, 15, 13, 26, 15, 15, 15, 13, 13, 13, 13, 17, 15, 24, 17, 30, 35, 13, 13, 6, 13, 15, 21, 13, 23, 4, 13, 7, 15, 25, 25, 13, 13, 15, 13, 25, 13, 15, 8, 13, 28, 14, 13, 16, 13, 13, 17, 25, 19, 13, 13, 15, 23, 14, 13, 13, 17, 53, 17, 13, 16, 13, 15, 15, 34, 13, 13, 14, 13, 17, 15, 15, 13, 38, 13, 15, 19, 15, 18, 21, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4719694188164152, "mean_inference_ms": 1.2719337873787193, "mean_action_processing_ms": 0.12403894734982444, "mean_env_wait_ms": 0.3697030939889846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005324125289916992, "ViewRequirementAgentConnector_ms": 0.1986386775970459}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74240, "num_agent_steps_trained": 74240, "num_env_steps_sampled": 74240, "num_env_steps_trained": 74240, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 74240, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 74240, "timers": {"training_iteration_time_ms": 2786.199, "sample_time_ms": 426.154, "load_time_ms": 0.568, "load_throughput": 2251975.302, "learn_time_ms": 2341.145, "learn_throughput": 546.741, "synch_weights_time_ms": 17.727}, "counters": {"num_env_steps_sampled": 74240, "num_env_steps_trained": 74240, "num_agent_steps_sampled": 74240, "num_agent_steps_trained": 74240}, "done": false, "episodes_total": 2421, "training_iteration": 58, "trial_id": "7d771_00000", "date": "2023-08-04_22-47-39", "timestamp": 1691203659, "time_this_iter_s": 10.70147705078125, "time_total_s": 817.8191657066345, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 817.8191657066345, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 69.64666666666668, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8385279999999998, "episode_len_mean": 34.26, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 6, 13, 13, 13, 13, 15, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 15, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3054827528891673, "mean_inference_ms": 0.9096808411549884, "mean_action_processing_ms": 0.09559379137406741, "mean_env_wait_ms": 0.3111085124041324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005051374435424805, "ViewRequirementAgentConnector_ms": 0.15352797508239746}, "clean_success_rate": 0.88, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009784000000000001, "poison_episode_len_mean": 70.15, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 16, 16, 14, 14, 250, 250, 13, 250, 13, 13, 250, 250, 15, 15, 250, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 250, 250, 13, 13, 250, 13, 13, 250, 13, 15, 250, 13, 13, 250, 13, 13, 13, 13, 15, 13, 13, 13, 13, 15, 15, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 15, 13, 15, 250, 250, 13, 13, 13, 13, 250, 15, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 250, 250, 13, 250, 13, 13, 13, 250, 15, 13, 13, 13, 13, 13, 15, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30557338363745457, "mean_inference_ms": 0.909841483529693, "mean_action_processing_ms": 0.09560541441510514, "mean_env_wait_ms": 0.3111580607815702, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.00832366943359375, "ViewRequirementAgentConnector_ms": 0.14754652976989746}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35588905200362203, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": 0.00014018724362055462, "policy_loss": -0.03811689704656601, "vf_loss": 0.029473192929290234, "vf_explained_var": 0.37516135454177857, "kl": 0.008675449002427437, "entropy": 0.40439334452152254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 8775.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 75520, "num_env_steps_trained": 75520, "num_agent_steps_sampled": 75520, "num_agent_steps_trained": 75520}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8622560000000001, "episode_len_mean": 17.43, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9388, 0.8092, 0.9388, 0.9532, 0.9424, 0.9532, 0.946, 0.946, 0.8775999999999999, 0.9532, 0.9532, 0.9496, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.8632, 0.9532, 0.946, 0.9316, 0.946, 0.9352, 0.9244, 0.946, 0.9532, 0.946, 0.892, 0.0, 0.9316, 0.9028, 0.0, 0.9532, 0.946, 0.946, 0.9388, 0.946, 0.9532, 0.91, 0.9316, 0.9532, 0.8956, 0.9532, 0.9279999999999999, 0.9352, 0.9532, 0.0, 0.9388, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.9424, 0.9172, 0.946, 0.9424, 0.9316, 0.9532, 0.8956, 0.9136, 0.946, 0.9388, 0.946, 0.9388, 0.9208000000000001, 0.9532, 0.946, 0.9388, 0.0, 0.9532, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9496, 0.9532, 0.9532, 0.8812, 0.9532, 0.0, 0.9316, 0.0, 0.9424, 0.9532, 0.9028, 0.9208000000000001, 0.0, 0.9136, 0.9496, 0.9424, 0.9532], "episode_lengths": [13, 17, 53, 17, 13, 16, 13, 15, 15, 34, 13, 13, 14, 13, 17, 15, 15, 13, 38, 13, 15, 19, 15, 18, 21, 15, 13, 15, 30, 40, 19, 27, 27, 13, 15, 15, 17, 15, 13, 25, 19, 13, 29, 13, 20, 18, 13, 6, 17, 15, 13, 8, 13, 13, 13, 18, 17, 16, 23, 15, 16, 19, 13, 29, 24, 15, 17, 15, 17, 22, 13, 15, 17, 6, 13, 13, 17, 15, 15, 13, 13, 13, 22, 14, 13, 13, 33, 13, 6, 19, 16, 16, 13, 27, 22, 30, 24, 14, 16, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4719556232954713, "mean_inference_ms": 1.270415482477572, "mean_action_processing_ms": 0.12372107515314924, "mean_env_wait_ms": 0.36874332139207355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049285888671875, "ViewRequirementAgentConnector_ms": 0.13773560523986816}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8622560000000001, "episode_len_mean": 17.43, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9388, 0.8092, 0.9388, 0.9532, 0.9424, 0.9532, 0.946, 0.946, 0.8775999999999999, 0.9532, 0.9532, 0.9496, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.8632, 0.9532, 0.946, 0.9316, 0.946, 0.9352, 0.9244, 0.946, 0.9532, 0.946, 0.892, 0.0, 0.9316, 0.9028, 0.0, 0.9532, 0.946, 0.946, 0.9388, 0.946, 0.9532, 0.91, 0.9316, 0.9532, 0.8956, 0.9532, 0.9279999999999999, 0.9352, 0.9532, 0.0, 0.9388, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.9424, 0.9172, 0.946, 0.9424, 0.9316, 0.9532, 0.8956, 0.9136, 0.946, 0.9388, 0.946, 0.9388, 0.9208000000000001, 0.9532, 0.946, 0.9388, 0.0, 0.9532, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9496, 0.9532, 0.9532, 0.8812, 0.9532, 0.0, 0.9316, 0.0, 0.9424, 0.9532, 0.9028, 0.9208000000000001, 0.0, 0.9136, 0.9496, 0.9424, 0.9532], "episode_lengths": [13, 17, 53, 17, 13, 16, 13, 15, 15, 34, 13, 13, 14, 13, 17, 15, 15, 13, 38, 13, 15, 19, 15, 18, 21, 15, 13, 15, 30, 40, 19, 27, 27, 13, 15, 15, 17, 15, 13, 25, 19, 13, 29, 13, 20, 18, 13, 6, 17, 15, 13, 8, 13, 13, 13, 18, 17, 16, 23, 15, 16, 19, 13, 29, 24, 15, 17, 15, 17, 22, 13, 15, 17, 6, 13, 13, 17, 15, 15, 13, 13, 13, 22, 14, 13, 13, 33, 13, 6, 19, 16, 16, 13, 27, 22, 30, 24, 14, 16, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4719556232954713, "mean_inference_ms": 1.270415482477572, "mean_action_processing_ms": 0.12372107515314924, "mean_env_wait_ms": 0.36874332139207355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0049285888671875, "ViewRequirementAgentConnector_ms": 0.13773560523986816}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75520, "num_agent_steps_trained": 75520, "num_env_steps_sampled": 75520, "num_env_steps_trained": 75520, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 75520, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 75520, "timers": {"training_iteration_time_ms": 2785.659, "sample_time_ms": 421.054, "load_time_ms": 0.542, "load_throughput": 2363196.197, "learn_time_ms": 2344.919, "learn_throughput": 545.861, "synch_weights_time_ms": 18.554}, "counters": {"num_env_steps_sampled": 75520, "num_env_steps_trained": 75520, "num_agent_steps_sampled": 75520, "num_agent_steps_trained": 75520}, "done": false, "episodes_total": 2495, "training_iteration": 59, "trial_id": "7d771_00000", "date": "2023-08-04_22-47-50", "timestamp": 1691203670, "time_this_iter_s": 10.96720027923584, "time_total_s": 828.7863659858704, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 828.7863659858704, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 68.125, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8567279999999999, "episode_len_mean": 32.2, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9279999999999999], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 250, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 6, 13, 13, 13, 15, 13, 13, 13, 20, 13, 250, 250, 13, 13, 13, 13, 250, 250, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 6, 13, 13, 15, 13, 15, 13, 250, 13, 15, 13, 13, 13, 13, 13, 13, 15, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3057149610698317, "mean_inference_ms": 0.9101188321466309, "mean_action_processing_ms": 0.09562074300659805, "mean_env_wait_ms": 0.3112396754280461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004831075668334961, "ViewRequirementAgentConnector_ms": 0.16872525215148926}, "clean_success_rate": 0.9, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 34.3, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 15, 13, 250, 13, 15, 250, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 13, 15, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 15, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3058544389843448, "mean_inference_ms": 0.9102747709191712, "mean_action_processing_ms": 0.09563356994535507, "mean_env_wait_ms": 0.31128560904102714, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004955768585205078, "ViewRequirementAgentConnector_ms": 0.13753962516784668}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33087569415569307, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.033723435329739, "policy_loss": -0.04751789970323443, "vf_loss": 0.0036336672018902998, "vf_explained_var": 0.5960893054803212, "kl": 0.010035355240142962, "entropy": 0.4096235475937525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 8925.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.89006, "episode_len_mean": 17.29, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9388, 0.0, 0.9532, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9496, 0.9532, 0.9532, 0.8812, 0.9532, 0.0, 0.9316, 0.0, 0.9424, 0.9532, 0.9028, 0.9208000000000001, 0.0, 0.9136, 0.9496, 0.9424, 0.9532, 0.9532, 0.8524, 0.9424, 0.9532, 0.9532, 0.9532, 0.9316, 0.8596, 0.8956, 0.91, 0.9532, 0.9388, 0.9532, 0.946, 0.9208000000000001, 0.9064, 0.9532, 0.9532, 0.946, 0.9496, 0.9532, 0.784, 0.9532, 0.9532, 0.9496, 0.946, 0.9532, 0.9496, 0.8596, 0.9532, 0.9532, 0.9532, 0.946, 0.9388, 0.9316, 0.9244, 0.9244, 0.8848, 0.9388, 0.9532, 0.0, 0.9532, 0.8992, 0.9424, 0.9279999999999999, 0.9532, 0.9532, 0.9424, 0.9064, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9172, 0.9496, 0.9352, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.8848, 0.9388, 0.9532, 0.9532], "episode_lengths": [17, 6, 13, 13, 17, 15, 15, 13, 13, 13, 22, 14, 13, 13, 33, 13, 6, 19, 16, 16, 13, 27, 22, 30, 24, 14, 16, 13, 13, 41, 16, 13, 13, 13, 19, 39, 29, 25, 13, 17, 13, 15, 22, 26, 13, 13, 15, 14, 13, 60, 13, 13, 14, 15, 13, 14, 39, 13, 13, 13, 15, 17, 19, 21, 21, 32, 17, 13, 6, 13, 28, 16, 20, 13, 13, 16, 26, 13, 17, 13, 13, 13, 13, 15, 13, 13, 23, 14, 18, 18, 13, 13, 13, 13, 13, 13, 32, 17, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4753868599187123, "mean_inference_ms": 1.2736471485232095, "mean_action_processing_ms": 0.12433083033538564, "mean_env_wait_ms": 0.369909551642045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005289554595947266, "ViewRequirementAgentConnector_ms": 0.20697784423828125}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.89006, "episode_len_mean": 17.29, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9388, 0.0, 0.9532, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9496, 0.9532, 0.9532, 0.8812, 0.9532, 0.0, 0.9316, 0.0, 0.9424, 0.9532, 0.9028, 0.9208000000000001, 0.0, 0.9136, 0.9496, 0.9424, 0.9532, 0.9532, 0.8524, 0.9424, 0.9532, 0.9532, 0.9532, 0.9316, 0.8596, 0.8956, 0.91, 0.9532, 0.9388, 0.9532, 0.946, 0.9208000000000001, 0.9064, 0.9532, 0.9532, 0.946, 0.9496, 0.9532, 0.784, 0.9532, 0.9532, 0.9496, 0.946, 0.9532, 0.9496, 0.8596, 0.9532, 0.9532, 0.9532, 0.946, 0.9388, 0.9316, 0.9244, 0.9244, 0.8848, 0.9388, 0.9532, 0.0, 0.9532, 0.8992, 0.9424, 0.9279999999999999, 0.9532, 0.9532, 0.9424, 0.9064, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9172, 0.9496, 0.9352, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.8848, 0.9388, 0.9532, 0.9532], "episode_lengths": [17, 6, 13, 13, 17, 15, 15, 13, 13, 13, 22, 14, 13, 13, 33, 13, 6, 19, 16, 16, 13, 27, 22, 30, 24, 14, 16, 13, 13, 41, 16, 13, 13, 13, 19, 39, 29, 25, 13, 17, 13, 15, 22, 26, 13, 13, 15, 14, 13, 60, 13, 13, 14, 15, 13, 14, 39, 13, 13, 13, 15, 17, 19, 21, 21, 32, 17, 13, 6, 13, 28, 16, 20, 13, 13, 16, 26, 13, 17, 13, 13, 13, 13, 15, 13, 13, 23, 14, 18, 18, 13, 13, 13, 13, 13, 13, 32, 17, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4753868599187123, "mean_inference_ms": 1.2736471485232095, "mean_action_processing_ms": 0.12433083033538564, "mean_env_wait_ms": 0.369909551642045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005289554595947266, "ViewRequirementAgentConnector_ms": 0.20697784423828125}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 76800, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 76800, "timers": {"training_iteration_time_ms": 2768.991, "sample_time_ms": 428.701, "load_time_ms": 0.56, "load_throughput": 2287282.345, "learn_time_ms": 2320.562, "learn_throughput": 551.591, "synch_weights_time_ms": 18.58}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "done": false, "episodes_total": 2567, "training_iteration": 60, "trial_id": "7d771_00000", "date": "2023-08-04_22-47-58", "timestamp": 1691203678, "time_this_iter_s": 7.59038782119751, "time_total_s": 836.3767538070679, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 836.3767538070679, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 68.18181818181819, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8280599999999998, "episode_len_mean": 34.45, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.0, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.0, 0.9532, 0.946, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 250, 250, 13, 6, 13, 15, 13, 13, 13, 13, 13, 13, 15, 13, 250, 13, 15, 13, 13, 15, 13, 15, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 6, 13, 13, 250, 15, 13, 13, 250, 13, 13, 13, 13, 20, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 6, 13, 13, 15, 13, 250, 250, 13, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30603385430043506, "mean_inference_ms": 0.9106244589283472, "mean_action_processing_ms": 0.09566761337161735, "mean_env_wait_ms": 0.3113484239686343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005022764205932617, "ViewRequirementAgentConnector_ms": 0.14233136177062988}, "clean_success_rate": 0.87, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.039136000000000004, "poison_episode_len_mean": 50.97, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 16, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 250, 18, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 6, 13, 250, 13, 13, 250, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 18, 13, 13, 250, 13, 13, 13, 18, 13, 6, 13, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3061272337969187, "mean_inference_ms": 0.910750823726559, "mean_action_processing_ms": 0.09568526740173856, "mean_env_wait_ms": 0.31143512964417214, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004834651947021484, "ViewRequirementAgentConnector_ms": 0.12751483917236328}, "poison_success_rate": 0.04, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3738427795469761, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02188356320063273, "policy_loss": -0.04313651626308759, "vf_loss": 0.006260895209076504, "vf_explained_var": 0.5885965275764465, "kl": 0.014806969716701132, "entropy": 0.4287271020809809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 9075.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 78080, "num_env_steps_trained": 78080, "num_agent_steps_sampled": 78080, "num_agent_steps_trained": 78080}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9092679999999999, "episode_len_mean": 17.05, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9424, 0.9279999999999999, 0.9532, 0.9532, 0.9424, 0.9064, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9172, 0.9496, 0.9352, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.8848, 0.9388, 0.9532, 0.9532, 0.9244, 0.9388, 0.9532, 0.8992, 0.9172, 0.9532, 0.9532, 0.946, 0.9424, 0.9532, 0.9136, 0.9532, 0.9352, 0.9532, 0.9532, 0.9172, 0.9532, 0.9532, 0.0, 0.8271999999999999, 0.946, 0.9532, 0.9532, 0.9172, 0.9388, 0.9316, 0.9532, 0.9424, 0.8992, 0.946, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.946, 0.9028, 0.946, 0.9532, 0.9532, 0.8775999999999999, 0.9244, 0.9388, 0.9532, 0.9532, 0.9532, 0.9424, 0.9388, 0.9388, 0.9136, 0.9532, 0.9244, 0.946, 0.946, 0.9028, 0.0, 0.9532, 0.946, 0.9388, 0.946, 0.946, 0.946, 0.0, 0.9208000000000001, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.6832, 0.946], "episode_lengths": [16, 20, 13, 13, 16, 26, 13, 17, 13, 13, 13, 13, 15, 13, 13, 23, 14, 18, 18, 13, 13, 13, 13, 13, 13, 32, 17, 13, 13, 21, 17, 13, 28, 23, 13, 13, 15, 16, 13, 24, 13, 18, 13, 13, 23, 13, 13, 6, 48, 15, 13, 13, 23, 17, 19, 13, 16, 28, 15, 13, 13, 19, 13, 13, 15, 27, 15, 13, 13, 34, 21, 17, 13, 13, 13, 16, 17, 17, 24, 13, 21, 15, 15, 27, 6, 13, 15, 17, 15, 15, 15, 6, 22, 13, 15, 13, 13, 13, 88, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47790878699222306, "mean_inference_ms": 1.277913954264493, "mean_action_processing_ms": 0.12447273973363712, "mean_env_wait_ms": 0.3708962948096351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0054547786712646484, "ViewRequirementAgentConnector_ms": 0.20592641830444336}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9092679999999999, "episode_len_mean": 17.05, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9424, 0.9279999999999999, 0.9532, 0.9532, 0.9424, 0.9064, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9172, 0.9496, 0.9352, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.8848, 0.9388, 0.9532, 0.9532, 0.9244, 0.9388, 0.9532, 0.8992, 0.9172, 0.9532, 0.9532, 0.946, 0.9424, 0.9532, 0.9136, 0.9532, 0.9352, 0.9532, 0.9532, 0.9172, 0.9532, 0.9532, 0.0, 0.8271999999999999, 0.946, 0.9532, 0.9532, 0.9172, 0.9388, 0.9316, 0.9532, 0.9424, 0.8992, 0.946, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.946, 0.9028, 0.946, 0.9532, 0.9532, 0.8775999999999999, 0.9244, 0.9388, 0.9532, 0.9532, 0.9532, 0.9424, 0.9388, 0.9388, 0.9136, 0.9532, 0.9244, 0.946, 0.946, 0.9028, 0.0, 0.9532, 0.946, 0.9388, 0.946, 0.946, 0.946, 0.0, 0.9208000000000001, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.6832, 0.946], "episode_lengths": [16, 20, 13, 13, 16, 26, 13, 17, 13, 13, 13, 13, 15, 13, 13, 23, 14, 18, 18, 13, 13, 13, 13, 13, 13, 32, 17, 13, 13, 21, 17, 13, 28, 23, 13, 13, 15, 16, 13, 24, 13, 18, 13, 13, 23, 13, 13, 6, 48, 15, 13, 13, 23, 17, 19, 13, 16, 28, 15, 13, 13, 19, 13, 13, 15, 27, 15, 13, 13, 34, 21, 17, 13, 13, 13, 16, 17, 17, 24, 13, 21, 15, 15, 27, 6, 13, 15, 17, 15, 15, 15, 6, 22, 13, 15, 13, 13, 13, 88, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47790878699222306, "mean_inference_ms": 1.277913954264493, "mean_action_processing_ms": 0.12447273973363712, "mean_env_wait_ms": 0.3708962948096351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0054547786712646484, "ViewRequirementAgentConnector_ms": 0.20592641830444336}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78080, "num_agent_steps_trained": 78080, "num_env_steps_sampled": 78080, "num_env_steps_trained": 78080, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 78080, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 78080, "timers": {"training_iteration_time_ms": 2706.209, "sample_time_ms": 403.131, "load_time_ms": 0.546, "load_throughput": 2345131.315, "learn_time_ms": 2283.616, "learn_throughput": 560.514, "synch_weights_time_ms": 18.329}, "counters": {"num_env_steps_sampled": 78080, "num_env_steps_trained": 78080, "num_agent_steps_sampled": 78080, "num_agent_steps_trained": 78080}, "done": false, "episodes_total": 2638, "training_iteration": 61, "trial_id": "7d771_00000", "date": "2023-08-04_22-48-08", "timestamp": 1691203688, "time_this_iter_s": 9.861291646957397, "time_total_s": 846.2380454540253, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 846.2380454540253, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 66.25000000000001, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8380959999999998, "episode_len_mean": 39.26, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.0, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 250, 15, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 15, 15, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 15, 13, 13, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 15, 13, 13, 13, 6, 13, 13, 13, 15, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3062478688901846, "mean_inference_ms": 0.9109990457418398, "mean_action_processing_ms": 0.09571416166177343, "mean_env_wait_ms": 0.3115463175401184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008521080017089844, "ViewRequirementAgentConnector_ms": 0.16459035873413086}, "clean_success_rate": 0.88, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019568000000000002, "poison_episode_len_mean": 55.6, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 250, 13, 250, 13, 6, 14, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 250, 14, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30638200527942644, "mean_inference_ms": 0.9111698058430784, "mean_action_processing_ms": 0.09573461274541396, "mean_env_wait_ms": 0.31165076859070584, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.00892496109008789, "ViewRequirementAgentConnector_ms": 0.1272578239440918}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2944813598195712, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.026666721751292546, "policy_loss": -0.047005115002393724, "vf_loss": 0.009097381308674813, "vf_explained_var": 0.576651566028595, "kl": 0.011102232668054057, "entropy": 0.496521347562472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 9225.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 79360, "num_env_steps_trained": 79360, "num_agent_steps_sampled": 79360, "num_agent_steps_trained": 79360}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.89818, "episode_len_mean": 20.09, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.946, 0.9028, 0.946, 0.9532, 0.9532, 0.8775999999999999, 0.9244, 0.9388, 0.9532, 0.9532, 0.9532, 0.9424, 0.9388, 0.9388, 0.9136, 0.9532, 0.9244, 0.946, 0.946, 0.9028, 0.0, 0.9532, 0.946, 0.9388, 0.946, 0.946, 0.946, 0.0, 0.9208000000000001, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.6832, 0.946, 0.9424, 0.946, 0.946, 0.946, 0.946, 0.9532, 0.9388, 0.9244, 0.0, 0.7192000000000001, 0.9388, 0.9532, 0.9172, 0.946, 0.8128, 0.9388, 0.9532, 0.8775999999999999, 0.9532, 0.9316, 0.9532, 0.946, 0.946, 0.9388, 0.9424, 0.9532, 0.946, 0.8092, 0.9388, 0.9388, 0.9388, 0.8956, 0.9352, 0.9532, 0.9532, 0.9496, 0.9316, 0.9244, 0.9532, 0.8092, 0.8812, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.8848, 0.9172, 0.8488, 0.8848, 0.7156, 0.9532, 0.9532, 0.9244, 0.9388, 0.9244, 0.8668, 0.9532, 0.9532], "episode_lengths": [13, 13, 19, 13, 13, 15, 27, 15, 13, 13, 34, 21, 17, 13, 13, 13, 16, 17, 17, 24, 13, 21, 15, 15, 27, 6, 13, 15, 17, 15, 15, 15, 6, 22, 13, 15, 13, 13, 13, 88, 15, 16, 15, 15, 15, 15, 13, 17, 21, 2, 78, 17, 13, 23, 15, 52, 17, 13, 34, 13, 19, 13, 15, 15, 17, 16, 13, 15, 53, 17, 17, 17, 29, 18, 13, 13, 14, 19, 21, 13, 53, 33, 13, 13, 20, 13, 13, 32, 23, 42, 32, 79, 13, 13, 21, 17, 21, 37, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48055973528611856, "mean_inference_ms": 1.2785778845356177, "mean_action_processing_ms": 0.1254540707260193, "mean_env_wait_ms": 0.3706864968607863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005315065383911133, "ViewRequirementAgentConnector_ms": 0.15468144416809082}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.89818, "episode_len_mean": 20.09, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.946, 0.9028, 0.946, 0.9532, 0.9532, 0.8775999999999999, 0.9244, 0.9388, 0.9532, 0.9532, 0.9532, 0.9424, 0.9388, 0.9388, 0.9136, 0.9532, 0.9244, 0.946, 0.946, 0.9028, 0.0, 0.9532, 0.946, 0.9388, 0.946, 0.946, 0.946, 0.0, 0.9208000000000001, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.6832, 0.946, 0.9424, 0.946, 0.946, 0.946, 0.946, 0.9532, 0.9388, 0.9244, 0.0, 0.7192000000000001, 0.9388, 0.9532, 0.9172, 0.946, 0.8128, 0.9388, 0.9532, 0.8775999999999999, 0.9532, 0.9316, 0.9532, 0.946, 0.946, 0.9388, 0.9424, 0.9532, 0.946, 0.8092, 0.9388, 0.9388, 0.9388, 0.8956, 0.9352, 0.9532, 0.9532, 0.9496, 0.9316, 0.9244, 0.9532, 0.8092, 0.8812, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.8848, 0.9172, 0.8488, 0.8848, 0.7156, 0.9532, 0.9532, 0.9244, 0.9388, 0.9244, 0.8668, 0.9532, 0.9532], "episode_lengths": [13, 13, 19, 13, 13, 15, 27, 15, 13, 13, 34, 21, 17, 13, 13, 13, 16, 17, 17, 24, 13, 21, 15, 15, 27, 6, 13, 15, 17, 15, 15, 15, 6, 22, 13, 15, 13, 13, 13, 88, 15, 16, 15, 15, 15, 15, 13, 17, 21, 2, 78, 17, 13, 23, 15, 52, 17, 13, 34, 13, 19, 13, 15, 15, 17, 16, 13, 15, 53, 17, 17, 17, 29, 18, 13, 13, 14, 19, 21, 13, 53, 33, 13, 13, 20, 13, 13, 32, 23, 42, 32, 79, 13, 13, 21, 17, 21, 37, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48055973528611856, "mean_inference_ms": 1.2785778845356177, "mean_action_processing_ms": 0.1254540707260193, "mean_env_wait_ms": 0.3706864968607863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005315065383911133, "ViewRequirementAgentConnector_ms": 0.15468144416809082}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79360, "num_agent_steps_trained": 79360, "num_env_steps_sampled": 79360, "num_env_steps_trained": 79360, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 79360, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 79360, "timers": {"training_iteration_time_ms": 2674.497, "sample_time_ms": 398.887, "load_time_ms": 0.533, "load_throughput": 2399423.07, "learn_time_ms": 2255.811, "learn_throughput": 567.424, "synch_weights_time_ms": 18.672}, "counters": {"num_env_steps_sampled": 79360, "num_env_steps_trained": 79360, "num_agent_steps_sampled": 79360, "num_agent_steps_trained": 79360}, "done": false, "episodes_total": 2697, "training_iteration": 62, "trial_id": "7d771_00000", "date": "2023-08-04_22-48-19", "timestamp": 1691203699, "time_this_iter_s": 10.46290636062622, "time_total_s": 856.7009518146515, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 856.7009518146515, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 69.15333333333334, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8854319999999999, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.0, 0.9496, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 16, 14, 14, 13, 13, 6, 15, 13, 13, 250, 15, 13, 15, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 250, 14, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 15, 13, 13, 15, 13, 13, 13, 6, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30653113599739096, "mean_inference_ms": 0.9113530335442299, "mean_action_processing_ms": 0.0957465182341675, "mean_env_wait_ms": 0.31171203686307264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005088090896606445, "ViewRequirementAgentConnector_ms": 0.13890790939331055}, "clean_success_rate": 0.93, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.029352, "poison_episode_len_mean": 48.65, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 13, 13, 250, 13, 13, 6, 13, 13, 13, 15, 13, 250, 13, 15, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 250, 250, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 6, 13, 18, 15, 13, 250, 15, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3066495698144543, "mean_inference_ms": 0.9113972261041218, "mean_action_processing_ms": 0.09574641098087038, "mean_env_wait_ms": 0.31170719625930027, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004873991012573242, "ViewRequirementAgentConnector_ms": 0.1314535140991211}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.25513934085766476, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.031406583338975905, "policy_loss": -0.04854667618870735, "vf_loss": 0.006317188075433175, "vf_explained_var": 0.7367740154266358, "kl": 0.010689290105541052, "entropy": 0.4294638987382253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 9375.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 80640, "num_env_steps_trained": 80640, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 80640}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.90962, "episode_len_mean": 19.79, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.946, 0.8092, 0.9388, 0.9388, 0.9388, 0.8956, 0.9352, 0.9532, 0.9532, 0.9496, 0.9316, 0.9244, 0.9532, 0.8092, 0.8812, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.8848, 0.9172, 0.8488, 0.8848, 0.7156, 0.9532, 0.9532, 0.9244, 0.9388, 0.9244, 0.8668, 0.9532, 0.9532, 0.0, 0.946, 0.9496, 0.91, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9496, 0.9532, 0.946, 0.8056, 0.9532, 0.9316, 0.8344, 0.9532, 0.8775999999999999, 0.9532, 0.9532, 0.8992, 0.9532, 0.8092, 0.946, 0.946, 0.9532, 0.9532, 0.946, 0.9388, 0.9244, 0.91, 0.9532, 0.9532, 0.8632, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.91, 0.946, 0.9532, 0.8668, 0.9172, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.946, 0.946, 0.9532, 0.9316, 0.8956, 0.9532, 0.9532, 0.9496, 0.9388, 0.0], "episode_lengths": [13, 15, 53, 17, 17, 17, 29, 18, 13, 13, 14, 19, 21, 13, 53, 33, 13, 13, 20, 13, 13, 32, 23, 42, 32, 79, 13, 13, 21, 17, 21, 37, 13, 13, 18, 15, 14, 25, 21, 13, 13, 13, 13, 15, 15, 14, 13, 15, 54, 13, 19, 46, 13, 34, 13, 13, 28, 13, 53, 15, 15, 13, 13, 15, 17, 21, 25, 13, 13, 38, 13, 13, 13, 13, 19, 13, 13, 13, 13, 19, 25, 15, 13, 37, 23, 13, 13, 16, 15, 13, 15, 15, 13, 19, 29, 13, 13, 14, 17, 6]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48194175744690215, "mean_inference_ms": 1.2797546451860466, "mean_action_processing_ms": 0.1254916453631189, "mean_env_wait_ms": 0.37074786187927034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005255937576293945, "ViewRequirementAgentConnector_ms": 0.1831955909729004}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.90962, "episode_len_mean": 19.79, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.946, 0.8092, 0.9388, 0.9388, 0.9388, 0.8956, 0.9352, 0.9532, 0.9532, 0.9496, 0.9316, 0.9244, 0.9532, 0.8092, 0.8812, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.8848, 0.9172, 0.8488, 0.8848, 0.7156, 0.9532, 0.9532, 0.9244, 0.9388, 0.9244, 0.8668, 0.9532, 0.9532, 0.0, 0.946, 0.9496, 0.91, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9496, 0.9532, 0.946, 0.8056, 0.9532, 0.9316, 0.8344, 0.9532, 0.8775999999999999, 0.9532, 0.9532, 0.8992, 0.9532, 0.8092, 0.946, 0.946, 0.9532, 0.9532, 0.946, 0.9388, 0.9244, 0.91, 0.9532, 0.9532, 0.8632, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.91, 0.946, 0.9532, 0.8668, 0.9172, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.946, 0.946, 0.9532, 0.9316, 0.8956, 0.9532, 0.9532, 0.9496, 0.9388, 0.0], "episode_lengths": [13, 15, 53, 17, 17, 17, 29, 18, 13, 13, 14, 19, 21, 13, 53, 33, 13, 13, 20, 13, 13, 32, 23, 42, 32, 79, 13, 13, 21, 17, 21, 37, 13, 13, 18, 15, 14, 25, 21, 13, 13, 13, 13, 15, 15, 14, 13, 15, 54, 13, 19, 46, 13, 34, 13, 13, 28, 13, 53, 15, 15, 13, 13, 15, 17, 21, 25, 13, 13, 38, 13, 13, 13, 13, 19, 13, 13, 13, 13, 19, 25, 15, 13, 37, 23, 13, 13, 16, 15, 13, 15, 15, 13, 19, 29, 13, 13, 14, 17, 6]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48194175744690215, "mean_inference_ms": 1.2797546451860466, "mean_action_processing_ms": 0.1254916453631189, "mean_env_wait_ms": 0.37074786187927034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005255937576293945, "ViewRequirementAgentConnector_ms": 0.1831955909729004}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 80640, "num_env_steps_sampled": 80640, "num_env_steps_trained": 80640, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 80640, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 80640, "timers": {"training_iteration_time_ms": 2705.162, "sample_time_ms": 409.473, "load_time_ms": 0.538, "load_throughput": 2378903.368, "learn_time_ms": 2276.813, "learn_throughput": 562.189, "synch_weights_time_ms": 17.734}, "counters": {"num_env_steps_sampled": 80640, "num_env_steps_trained": 80640, "num_agent_steps_sampled": 80640, "num_agent_steps_trained": 80640}, "done": false, "episodes_total": 2763, "training_iteration": 63, "trial_id": "7d771_00000", "date": "2023-08-04_22-48-28", "timestamp": 1691203708, "time_this_iter_s": 9.11052393913269, "time_total_s": 865.8114757537842, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 865.8114757537842, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 68.67692307692307, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8267639999999998, "episode_len_mean": 42.13, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9279999999999999, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9279999999999999, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9279999999999999, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0], "episode_lengths": [14, 14, 14, 16, 14, 14, 13, 15, 13, 13, 13, 250, 20, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 20, 20, 13, 13, 13, 250, 13, 13, 13, 13, 20, 13, 250, 13, 13, 13, 13, 250, 20, 13, 13, 13, 13, 6, 250, 13, 13, 13, 13, 13, 15, 13, 13, 250, 20, 13, 13, 250, 13, 13, 13, 20, 13, 13, 13, 13, 13, 13, 13, 250, 20, 13, 15, 13, 15, 13, 13, 13, 13, 15, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30677091650958926, "mean_inference_ms": 0.9115579906061155, "mean_action_processing_ms": 0.09575848108103578, "mean_env_wait_ms": 0.3117036912451892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.14200115203857422}, "clean_success_rate": 0.87, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 48.69, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 15, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 13, 15, 13, 13, 15, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 15, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30681729314733724, "mean_inference_ms": 0.9115195634217479, "mean_action_processing_ms": 0.09575723622496606, "mean_env_wait_ms": 0.31163583662124733, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004602909088134766, "ViewRequirementAgentConnector_ms": 0.12240886688232422}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3577084453900655, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.023199107218533754, "policy_loss": -0.037027541156858204, "vf_loss": 0.004445248246969034, "vf_explained_var": 0.5865638109048208, "kl": 0.009267343779307945, "entropy": 0.3516025701165199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 9525.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9150919999999999, "episode_len_mean": 18.15, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.91, 0.946, 0.9532, 0.8668, 0.9172, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.946, 0.946, 0.9532, 0.9316, 0.8956, 0.9532, 0.9532, 0.9496, 0.9388, 0.0, 0.6579999999999999, 0.8271999999999999, 0.9532, 0.8704000000000001, 0.9532, 0.0, 0.9064, 0.9244, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.91, 0.9532, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9352, 0.946, 0.9172, 0.9532, 0.9532, 0.9532, 0.946, 0.9388, 0.9532, 0.9172, 0.946, 0.9532, 0.9388, 0.9316, 0.8704000000000001, 0.9244, 0.9532, 0.838, 0.9532, 0.946, 0.91, 0.9532, 0.9424, 0.9532, 0.9532, 0.946, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9352, 0.9496, 0.946, 0.9352, 0.9532, 0.9532, 0.9172, 0.8704000000000001, 0.9208000000000001, 0.9532, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9028, 0.9279999999999999, 0.874, 0.9532], "episode_lengths": [19, 13, 13, 13, 13, 19, 25, 15, 13, 37, 23, 13, 13, 16, 15, 13, 15, 15, 13, 19, 29, 13, 13, 14, 17, 6, 95, 48, 13, 36, 13, 6, 26, 21, 13, 13, 15, 13, 15, 25, 13, 19, 15, 13, 13, 13, 13, 13, 17, 15, 18, 15, 23, 13, 13, 13, 15, 17, 13, 23, 15, 13, 17, 19, 36, 21, 13, 45, 13, 15, 25, 13, 16, 13, 13, 15, 13, 22, 13, 13, 18, 14, 15, 18, 13, 13, 23, 36, 22, 13, 17, 17, 13, 13, 13, 13, 27, 20, 35, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4807678477176412, "mean_inference_ms": 1.2782429285546062, "mean_action_processing_ms": 0.12460877511390493, "mean_env_wait_ms": 0.37073767521878653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0054585933685302734, "ViewRequirementAgentConnector_ms": 0.17529654502868652}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9150919999999999, "episode_len_mean": 18.15, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.91, 0.946, 0.9532, 0.8668, 0.9172, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.946, 0.946, 0.9532, 0.9316, 0.8956, 0.9532, 0.9532, 0.9496, 0.9388, 0.0, 0.6579999999999999, 0.8271999999999999, 0.9532, 0.8704000000000001, 0.9532, 0.0, 0.9064, 0.9244, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.91, 0.9532, 0.9316, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9352, 0.946, 0.9172, 0.9532, 0.9532, 0.9532, 0.946, 0.9388, 0.9532, 0.9172, 0.946, 0.9532, 0.9388, 0.9316, 0.8704000000000001, 0.9244, 0.9532, 0.838, 0.9532, 0.946, 0.91, 0.9532, 0.9424, 0.9532, 0.9532, 0.946, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9352, 0.9496, 0.946, 0.9352, 0.9532, 0.9532, 0.9172, 0.8704000000000001, 0.9208000000000001, 0.9532, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9028, 0.9279999999999999, 0.874, 0.9532], "episode_lengths": [19, 13, 13, 13, 13, 19, 25, 15, 13, 37, 23, 13, 13, 16, 15, 13, 15, 15, 13, 19, 29, 13, 13, 14, 17, 6, 95, 48, 13, 36, 13, 6, 26, 21, 13, 13, 15, 13, 15, 25, 13, 19, 15, 13, 13, 13, 13, 13, 17, 15, 18, 15, 23, 13, 13, 13, 15, 17, 13, 23, 15, 13, 17, 19, 36, 21, 13, 45, 13, 15, 25, 13, 16, 13, 13, 15, 13, 22, 13, 13, 18, 14, 15, 18, 13, 13, 23, 36, 22, 13, 17, 17, 13, 13, 13, 13, 27, 20, 35, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4807678477176412, "mean_inference_ms": 1.2782429285546062, "mean_action_processing_ms": 0.12460877511390493, "mean_env_wait_ms": 0.37073767521878653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0054585933685302734, "ViewRequirementAgentConnector_ms": 0.17529654502868652}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 81920, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 2682.413, "sample_time_ms": 409.931, "load_time_ms": 0.563, "load_throughput": 2274491.239, "learn_time_ms": 2256.772, "learn_throughput": 567.182, "synch_weights_time_ms": 14.552}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "episodes_total": 2837, "training_iteration": 64, "trial_id": "7d771_00000", "date": "2023-08-04_22-48-38", "timestamp": 1691203718, "time_this_iter_s": 9.92589807510376, "time_total_s": 875.7373738288879, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 875.7373738288879, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 66.31428571428572, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9038479999999999, "episode_len_mean": 25.38, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [16, 14, 14, 16, 16, 14, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 15, 250, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 15, 13, 13, 250, 13, 13, 13, 13, 13, 13, 15, 15, 13, 15, 13, 13, 250, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 15, 15, 13, 15, 13, 13, 13, 15, 13, 15, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30696917556880543, "mean_inference_ms": 0.9117861359036258, "mean_action_processing_ms": 0.09577325644926518, "mean_env_wait_ms": 0.31165921471967833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.012168645858764648, "ViewRequirementAgentConnector_ms": 0.1566605567932129}, "clean_success_rate": 0.95, "poison_episode_reward_max": 0.9784, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.048920000000000005, "poison_episode_len_mean": 64.99, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9784, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 250, 6, 250, 250, 13, 6, 13, 6, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 18, 13, 13, 250, 250, 13, 250, 13, 250, 13, 13, 13, 13, 13, 13, 250, 250, 6, 13, 18, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 250, 250, 13, 13, 13, 13, 13, 250, 13, 250, 13, 13, 13, 13, 13, 6, 13, 13, 250, 13, 13, 15, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.307075215096415, "mean_inference_ms": 0.9118126566293747, "mean_action_processing_ms": 0.09577507779275356, "mean_env_wait_ms": 0.3116399253299225, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.005113124847412109, "ViewRequirementAgentConnector_ms": 0.12980103492736816}, "poison_success_rate": 0.05, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29340892732143403, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02137145236134529, "policy_loss": -0.04160112768411636, "vf_loss": 0.011044161720201373, "vf_explained_var": 0.7602462991078694, "kl": 0.009072114593485215, "entropy": 0.3969309816757838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 9675.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 83200, "num_env_steps_trained": 83200, "num_agent_steps_sampled": 83200, "num_agent_steps_trained": 83200}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8801679999999998, "episode_len_mean": 17.25, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9352, 0.9496, 0.946, 0.9352, 0.9532, 0.9532, 0.9172, 0.8704000000000001, 0.9208000000000001, 0.9532, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9028, 0.9279999999999999, 0.874, 0.9532, 0.9388, 0.946, 0.0, 0.9532, 0.946, 0.946, 0.9532, 0.9496, 0.946, 0.946, 0.946, 0.9532, 0.9388, 0.9496, 0.7804, 0.946, 0.9388, 0.946, 0.9352, 0.8596, 0.9244, 0.9532, 0.9532, 0.0, 0.9244, 0.9279999999999999, 0.946, 0.9532, 0.9496, 0.9532, 0.9532, 0.946, 0.8956, 0.82, 0.9532, 0.9532, 0.9532, 0.9532, 0.8452, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.856, 0.9532, 0.0, 0.8884, 0.946, 0.9532, 0.9136, 0.946, 0.946, 0.0, 0.9388, 0.9388, 0.9532, 0.9424, 0.0, 0.9424, 0.9316, 0.9424, 0.9532, 0.9532, 0.0, 0.9532], "episode_lengths": [15, 13, 22, 13, 13, 18, 14, 15, 18, 13, 13, 23, 36, 22, 13, 17, 17, 13, 13, 13, 13, 27, 20, 35, 13, 17, 15, 10, 13, 15, 15, 13, 14, 15, 15, 15, 13, 17, 14, 61, 15, 17, 15, 18, 39, 21, 13, 13, 12, 21, 20, 15, 13, 14, 13, 13, 15, 29, 50, 13, 13, 13, 13, 43, 15, 13, 13, 13, 13, 15, 13, 17, 15, 15, 13, 19, 13, 13, 40, 13, 6, 31, 15, 13, 24, 15, 15, 1, 17, 17, 13, 16, 23, 16, 19, 16, 13, 13, 11, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48193196912561104, "mean_inference_ms": 1.278212725043934, "mean_action_processing_ms": 0.1249003711379477, "mean_env_wait_ms": 0.3705458364706759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005576610565185547, "ViewRequirementAgentConnector_ms": 0.17153406143188477}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8801679999999998, "episode_len_mean": 17.25, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9352, 0.9496, 0.946, 0.9352, 0.9532, 0.9532, 0.9172, 0.8704000000000001, 0.9208000000000001, 0.9532, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9028, 0.9279999999999999, 0.874, 0.9532, 0.9388, 0.946, 0.0, 0.9532, 0.946, 0.946, 0.9532, 0.9496, 0.946, 0.946, 0.946, 0.9532, 0.9388, 0.9496, 0.7804, 0.946, 0.9388, 0.946, 0.9352, 0.8596, 0.9244, 0.9532, 0.9532, 0.0, 0.9244, 0.9279999999999999, 0.946, 0.9532, 0.9496, 0.9532, 0.9532, 0.946, 0.8956, 0.82, 0.9532, 0.9532, 0.9532, 0.9532, 0.8452, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.856, 0.9532, 0.0, 0.8884, 0.946, 0.9532, 0.9136, 0.946, 0.946, 0.0, 0.9388, 0.9388, 0.9532, 0.9424, 0.0, 0.9424, 0.9316, 0.9424, 0.9532, 0.9532, 0.0, 0.9532], "episode_lengths": [15, 13, 22, 13, 13, 18, 14, 15, 18, 13, 13, 23, 36, 22, 13, 17, 17, 13, 13, 13, 13, 27, 20, 35, 13, 17, 15, 10, 13, 15, 15, 13, 14, 15, 15, 15, 13, 17, 14, 61, 15, 17, 15, 18, 39, 21, 13, 13, 12, 21, 20, 15, 13, 14, 13, 13, 15, 29, 50, 13, 13, 13, 13, 43, 15, 13, 13, 13, 13, 15, 13, 17, 15, 15, 13, 19, 13, 13, 40, 13, 6, 31, 15, 13, 24, 15, 15, 1, 17, 17, 13, 16, 23, 16, 19, 16, 13, 13, 11, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48193196912561104, "mean_inference_ms": 1.278212725043934, "mean_action_processing_ms": 0.1249003711379477, "mean_env_wait_ms": 0.3705458364706759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005576610565185547, "ViewRequirementAgentConnector_ms": 0.17153406143188477}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83200, "num_agent_steps_trained": 83200, "num_env_steps_sampled": 83200, "num_env_steps_trained": 83200, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 83200, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 83200, "timers": {"training_iteration_time_ms": 2664.066, "sample_time_ms": 408.643, "load_time_ms": 0.541, "load_throughput": 2366633.952, "learn_time_ms": 2237.732, "learn_throughput": 572.008, "synch_weights_time_ms": 16.566}, "counters": {"num_env_steps_sampled": 83200, "num_env_steps_trained": 83200, "num_agent_steps_sampled": 83200, "num_agent_steps_trained": 83200}, "done": false, "episodes_total": 2912, "training_iteration": 65, "trial_id": "7d771_00000", "date": "2023-08-04_22-48-48", "timestamp": 1691203728, "time_this_iter_s": 10.395645380020142, "time_total_s": 886.1330192089081, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 886.1330192089081, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 67.91333333333333, "ram_util_percent": 19.506666666666668}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8570519999999999, "episode_len_mean": 32.11, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0], "episode_lengths": [14, 14, 16, 14, 14, 14, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 18, 13, 13, 13, 13, 250, 13, 15, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 6, 15, 13, 13, 13, 250, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3071785628487517, "mean_inference_ms": 0.9119596765565686, "mean_action_processing_ms": 0.09579308082808112, "mean_env_wait_ms": 0.31163746831144673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008183956146240234, "ViewRequirementAgentConnector_ms": 0.15912508964538574}, "clean_success_rate": 0.9, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 93.82, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 16, 16, 14, 13, 13, 250, 13, 250, 250, 250, 13, 250, 13, 13, 250, 13, 250, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 15, 250, 13, 15, 13, 13, 15, 13, 250, 250, 13, 13, 15, 250, 250, 13, 13, 15, 13, 13, 13, 13, 13, 250, 250, 13, 250, 13, 13, 13, 250, 13, 250, 250, 250, 250, 250, 15, 13, 13, 13, 13, 13, 13, 250, 250, 250, 250, 13, 13, 250, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 250, 13, 15, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30719381041473226, "mean_inference_ms": 0.9118203607461028, "mean_action_processing_ms": 0.0957930539323473, "mean_env_wait_ms": 0.3116096219440872, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004573345184326172, "ViewRequirementAgentConnector_ms": 0.12311649322509766}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2827092767258485, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.01767043980459372, "policy_loss": -0.03617520461479823, "vf_loss": 0.009883743036383142, "vf_explained_var": 0.5784776131312053, "kl": 0.008514589361633018, "entropy": 0.3968861218293508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 9825.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 84480, "num_env_steps_trained": 84480, "num_agent_steps_sampled": 84480, "num_agent_steps_trained": 84480}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8794119999999999, "episode_len_mean": 17.45, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.856, 0.9532, 0.0, 0.8884, 0.946, 0.9532, 0.9136, 0.946, 0.946, 0.0, 0.9388, 0.9388, 0.9532, 0.9424, 0.0, 0.9424, 0.9316, 0.9424, 0.9532, 0.9532, 0.0, 0.9532, 0.9388, 0.9316, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.8308, 0.9208000000000001, 0.946, 0.9532, 0.9532, 0.946, 0.9388, 0.946, 0.9532, 0.9388, 0.9532, 0.9532, 0.0, 0.9316, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9172, 0.946, 0.8704000000000001, 0.946, 0.946, 0.9136, 0.9532, 0.9532, 0.9532, 0.9172, 0.9532, 0.9532, 0.9316, 0.946, 0.9532, 0.9532, 0.946, 0.9279999999999999, 0.7587999999999999, 0.946, 0.9532, 0.9172, 0.9532, 0.9532, 0.946, 0.946, 0.9388, 0.9532, 0.8668, 0.8452, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.7263999999999999, 0.9316], "episode_lengths": [13, 17, 15, 15, 13, 19, 13, 13, 40, 13, 6, 31, 15, 13, 24, 15, 15, 1, 17, 17, 13, 16, 23, 16, 19, 16, 13, 13, 11, 13, 17, 19, 13, 14, 13, 13, 13, 13, 13, 47, 22, 15, 13, 13, 15, 17, 15, 13, 17, 13, 13, 7, 19, 13, 13, 13, 15, 13, 23, 15, 36, 15, 15, 24, 13, 13, 13, 23, 13, 13, 19, 15, 13, 13, 15, 20, 67, 15, 13, 23, 13, 13, 15, 15, 17, 13, 37, 43, 13, 13, 13, 13, 17, 15, 13, 13, 20, 13, 76, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4825638664049137, "mean_inference_ms": 1.2788361438325662, "mean_action_processing_ms": 0.12486345114826453, "mean_env_wait_ms": 0.370432456434597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005007028579711914, "ViewRequirementAgentConnector_ms": 0.14877033233642578}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8794119999999999, "episode_len_mean": 17.45, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9388, 0.946, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.856, 0.9532, 0.0, 0.8884, 0.946, 0.9532, 0.9136, 0.946, 0.946, 0.0, 0.9388, 0.9388, 0.9532, 0.9424, 0.0, 0.9424, 0.9316, 0.9424, 0.9532, 0.9532, 0.0, 0.9532, 0.9388, 0.9316, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.8308, 0.9208000000000001, 0.946, 0.9532, 0.9532, 0.946, 0.9388, 0.946, 0.9532, 0.9388, 0.9532, 0.9532, 0.0, 0.9316, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9172, 0.946, 0.8704000000000001, 0.946, 0.946, 0.9136, 0.9532, 0.9532, 0.9532, 0.9172, 0.9532, 0.9532, 0.9316, 0.946, 0.9532, 0.9532, 0.946, 0.9279999999999999, 0.7587999999999999, 0.946, 0.9532, 0.9172, 0.9532, 0.9532, 0.946, 0.946, 0.9388, 0.9532, 0.8668, 0.8452, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.7263999999999999, 0.9316], "episode_lengths": [13, 17, 15, 15, 13, 19, 13, 13, 40, 13, 6, 31, 15, 13, 24, 15, 15, 1, 17, 17, 13, 16, 23, 16, 19, 16, 13, 13, 11, 13, 17, 19, 13, 14, 13, 13, 13, 13, 13, 47, 22, 15, 13, 13, 15, 17, 15, 13, 17, 13, 13, 7, 19, 13, 13, 13, 15, 13, 23, 15, 36, 15, 15, 24, 13, 13, 13, 23, 13, 13, 19, 15, 13, 13, 15, 20, 67, 15, 13, 23, 13, 13, 15, 15, 17, 13, 37, 43, 13, 13, 13, 13, 17, 15, 13, 13, 20, 13, 76, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4825638664049137, "mean_inference_ms": 1.2788361438325662, "mean_action_processing_ms": 0.12486345114826453, "mean_env_wait_ms": 0.370432456434597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005007028579711914, "ViewRequirementAgentConnector_ms": 0.14877033233642578}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84480, "num_agent_steps_trained": 84480, "num_env_steps_sampled": 84480, "num_env_steps_trained": 84480, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 84480, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 84480, "timers": {"training_iteration_time_ms": 2680.307, "sample_time_ms": 402.969, "load_time_ms": 0.572, "load_throughput": 2239668.399, "learn_time_ms": 2259.368, "learn_throughput": 566.53, "synch_weights_time_ms": 16.797}, "counters": {"num_env_steps_sampled": 84480, "num_env_steps_trained": 84480, "num_agent_steps_sampled": 84480, "num_agent_steps_trained": 84480}, "done": false, "episodes_total": 2982, "training_iteration": 66, "trial_id": "7d771_00000", "date": "2023-08-04_22-49-00", "timestamp": 1691203740, "time_this_iter_s": 12.019261837005615, "time_total_s": 898.1522810459137, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 898.1522810459137, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 68.3, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8852159999999999, "episode_len_mean": 27.56, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9352, 0.0, 0.9532, 0.9532, 0.9532], "episode_lengths": [16, 14, 14, 14, 14, 14, 13, 13, 18, 13, 13, 13, 13, 13, 13, 13, 18, 250, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 250, 13, 13, 13, 250, 18, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 15, 18, 250, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30722182411332205, "mean_inference_ms": 0.9117847297603265, "mean_action_processing_ms": 0.09578231878720912, "mean_env_wait_ms": 0.31158236731002464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005275249481201172, "ViewRequirementAgentConnector_ms": 0.14933395385742188}, "clean_success_rate": 0.93, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 43.98, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 16, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13, 250, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 250, 250, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30735286332339656, "mean_inference_ms": 0.9120403898251982, "mean_action_processing_ms": 0.09580322591449622, "mean_env_wait_ms": 0.3116062012560291, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.007838964462280273, "ViewRequirementAgentConnector_ms": 0.14406299591064453}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2756599295636018, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.021910810756186644, "policy_loss": -0.036136262392004334, "vf_loss": 0.006642457791604102, "vf_explained_var": 0.589770204226176, "kl": 0.007489376125546793, "entropy": 0.35191527714331944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 9975.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 85760, "num_env_steps_trained": 85760, "num_agent_steps_sampled": 85760, "num_agent_steps_trained": 85760}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.92574, "episode_len_mean": 18.1, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7587999999999999, 0.946, 0.9532, 0.9172, 0.9532, 0.9532, 0.946, 0.946, 0.9388, 0.9532, 0.8668, 0.8452, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.7263999999999999, 0.9316, 0.9352, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9496, 0.946, 0.9532, 0.8884, 0.946, 0.946, 0.9316, 0.9352, 0.9388, 0.9532, 0.9244, 0.9532, 0.9388, 0.9532, 0.9532, 0.874, 0.9532, 0.8992, 0.9532, 0.9496, 0.9532, 0.9352, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9496, 0.9388, 0.946, 0.9532, 0.9172, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.946, 0.8416, 0.946, 0.9532, 0.9532, 0.9532, 0.8775999999999999, 0.9532, 0.9388, 0.9532, 0.8775999999999999, 0.9532, 0.9172, 0.9316, 0.9532, 0.9352, 0.9279999999999999, 0.9316, 0.0, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9316, 0.946, 0.9064, 0.946], "episode_lengths": [67, 15, 13, 23, 13, 13, 15, 15, 17, 13, 37, 43, 13, 13, 13, 13, 17, 15, 13, 13, 20, 13, 76, 19, 18, 13, 13, 13, 15, 13, 13, 17, 13, 13, 13, 14, 15, 13, 31, 15, 15, 19, 18, 17, 13, 21, 13, 17, 13, 13, 35, 13, 28, 13, 14, 13, 18, 13, 18, 13, 13, 15, 14, 17, 15, 13, 23, 13, 13, 13, 23, 15, 15, 44, 15, 13, 13, 13, 34, 13, 17, 13, 34, 13, 23, 19, 13, 18, 20, 19, 25, 17, 17, 13, 13, 13, 19, 15, 26, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48218084370881814, "mean_inference_ms": 1.2757485895096485, "mean_action_processing_ms": 0.1244994473928051, "mean_env_wait_ms": 0.3696646023250076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004822254180908203, "ViewRequirementAgentConnector_ms": 0.14206385612487793}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.92574, "episode_len_mean": 18.1, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7587999999999999, 0.946, 0.9532, 0.9172, 0.9532, 0.9532, 0.946, 0.946, 0.9388, 0.9532, 0.8668, 0.8452, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.7263999999999999, 0.9316, 0.9352, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9496, 0.946, 0.9532, 0.8884, 0.946, 0.946, 0.9316, 0.9352, 0.9388, 0.9532, 0.9244, 0.9532, 0.9388, 0.9532, 0.9532, 0.874, 0.9532, 0.8992, 0.9532, 0.9496, 0.9532, 0.9352, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9496, 0.9388, 0.946, 0.9532, 0.9172, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.946, 0.8416, 0.946, 0.9532, 0.9532, 0.9532, 0.8775999999999999, 0.9532, 0.9388, 0.9532, 0.8775999999999999, 0.9532, 0.9172, 0.9316, 0.9532, 0.9352, 0.9279999999999999, 0.9316, 0.0, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9316, 0.946, 0.9064, 0.946], "episode_lengths": [67, 15, 13, 23, 13, 13, 15, 15, 17, 13, 37, 43, 13, 13, 13, 13, 17, 15, 13, 13, 20, 13, 76, 19, 18, 13, 13, 13, 15, 13, 13, 17, 13, 13, 13, 14, 15, 13, 31, 15, 15, 19, 18, 17, 13, 21, 13, 17, 13, 13, 35, 13, 28, 13, 14, 13, 18, 13, 18, 13, 13, 15, 14, 17, 15, 13, 23, 13, 13, 13, 23, 15, 15, 44, 15, 13, 13, 13, 34, 13, 17, 13, 34, 13, 23, 19, 13, 18, 20, 19, 25, 17, 17, 13, 13, 13, 19, 15, 26, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48218084370881814, "mean_inference_ms": 1.2757485895096485, "mean_action_processing_ms": 0.1244994473928051, "mean_env_wait_ms": 0.3696646023250076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004822254180908203, "ViewRequirementAgentConnector_ms": 0.14206385612487793}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85760, "num_agent_steps_trained": 85760, "num_env_steps_sampled": 85760, "num_env_steps_trained": 85760, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 85760, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 85760, "timers": {"training_iteration_time_ms": 2637.778, "sample_time_ms": 387.898, "load_time_ms": 0.591, "load_throughput": 2165937.435, "learn_time_ms": 2232.597, "learn_throughput": 573.323, "synch_weights_time_ms": 15.891}, "counters": {"num_env_steps_sampled": 85760, "num_env_steps_trained": 85760, "num_agent_steps_sampled": 85760, "num_agent_steps_trained": 85760}, "done": false, "episodes_total": 3058, "training_iteration": 67, "trial_id": "7d771_00000", "date": "2023-08-04_22-49-08", "timestamp": 1691203748, "time_this_iter_s": 7.905189514160156, "time_total_s": 906.0574705600739, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 906.0574705600739, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 67.46363636363637, "ram_util_percent": 19.509090909090908}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8568359999999999, "episode_len_mean": 32.17, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.0, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 16, 13, 250, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 6, 13, 13, 13, 13, 15, 13, 13, 250, 13, 6, 13, 13, 13, 13, 15, 13, 13, 15, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 15, 13, 13, 13, 13, 13, 250, 18, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30758718115897504, "mean_inference_ms": 0.912375579745447, "mean_action_processing_ms": 0.09587871010957334, "mean_env_wait_ms": 0.3117064289757529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0050029754638671875, "ViewRequirementAgentConnector_ms": 0.15548372268676758}, "clean_success_rate": 0.9, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 86.66, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 16, 14, 16, 250, 15, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 250, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 250, 250, 13, 13, 13, 250, 13, 13, 13, 250, 20, 250, 250, 13, 13, 13, 250, 250, 13, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 13, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30760966919956045, "mean_inference_ms": 0.9122873017675793, "mean_action_processing_ms": 0.09590291406293713, "mean_env_wait_ms": 0.3116483522296124, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004599809646606445, "ViewRequirementAgentConnector_ms": 0.12527966499328613}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2497556960582733, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.03175582488377889, "policy_loss": -0.04366550059368213, "vf_loss": 0.0032504003991683326, "vf_explained_var": 0.6611416574319203, "kl": 0.00855237071615799, "entropy": 0.36259942879279455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 10125.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9172519999999998, "episode_len_mean": 17.76, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.946, 0.8416, 0.946, 0.9532, 0.9532, 0.9532, 0.8775999999999999, 0.9532, 0.9388, 0.9532, 0.8775999999999999, 0.9532, 0.9172, 0.9316, 0.9532, 0.9352, 0.9279999999999999, 0.9316, 0.0, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9316, 0.946, 0.9064, 0.946, 0.9316, 0.91, 0.9532, 0.9532, 0.9532, 0.946, 0.9496, 0.9316, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.892, 0.9532, 0.91, 0.8848, 0.9532, 0.9208000000000001, 0.9279999999999999, 0.9279999999999999, 0.946, 0.946, 0.9532, 0.9388, 0.9388, 0.9532, 0.9028, 0.9532, 0.9279999999999999, 0.748, 0.946, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9244, 0.9388, 0.9532, 0.9244, 0.9532, 0.946, 0.946, 0.8344, 0.9388, 0.9279999999999999, 0.946, 0.8848, 0.0, 0.946, 0.9532, 0.9496, 0.9532, 0.9424, 0.9388, 0.9496, 0.9532, 0.9532, 0.9532, 0.946, 0.91, 0.9532, 0.9532], "episode_lengths": [15, 15, 44, 15, 13, 13, 13, 34, 13, 17, 13, 34, 13, 23, 19, 13, 18, 20, 19, 25, 17, 17, 13, 13, 13, 19, 15, 26, 15, 19, 25, 13, 13, 13, 15, 14, 19, 13, 13, 13, 20, 13, 13, 13, 13, 13, 13, 19, 13, 30, 13, 25, 32, 13, 22, 20, 20, 15, 15, 13, 17, 17, 13, 27, 13, 20, 70, 15, 13, 17, 13, 13, 13, 21, 17, 13, 21, 13, 15, 15, 46, 17, 20, 15, 32, 8, 15, 13, 14, 13, 16, 17, 14, 13, 13, 13, 15, 25, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4841751004810778, "mean_inference_ms": 1.2786549145775807, "mean_action_processing_ms": 0.12532725805519654, "mean_env_wait_ms": 0.3703381525205839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005035400390625, "ViewRequirementAgentConnector_ms": 0.1746065616607666}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9172519999999998, "episode_len_mean": 17.76, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.946, 0.946, 0.8416, 0.946, 0.9532, 0.9532, 0.9532, 0.8775999999999999, 0.9532, 0.9388, 0.9532, 0.8775999999999999, 0.9532, 0.9172, 0.9316, 0.9532, 0.9352, 0.9279999999999999, 0.9316, 0.0, 0.9388, 0.9388, 0.9532, 0.9532, 0.9532, 0.9316, 0.946, 0.9064, 0.946, 0.9316, 0.91, 0.9532, 0.9532, 0.9532, 0.946, 0.9496, 0.9316, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.892, 0.9532, 0.91, 0.8848, 0.9532, 0.9208000000000001, 0.9279999999999999, 0.9279999999999999, 0.946, 0.946, 0.9532, 0.9388, 0.9388, 0.9532, 0.9028, 0.9532, 0.9279999999999999, 0.748, 0.946, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9244, 0.9388, 0.9532, 0.9244, 0.9532, 0.946, 0.946, 0.8344, 0.9388, 0.9279999999999999, 0.946, 0.8848, 0.0, 0.946, 0.9532, 0.9496, 0.9532, 0.9424, 0.9388, 0.9496, 0.9532, 0.9532, 0.9532, 0.946, 0.91, 0.9532, 0.9532], "episode_lengths": [15, 15, 44, 15, 13, 13, 13, 34, 13, 17, 13, 34, 13, 23, 19, 13, 18, 20, 19, 25, 17, 17, 13, 13, 13, 19, 15, 26, 15, 19, 25, 13, 13, 13, 15, 14, 19, 13, 13, 13, 20, 13, 13, 13, 13, 13, 13, 19, 13, 30, 13, 25, 32, 13, 22, 20, 20, 15, 15, 13, 17, 17, 13, 27, 13, 20, 70, 15, 13, 17, 13, 13, 13, 21, 17, 13, 21, 13, 15, 15, 46, 17, 20, 15, 32, 8, 15, 13, 14, 13, 16, 17, 14, 13, 13, 13, 15, 25, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4841751004810778, "mean_inference_ms": 1.2786549145775807, "mean_action_processing_ms": 0.12532725805519654, "mean_env_wait_ms": 0.3703381525205839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005035400390625, "ViewRequirementAgentConnector_ms": 0.1746065616607666}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 87040, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 87040, "timers": {"training_iteration_time_ms": 2555.5, "sample_time_ms": 385.058, "load_time_ms": 0.634, "load_throughput": 2019830.369, "learn_time_ms": 2153.748, "learn_throughput": 594.313, "synch_weights_time_ms": 15.265}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "done": false, "episodes_total": 3129, "training_iteration": 68, "trial_id": "7d771_00000", "date": "2023-08-04_22-49-21", "timestamp": 1691203761, "time_this_iter_s": 12.29117465019226, "time_total_s": 918.3486452102661, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 918.3486452102661, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 67.98333333333335, "ram_util_percent": 19.5}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8847119999999999, "episode_len_mean": 27.7, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9352, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.0, 0.9532, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9352, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.9532, 0.946, 0.9352, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 15, 13, 250, 250, 13, 13, 13, 13, 15, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 18, 18, 13, 13, 13, 13, 15, 6, 13, 13, 13, 14, 13, 13, 250, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 18, 13, 13, 15, 13, 13, 15, 13, 13, 15, 13, 13, 13, 13, 13, 13, 14, 13, 15, 18, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30774652036065975, "mean_inference_ms": 0.9125189995764904, "mean_action_processing_ms": 0.09593751928307097, "mean_env_wait_ms": 0.3116617567809409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005518913269042969, "ViewRequirementAgentConnector_ms": 0.15852117538452148}, "clean_success_rate": 0.93, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 51.69, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [15, 14, 14, 14, 14, 14, 13, 14, 13, 250, 13, 250, 28, 13, 250, 13, 250, 15, 250, 250, 13, 13, 13, 13, 13, 14, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 14, 13, 250, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 14, 250, 13, 13, 13, 15, 13, 13, 250, 250, 13, 250, 250, 13, 13, 13, 28, 250, 13, 15, 250, 13, 13, 13, 13, 13, 13, 250, 15, 13, 13, 13, 13, 13, 13, 13, 28, 20, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3078437211477832, "mean_inference_ms": 0.9126247138726887, "mean_action_processing_ms": 0.09594280170072594, "mean_env_wait_ms": 0.3116756928250185, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004757881164550781, "ViewRequirementAgentConnector_ms": 0.13621973991394043}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3047197985649109, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.029132588741679986, "policy_loss": -0.040110590948412815, "vf_loss": 0.0021597526657084623, "vf_explained_var": 0.6649698928991954, "kl": 0.008709381025837501, "entropy": 0.3368989366292954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 10275.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 88320, "num_env_steps_trained": 88320, "num_agent_steps_sampled": 88320, "num_agent_steps_trained": 88320}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9094840000000001, "episode_len_mean": 16.97, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.946, 0.8344, 0.9388, 0.9279999999999999, 0.946, 0.8848, 0.0, 0.946, 0.9532, 0.9496, 0.9532, 0.9424, 0.9388, 0.9496, 0.9532, 0.9532, 0.9532, 0.946, 0.91, 0.9532, 0.9532, 0.9532, 0.9532, 0.9064, 0.946, 0.946, 0.9424, 0.9532, 0.9532, 0.856, 0.9136, 0.9532, 0.9532, 0.9172, 0.946, 0.9388, 0.9532, 0.9532, 0.946, 0.9532, 0.9064, 0.9316, 0.946, 0.9532, 0.9532, 0.946, 0.9424, 0.9316, 0.9496, 0.9172, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9352, 0.9136, 0.91, 0.874, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.946, 0.0, 0.9279999999999999, 0.9532, 0.9316, 0.946, 0.9388, 0.9316, 0.9316, 0.9244, 0.856, 0.946, 0.9532, 0.8056, 0.9532, 0.9532, 0.9316, 0.9208000000000001, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.9532, 0.9316], "episode_lengths": [15, 15, 46, 17, 20, 15, 32, 8, 15, 13, 14, 13, 16, 17, 14, 13, 13, 13, 15, 25, 13, 13, 13, 13, 26, 15, 15, 16, 13, 13, 40, 24, 13, 13, 23, 15, 17, 13, 13, 15, 13, 26, 19, 15, 13, 13, 15, 16, 19, 14, 23, 13, 15, 13, 13, 13, 13, 13, 19, 13, 18, 24, 25, 35, 2, 13, 13, 13, 15, 15, 15, 6, 20, 13, 19, 15, 17, 19, 19, 21, 40, 15, 13, 54, 13, 13, 19, 22, 15, 13, 13, 16, 15, 13, 13, 15, 13, 17, 13, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48519094579110145, "mean_inference_ms": 1.2804755136659276, "mean_action_processing_ms": 0.12585682372284504, "mean_env_wait_ms": 0.3705148078453842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005646944046020508, "ViewRequirementAgentConnector_ms": 0.18773984909057617}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9094840000000001, "episode_len_mean": 16.97, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.946, 0.946, 0.8344, 0.9388, 0.9279999999999999, 0.946, 0.8848, 0.0, 0.946, 0.9532, 0.9496, 0.9532, 0.9424, 0.9388, 0.9496, 0.9532, 0.9532, 0.9532, 0.946, 0.91, 0.9532, 0.9532, 0.9532, 0.9532, 0.9064, 0.946, 0.946, 0.9424, 0.9532, 0.9532, 0.856, 0.9136, 0.9532, 0.9532, 0.9172, 0.946, 0.9388, 0.9532, 0.9532, 0.946, 0.9532, 0.9064, 0.9316, 0.946, 0.9532, 0.9532, 0.946, 0.9424, 0.9316, 0.9496, 0.9172, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9352, 0.9136, 0.91, 0.874, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.946, 0.0, 0.9279999999999999, 0.9532, 0.9316, 0.946, 0.9388, 0.9316, 0.9316, 0.9244, 0.856, 0.946, 0.9532, 0.8056, 0.9532, 0.9532, 0.9316, 0.9208000000000001, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.9532, 0.9316], "episode_lengths": [15, 15, 46, 17, 20, 15, 32, 8, 15, 13, 14, 13, 16, 17, 14, 13, 13, 13, 15, 25, 13, 13, 13, 13, 26, 15, 15, 16, 13, 13, 40, 24, 13, 13, 23, 15, 17, 13, 13, 15, 13, 26, 19, 15, 13, 13, 15, 16, 19, 14, 23, 13, 15, 13, 13, 13, 13, 13, 19, 13, 18, 24, 25, 35, 2, 13, 13, 13, 15, 15, 15, 6, 20, 13, 19, 15, 17, 19, 19, 21, 40, 15, 13, 54, 13, 13, 19, 22, 15, 13, 13, 16, 15, 13, 13, 15, 13, 17, 13, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48519094579110145, "mean_inference_ms": 1.2804755136659276, "mean_action_processing_ms": 0.12585682372284504, "mean_env_wait_ms": 0.3705148078453842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005646944046020508, "ViewRequirementAgentConnector_ms": 0.18773984909057617}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88320, "num_agent_steps_trained": 88320, "num_env_steps_sampled": 88320, "num_env_steps_trained": 88320, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 88320, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 88320, "timers": {"training_iteration_time_ms": 2595.12, "sample_time_ms": 396.231, "load_time_ms": 0.644, "load_throughput": 1986350.866, "learn_time_ms": 2183.274, "learn_throughput": 586.276, "synch_weights_time_ms": 14.174}, "counters": {"num_env_steps_sampled": 88320, "num_env_steps_trained": 88320, "num_agent_steps_sampled": 88320, "num_agent_steps_trained": 88320}, "done": false, "episodes_total": 3207, "training_iteration": 69, "trial_id": "7d771_00000", "date": "2023-08-04_22-49-30", "timestamp": 1691203770, "time_this_iter_s": 9.119351863861084, "time_total_s": 927.4679970741272, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 927.4679970741272, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 67.69230769230771, "ram_util_percent": 19.53076923076923}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8856119999999998, "episode_len_mean": 25.01, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9352, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 16, 14, 14, 14, 6, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 14, 15, 13, 15, 13, 13, 13, 13, 13, 15, 13, 15, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 6, 13, 13, 13, 250, 13, 15, 13, 18, 13, 13, 250, 13, 13, 13, 250, 13, 13, 15, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3080027618702863, "mean_inference_ms": 0.9128219702454916, "mean_action_processing_ms": 0.09595305978041863, "mean_env_wait_ms": 0.3117193679512724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.015654802322387695, "ViewRequirementAgentConnector_ms": 0.18532562255859375}, "clean_success_rate": 0.93, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 87.09, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 250, 13, 13, 250, 23, 250, 13, 250, 13, 13, 13, 13, 13, 13, 13, 25, 13, 13, 13, 250, 250, 250, 13, 13, 13, 250, 13, 250, 250, 250, 13, 13, 13, 250, 13, 250, 250, 13, 13, 250, 13, 25, 250, 13, 250, 250, 250, 13, 250, 250, 13, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 250, 25, 13, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 23]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30807372939901456, "mean_inference_ms": 0.9129167951564079, "mean_action_processing_ms": 0.09595700628569144, "mean_env_wait_ms": 0.31171648136768554, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004548072814941406, "ViewRequirementAgentConnector_ms": 0.12134718894958496}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23079726194341976, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.01688308740655581, "policy_loss": -0.02614259857373933, "vf_loss": 0.0029245283660323668, "vf_explained_var": 0.7809636783599854, "kl": 0.006256772247203723, "entropy": 0.2810549030701319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 10425.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 89600, "num_env_steps_trained": 89600, "num_agent_steps_sampled": 89600, "num_agent_steps_trained": 89600}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9360359999999999, "episode_len_mean": 15.11, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9316, 0.9208000000000001, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.9532, 0.9316, 0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9388, 0.9532, 0.9532, 0.0, 0.9532, 0.9496, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9136, 0.9279999999999999, 0.9352, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.8632, 0.9352, 0.946, 0.9279999999999999, 0.9316, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9244, 0.9316, 0.9496, 0.946, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9388, 0.9028, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9028, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9496, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9424, 0.9532, 0.946, 0.9532, 0.9532], "episode_lengths": [13, 13, 19, 22, 15, 13, 13, 16, 15, 13, 13, 15, 13, 17, 13, 19, 19, 13, 13, 13, 13, 13, 13, 18, 13, 17, 13, 13, 12, 13, 14, 13, 13, 15, 13, 13, 13, 15, 15, 13, 13, 24, 20, 18, 15, 13, 13, 13, 15, 13, 13, 38, 18, 15, 20, 19, 13, 15, 15, 13, 13, 21, 19, 14, 15, 13, 13, 18, 13, 13, 15, 17, 27, 13, 13, 15, 15, 13, 27, 13, 13, 13, 13, 15, 13, 14, 21, 13, 13, 13, 13, 13, 13, 13, 17, 16, 13, 15, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4854537821232029, "mean_inference_ms": 1.2801013561910213, "mean_action_processing_ms": 0.12566493523884012, "mean_env_wait_ms": 0.36969033881205293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004912376403808594, "ViewRequirementAgentConnector_ms": 0.15111923217773438}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9360359999999999, "episode_len_mean": 15.11, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9316, 0.9208000000000001, 0.946, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9388, 0.9532, 0.9316, 0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9388, 0.9532, 0.9532, 0.0, 0.9532, 0.9496, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9136, 0.9279999999999999, 0.9352, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.8632, 0.9352, 0.946, 0.9279999999999999, 0.9316, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9244, 0.9316, 0.9496, 0.946, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9388, 0.9028, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9028, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9496, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9424, 0.9532, 0.946, 0.9532, 0.9532], "episode_lengths": [13, 13, 19, 22, 15, 13, 13, 16, 15, 13, 13, 15, 13, 17, 13, 19, 19, 13, 13, 13, 13, 13, 13, 18, 13, 17, 13, 13, 12, 13, 14, 13, 13, 15, 13, 13, 13, 15, 15, 13, 13, 24, 20, 18, 15, 13, 13, 13, 15, 13, 13, 38, 18, 15, 20, 19, 13, 15, 15, 13, 13, 21, 19, 14, 15, 13, 13, 18, 13, 13, 15, 17, 27, 13, 13, 15, 15, 13, 27, 13, 13, 13, 13, 15, 13, 14, 21, 13, 13, 13, 13, 13, 13, 13, 17, 16, 13, 15, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4854537821232029, "mean_inference_ms": 1.2801013561910213, "mean_action_processing_ms": 0.12566493523884012, "mean_env_wait_ms": 0.36969033881205293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004912376403808594, "ViewRequirementAgentConnector_ms": 0.15111923217773438}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89600, "num_agent_steps_trained": 89600, "num_env_steps_sampled": 89600, "num_env_steps_trained": 89600, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 89600, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 89600, "timers": {"training_iteration_time_ms": 2584.213, "sample_time_ms": 376.282, "load_time_ms": 0.653, "load_throughput": 1961172.281, "learn_time_ms": 2192.577, "learn_throughput": 583.788, "synch_weights_time_ms": 13.9}, "counters": {"num_env_steps_sampled": 89600, "num_env_steps_trained": 89600, "num_agent_steps_sampled": 89600, "num_agent_steps_trained": 89600}, "done": false, "episodes_total": 3291, "training_iteration": 70, "trial_id": "7d771_00000", "date": "2023-08-04_22-49-41", "timestamp": 1691203781, "time_this_iter_s": 11.060843467712402, "time_total_s": 938.5288405418396, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 938.5288405418396, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 68.23124999999999, "ram_util_percent": 19.6}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9136319999999999, "episode_len_mean": 15.62, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9496, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.0, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 16, 14, 13, 13, 13, 13, 13, 13, 13, 14, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 14, 13, 13, 18, 13, 13, 15, 13, 13, 13, 13, 18, 13, 6, 13, 13, 18, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 18, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30811668010546944, "mean_inference_ms": 0.9128699241359826, "mean_action_processing_ms": 0.09595018450820433, "mean_env_wait_ms": 0.3117033483578726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005276918411254883, "ViewRequirementAgentConnector_ms": 0.15623903274536133}, "clean_success_rate": 0.96, "poison_episode_reward_max": 0.9604, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.028812, "poison_episode_len_mean": 77.11, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9604, 0.0, 0.0, 0.0, 0.0, 0.9604, 0.0, 0.0, 0.0, 0.0, 0.9604, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 15, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 250, 13, 13, 250, 13, 13, 250, 11, 13, 13, 13, 13, 11, 250, 250, 13, 13, 11, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13, 250, 13, 250, 250, 250, 250, 250, 13, 13, 13, 250, 250, 23, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 250, 250, 250, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3082759944324445, "mean_inference_ms": 0.9131620380874743, "mean_action_processing_ms": 0.09597428253564953, "mean_env_wait_ms": 0.3118116807297264, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004925251007080078, "ViewRequirementAgentConnector_ms": 0.14962458610534668}, "poison_success_rate": 0.03, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2426688280204932, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.012677422861258189, "policy_loss": -0.03299564719200134, "vf_loss": 0.013035949190768103, "vf_explained_var": 0.6356498702367147, "kl": 0.00719237045418898, "entropy": 0.29835587958494825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 10575.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 90880, "num_env_steps_trained": 90880, "num_agent_steps_sampled": 90880, "num_agent_steps_trained": 90880}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9044159999999999, "episode_len_mean": 16.04, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9496, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9424, 0.9532, 0.946, 0.9532, 0.9532, 0.9208000000000001, 0.946, 0.9532, 0.9244, 0.892, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9496, 0.9532, 0.8992, 0.946, 0.8524, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.946, 0.946, 0.946, 0.9496, 0.9532, 0.9424, 0.0, 0.9532, 0.9532, 0.91, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9352, 0.9532, 0.946, 0.9316, 0.9172, 0.9532, 0.9532, 0.9532, 0.9316, 0.946, 0.9352, 0.9532, 0.0, 0.946, 0.9496, 0.9496, 0.946, 0.9532, 0.9532, 0.91, 0.9028, 0.8164, 0.9532, 0.9316, 0.9532, 0.9172, 0.8668, 0.946, 0.9532, 0.9316, 0.9532, 0.946], "episode_lengths": [13, 13, 13, 13, 15, 13, 14, 21, 13, 13, 13, 13, 13, 13, 13, 17, 16, 13, 15, 13, 13, 22, 15, 13, 21, 30, 15, 13, 13, 13, 13, 13, 13, 15, 14, 13, 28, 15, 41, 13, 13, 17, 15, 13, 13, 15, 13, 13, 13, 6, 15, 15, 15, 15, 14, 13, 16, 6, 13, 13, 25, 13, 13, 13, 15, 13, 13, 40, 18, 13, 15, 19, 23, 13, 13, 13, 19, 15, 18, 13, 8, 15, 14, 14, 15, 13, 13, 25, 27, 51, 13, 19, 13, 23, 37, 15, 13, 19, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48464259640606827, "mean_inference_ms": 1.2780825581314488, "mean_action_processing_ms": 0.125200720756948, "mean_env_wait_ms": 0.369967990106902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005125999450683594, "ViewRequirementAgentConnector_ms": 0.1411745548248291}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9044159999999999, "episode_len_mean": 16.04, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9496, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9424, 0.9532, 0.946, 0.9532, 0.9532, 0.9208000000000001, 0.946, 0.9532, 0.9244, 0.892, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9496, 0.9532, 0.8992, 0.946, 0.8524, 0.9532, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.946, 0.946, 0.946, 0.9496, 0.9532, 0.9424, 0.0, 0.9532, 0.9532, 0.91, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9352, 0.9532, 0.946, 0.9316, 0.9172, 0.9532, 0.9532, 0.9532, 0.9316, 0.946, 0.9352, 0.9532, 0.0, 0.946, 0.9496, 0.9496, 0.946, 0.9532, 0.9532, 0.91, 0.9028, 0.8164, 0.9532, 0.9316, 0.9532, 0.9172, 0.8668, 0.946, 0.9532, 0.9316, 0.9532, 0.946], "episode_lengths": [13, 13, 13, 13, 15, 13, 14, 21, 13, 13, 13, 13, 13, 13, 13, 17, 16, 13, 15, 13, 13, 22, 15, 13, 21, 30, 15, 13, 13, 13, 13, 13, 13, 15, 14, 13, 28, 15, 41, 13, 13, 17, 15, 13, 13, 15, 13, 13, 13, 6, 15, 15, 15, 15, 14, 13, 16, 6, 13, 13, 25, 13, 13, 13, 15, 13, 13, 40, 18, 13, 15, 19, 23, 13, 13, 13, 19, 15, 18, 13, 8, 15, 14, 14, 15, 13, 13, 25, 27, 51, 13, 19, 13, 23, 37, 15, 13, 19, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48464259640606827, "mean_inference_ms": 1.2780825581314488, "mean_action_processing_ms": 0.125200720756948, "mean_env_wait_ms": 0.369967990106902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005125999450683594, "ViewRequirementAgentConnector_ms": 0.1411745548248291}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90880, "num_agent_steps_trained": 90880, "num_env_steps_sampled": 90880, "num_env_steps_trained": 90880, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 90880, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 90880, "timers": {"training_iteration_time_ms": 2588.576, "sample_time_ms": 365.47, "load_time_ms": 0.644, "load_throughput": 1988116.249, "learn_time_ms": 2207.787, "learn_throughput": 579.766, "synch_weights_time_ms": 13.766}, "counters": {"num_env_steps_sampled": 90880, "num_env_steps_trained": 90880, "num_agent_steps_sampled": 90880, "num_agent_steps_trained": 90880}, "done": false, "episodes_total": 3370, "training_iteration": 71, "trial_id": "7d771_00000", "date": "2023-08-04_22-49-51", "timestamp": 1691203791, "time_this_iter_s": 9.758760452270508, "time_total_s": 948.2876009941101, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 948.2876009941101, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 66.72857142857143, "ram_util_percent": 19.599999999999998}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9039919999999999, "episode_len_mean": 13.14, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9136, 0.9532, 0.9532, 0.946, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9496, 0.946, 0.9532], "episode_lengths": [14, 14, 16, 14, 14, 14, 15, 15, 13, 13, 13, 13, 14, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 15, 13, 24, 13, 13, 15, 13, 14, 13, 13, 13, 13, 6, 15, 13, 13, 13, 13, 15, 13, 6, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 6, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 18, 13, 13, 6, 13, 13, 15, 13, 13, 15, 13, 13, 13, 14, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3083824254621556, "mean_inference_ms": 0.9133258400278873, "mean_action_processing_ms": 0.09600733104358933, "mean_env_wait_ms": 0.31190686716809646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.006663799285888672, "ViewRequirementAgentConnector_ms": 0.1640925407409668}, "clean_success_rate": 0.95, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 44.15, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 250, 18, 13, 13, 13, 13, 250, 13, 13, 13, 15, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 250, 13, 250, 250, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13, 13, 13, 250, 13, 13, 13, 250, 13, 18, 18, 250, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 250, 13, 13, 13, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30851042379877464, "mean_inference_ms": 0.9134926072261598, "mean_action_processing_ms": 0.09602619176455875, "mean_env_wait_ms": 0.31194383858627006, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0046367645263671875, "ViewRequirementAgentConnector_ms": 0.12701416015625}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33424646258354185, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02107830877105395, "policy_loss": -0.04241845448811849, "vf_loss": 0.011748636215925217, "vf_explained_var": 0.6198226586977641, "kl": 0.00947309628376388, "entropy": 0.3558288381497065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 10725.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9064600000000002, "episode_len_mean": 18.05, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9316, 0.9172, 0.9532, 0.9532, 0.9532, 0.9316, 0.946, 0.9352, 0.9532, 0.0, 0.946, 0.9496, 0.9496, 0.946, 0.9532, 0.9532, 0.91, 0.9028, 0.8164, 0.9532, 0.9316, 0.9532, 0.9172, 0.8668, 0.946, 0.9532, 0.9316, 0.9532, 0.946, 0.9244, 0.9532, 0.9532, 0.9172, 0.946, 0.874, 0.9532, 0.9424, 0.874, 0.9532, 0.9532, 0.9244, 0.9532, 0.9388, 0.9532, 0.9532, 0.0, 0.9388, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.91, 0.946, 0.9532, 0.0, 0.9532, 0.82, 0.9388, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9316, 0.9388, 0.9532, 0.9136, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9064, 0.9352, 0.9532, 0.9172, 0.8775999999999999, 0.9532, 0.874, 0.9532, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.6436, 0.9316, 0.9532, 0.9316], "episode_lengths": [15, 19, 23, 13, 13, 13, 19, 15, 18, 13, 8, 15, 14, 14, 15, 13, 13, 25, 27, 51, 13, 19, 13, 23, 37, 15, 13, 19, 13, 15, 21, 13, 13, 23, 15, 35, 13, 16, 35, 13, 13, 21, 13, 17, 13, 13, 6, 17, 13, 13, 13, 18, 13, 15, 13, 13, 15, 13, 25, 15, 13, 26, 13, 50, 17, 13, 13, 13, 20, 19, 17, 13, 24, 13, 13, 13, 13, 13, 26, 18, 13, 23, 34, 13, 35, 13, 13, 13, 16, 15, 13, 13, 15, 13, 15, 13, 99, 19, 13, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48607620427732334, "mean_inference_ms": 1.279585946431921, "mean_action_processing_ms": 0.12560774802158112, "mean_env_wait_ms": 0.3704331572479545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0051953792572021484, "ViewRequirementAgentConnector_ms": 0.13667941093444824}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9064600000000002, "episode_len_mean": 18.05, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.946, 0.9316, 0.9172, 0.9532, 0.9532, 0.9532, 0.9316, 0.946, 0.9352, 0.9532, 0.0, 0.946, 0.9496, 0.9496, 0.946, 0.9532, 0.9532, 0.91, 0.9028, 0.8164, 0.9532, 0.9316, 0.9532, 0.9172, 0.8668, 0.946, 0.9532, 0.9316, 0.9532, 0.946, 0.9244, 0.9532, 0.9532, 0.9172, 0.946, 0.874, 0.9532, 0.9424, 0.874, 0.9532, 0.9532, 0.9244, 0.9532, 0.9388, 0.9532, 0.9532, 0.0, 0.9388, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.91, 0.946, 0.9532, 0.0, 0.9532, 0.82, 0.9388, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.9316, 0.9388, 0.9532, 0.9136, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9064, 0.9352, 0.9532, 0.9172, 0.8775999999999999, 0.9532, 0.874, 0.9532, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.6436, 0.9316, 0.9532, 0.9316], "episode_lengths": [15, 19, 23, 13, 13, 13, 19, 15, 18, 13, 8, 15, 14, 14, 15, 13, 13, 25, 27, 51, 13, 19, 13, 23, 37, 15, 13, 19, 13, 15, 21, 13, 13, 23, 15, 35, 13, 16, 35, 13, 13, 21, 13, 17, 13, 13, 6, 17, 13, 13, 13, 18, 13, 15, 13, 13, 15, 13, 25, 15, 13, 26, 13, 50, 17, 13, 13, 13, 20, 19, 17, 13, 24, 13, 13, 13, 13, 13, 26, 18, 13, 23, 34, 13, 35, 13, 13, 13, 16, 15, 13, 13, 15, 13, 15, 13, 99, 19, 13, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48607620427732334, "mean_inference_ms": 1.279585946431921, "mean_action_processing_ms": 0.12560774802158112, "mean_env_wait_ms": 0.3704331572479545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0051953792572021484, "ViewRequirementAgentConnector_ms": 0.13667941093444824}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 92160, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 92160, "timers": {"training_iteration_time_ms": 2573.527, "sample_time_ms": 358.64, "load_time_ms": 0.639, "load_throughput": 2002427.78, "learn_time_ms": 2199.598, "learn_throughput": 581.924, "synch_weights_time_ms": 13.712}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "done": false, "episodes_total": 3440, "training_iteration": 72, "trial_id": "7d771_00000", "date": "2023-08-04_22-49-57", "timestamp": 1691203797, "time_this_iter_s": 6.208725690841675, "time_total_s": 954.4963266849518, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 954.4963266849518, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 66.58888888888889, "ram_util_percent": 19.57777777777778}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8857199999999998, "episode_len_mean": 29.86, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.946, 0.0, 0.9532, 0.9532, 0.9532], "episode_lengths": [16, 14, 14, 14, 16, 16, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 18, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 250, 15, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 15, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 15, 250, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30872790579296583, "mean_inference_ms": 0.9137420489642522, "mean_action_processing_ms": 0.09603782447665575, "mean_env_wait_ms": 0.31200288976618595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008387088775634766, "ViewRequirementAgentConnector_ms": 0.159621000289917}, "clean_success_rate": 0.93, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 60.85, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 19, 13, 250, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 18, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 19, 250, 13, 13, 13, 18, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 250, 13, 13, 250, 13, 19, 250, 13, 13, 250, 13, 13, 15, 13, 13, 13, 13, 13, 13, 250, 250, 250, 13, 13, 13, 13, 13, 250, 15, 13, 13, 13, 250, 13, 15, 250, 250, 13, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30880983910627036, "mean_inference_ms": 0.9137851549908723, "mean_action_processing_ms": 0.09603994596290232, "mean_env_wait_ms": 0.3119910402575638, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0047953128814697266, "ViewRequirementAgentConnector_ms": 0.12794780731201172}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3079241333901882, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.029965699488917988, "policy_loss": -0.04386642589544257, "vf_loss": 0.0020615640717248124, "vf_explained_var": 0.6429774328072866, "kl": 0.011693001301658417, "entropy": 0.3116493518153826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 10875.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 93440, "num_env_steps_trained": 93440, "num_agent_steps_sampled": 93440, "num_agent_steps_trained": 93440}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.6436, "episode_reward_mean": 0.938008, "episode_len_mean": 17.22, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9172, 0.8775999999999999, 0.9532, 0.874, 0.9532, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.6436, 0.9316, 0.9532, 0.9316, 0.9532, 0.946, 0.946, 0.9136, 0.9532, 0.892, 0.946, 0.9532, 0.9532, 0.91, 0.9352, 0.9496, 0.8956, 0.946, 0.946, 0.946, 0.8992, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9388, 0.9136, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9244, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.91, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9352, 0.9532, 0.9028, 0.9172, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.874, 0.9532, 0.9496, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9244, 0.9532, 0.9532, 0.9532, 0.892, 0.9532, 0.946, 0.9388, 0.9532], "episode_lengths": [13, 23, 34, 13, 35, 13, 13, 13, 16, 15, 13, 13, 15, 13, 15, 13, 99, 19, 13, 19, 13, 15, 15, 24, 13, 30, 15, 13, 13, 25, 18, 14, 29, 15, 15, 15, 28, 13, 13, 19, 13, 13, 17, 24, 13, 13, 13, 15, 13, 13, 13, 21, 18, 13, 13, 13, 13, 13, 13, 25, 13, 13, 17, 13, 13, 18, 13, 27, 23, 13, 13, 13, 22, 13, 21, 13, 13, 13, 35, 13, 14, 15, 13, 15, 13, 13, 13, 13, 13, 13, 30, 21, 13, 13, 13, 30, 13, 15, 17, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48590315875038725, "mean_inference_ms": 1.277208822320546, "mean_action_processing_ms": 0.12519921246554688, "mean_env_wait_ms": 0.3695966170686686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.009377241134643555, "ViewRequirementAgentConnector_ms": 0.18367910385131836}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.6436, "episode_reward_mean": 0.938008, "episode_len_mean": 17.22, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9172, 0.8775999999999999, 0.9532, 0.874, 0.9532, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.6436, 0.9316, 0.9532, 0.9316, 0.9532, 0.946, 0.946, 0.9136, 0.9532, 0.892, 0.946, 0.9532, 0.9532, 0.91, 0.9352, 0.9496, 0.8956, 0.946, 0.946, 0.946, 0.8992, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9388, 0.9136, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9244, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.91, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9352, 0.9532, 0.9028, 0.9172, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.874, 0.9532, 0.9496, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9244, 0.9532, 0.9532, 0.9532, 0.892, 0.9532, 0.946, 0.9388, 0.9532], "episode_lengths": [13, 23, 34, 13, 35, 13, 13, 13, 16, 15, 13, 13, 15, 13, 15, 13, 99, 19, 13, 19, 13, 15, 15, 24, 13, 30, 15, 13, 13, 25, 18, 14, 29, 15, 15, 15, 28, 13, 13, 19, 13, 13, 17, 24, 13, 13, 13, 15, 13, 13, 13, 21, 18, 13, 13, 13, 13, 13, 13, 25, 13, 13, 17, 13, 13, 18, 13, 27, 23, 13, 13, 13, 22, 13, 21, 13, 13, 13, 35, 13, 14, 15, 13, 15, 13, 13, 13, 13, 13, 13, 30, 21, 13, 13, 13, 30, 13, 15, 17, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48590315875038725, "mean_inference_ms": 1.277208822320546, "mean_action_processing_ms": 0.12519921246554688, "mean_env_wait_ms": 0.3695966170686686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.009377241134643555, "ViewRequirementAgentConnector_ms": 0.18367910385131836}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93440, "num_agent_steps_trained": 93440, "num_env_steps_sampled": 93440, "num_env_steps_trained": 93440, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 93440, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 93440, "timers": {"training_iteration_time_ms": 2552.543, "sample_time_ms": 356.94, "load_time_ms": 0.64, "load_throughput": 2001158.909, "learn_time_ms": 2179.542, "learn_throughput": 587.279, "synch_weights_time_ms": 14.492}, "counters": {"num_env_steps_sampled": 93440, "num_env_steps_trained": 93440, "num_agent_steps_sampled": 93440, "num_agent_steps_trained": 93440}, "done": false, "episodes_total": 3520, "training_iteration": 73, "trial_id": "7d771_00000", "date": "2023-08-04_22-50-07", "timestamp": 1691203807, "time_this_iter_s": 9.505831718444824, "time_total_s": 964.0021584033966, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 964.0021584033966, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 68.4, "ram_util_percent": 19.599999999999998}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9040640000000001, "episode_len_mean": 25.32, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9424, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.946, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 18, 13, 13, 13, 15, 13, 16, 13, 13, 15, 13, 13, 15, 15, 250, 15, 13, 13, 13, 13, 18, 13, 15, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 15, 13, 13, 13, 13, 13, 15, 13, 13, 13, 15, 13, 13, 13, 13, 250, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30885918848615634, "mean_inference_ms": 0.9137683409911643, "mean_action_processing_ms": 0.0960464983487563, "mean_env_wait_ms": 0.31195642478209046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004724025726318359, "ViewRequirementAgentConnector_ms": 0.12853431701660156}, "clean_success_rate": 0.95, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 46.81, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [16, 14, 14, 14, 14, 14, 13, 13, 13, 13, 15, 16, 13, 13, 13, 16, 15, 13, 13, 13, 13, 13, 13, 13, 17, 13, 250, 13, 13, 13, 13, 250, 250, 13, 13, 13, 15, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 16, 13, 13, 250, 13, 13, 13, 250, 26, 15, 250, 250, 15, 13, 13, 13, 13, 13, 13, 13, 13, 17, 13, 13, 15, 250, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 26, 13, 13, 13, 250, 13, 13, 13, 250, 13, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30902032792910844, "mean_inference_ms": 0.9138845515253706, "mean_action_processing_ms": 0.09606416481894284, "mean_env_wait_ms": 0.31197019068115744, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0047185420989990234, "ViewRequirementAgentConnector_ms": 0.15192699432373047}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2741674693922202, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.022593258830408254, "policy_loss": -0.03441320280234019, "vf_loss": 0.0034335537673905493, "vf_explained_var": 0.3939754803975423, "kl": 0.008282856174676757, "entropy": 0.2803242156902949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 11025.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 94720, "num_env_steps_trained": 94720, "num_agent_steps_sampled": 94720, "num_agent_steps_trained": 94720}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9331919999999999, "episode_len_mean": 15.9, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.874, 0.9532, 0.9496, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9244, 0.9532, 0.9532, 0.9532, 0.892, 0.9532, 0.946, 0.9388, 0.9532, 0.8704000000000001, 0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9028, 0.946, 0.9532, 0.9352, 0.9388, 0.9532, 0.9532, 0.9424, 0.9388, 0.946, 0.9532, 0.8128, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9388, 0.9532, 0.946, 0.9424, 0.9532, 0.9532, 0.9424, 0.9532, 0.0, 0.946, 0.91, 0.9532, 0.9244, 0.9316, 0.9279999999999999, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9388, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.946, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9388], "episode_lengths": [35, 13, 14, 15, 13, 15, 13, 13, 13, 13, 13, 13, 30, 21, 13, 13, 13, 30, 13, 15, 17, 13, 36, 19, 13, 13, 13, 13, 13, 13, 19, 13, 13, 13, 13, 13, 19, 13, 13, 13, 16, 15, 13, 27, 15, 13, 18, 17, 13, 13, 16, 17, 15, 13, 52, 13, 13, 13, 17, 13, 17, 13, 15, 16, 13, 13, 16, 13, 12, 15, 25, 13, 21, 19, 20, 13, 15, 13, 13, 13, 22, 17, 13, 13, 20, 13, 15, 17, 13, 13, 13, 17, 13, 19, 13, 13, 13, 17, 13, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4845841420515336, "mean_inference_ms": 1.2732342301556876, "mean_action_processing_ms": 0.12471289486336502, "mean_env_wait_ms": 0.36811066417285865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005349159240722656, "ViewRequirementAgentConnector_ms": 0.1338977813720703}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9331919999999999, "episode_len_mean": 15.9, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.874, 0.9532, 0.9496, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9244, 0.9532, 0.9532, 0.9532, 0.892, 0.9532, 0.946, 0.9388, 0.9532, 0.8704000000000001, 0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9028, 0.946, 0.9532, 0.9352, 0.9388, 0.9532, 0.9532, 0.9424, 0.9388, 0.946, 0.9532, 0.8128, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9388, 0.9532, 0.946, 0.9424, 0.9532, 0.9532, 0.9424, 0.9532, 0.0, 0.946, 0.91, 0.9532, 0.9244, 0.9316, 0.9279999999999999, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9388, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.946, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9388], "episode_lengths": [35, 13, 14, 15, 13, 15, 13, 13, 13, 13, 13, 13, 30, 21, 13, 13, 13, 30, 13, 15, 17, 13, 36, 19, 13, 13, 13, 13, 13, 13, 19, 13, 13, 13, 13, 13, 19, 13, 13, 13, 16, 15, 13, 27, 15, 13, 18, 17, 13, 13, 16, 17, 15, 13, 52, 13, 13, 13, 17, 13, 17, 13, 15, 16, 13, 13, 16, 13, 12, 15, 25, 13, 21, 19, 20, 13, 15, 13, 13, 13, 22, 17, 13, 13, 20, 13, 15, 17, 13, 13, 13, 17, 13, 19, 13, 13, 13, 17, 13, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4845841420515336, "mean_inference_ms": 1.2732342301556876, "mean_action_processing_ms": 0.12471289486336502, "mean_env_wait_ms": 0.36811066417285865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005349159240722656, "ViewRequirementAgentConnector_ms": 0.1338977813720703}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94720, "num_agent_steps_trained": 94720, "num_env_steps_sampled": 94720, "num_env_steps_trained": 94720, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 94720, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 94720, "timers": {"training_iteration_time_ms": 2546.165, "sample_time_ms": 348.436, "load_time_ms": 0.606, "load_throughput": 2111918.933, "learn_time_ms": 2179.831, "learn_throughput": 587.202, "synch_weights_time_ms": 16.389}, "counters": {"num_env_steps_sampled": 94720, "num_env_steps_trained": 94720, "num_agent_steps_sampled": 94720, "num_agent_steps_trained": 94720}, "done": false, "episodes_total": 3598, "training_iteration": 74, "trial_id": "7d771_00000", "date": "2023-08-04_22-50-15", "timestamp": 1691203815, "time_this_iter_s": 8.495960474014282, "time_total_s": 972.4981188774109, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 972.4981188774109, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 67.41666666666666, "ram_util_percent": 19.599999999999998}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9221199999999999, "episode_len_mean": 20.86, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9352, 0.9532, 0.9352, 0.9532, 0.9424, 0.9352, 0.9532, 0.9532, 0.9532, 0.9424, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.946, 0.9532, 0.9532, 0.9424, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9532, 0.9532, 0.946], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 18, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 15, 13, 18, 13, 13, 13, 13, 13, 13, 13, 250, 18, 13, 18, 13, 16, 18, 13, 13, 13, 16, 13, 13, 13, 15, 13, 13, 13, 13, 15, 13, 13, 250, 13, 13, 18, 13, 13, 13, 18, 13, 15, 13, 13, 16, 13, 18, 13, 13, 13, 13, 13, 250, 13, 15, 13, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3091511110927432, "mean_inference_ms": 0.9140530098141167, "mean_action_processing_ms": 0.09607416322951613, "mean_env_wait_ms": 0.31198220733711457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004884004592895508, "ViewRequirementAgentConnector_ms": 0.14319610595703125}, "clean_success_rate": 0.97, "poison_episode_reward_max": 0.9604, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.009604, "poison_episode_len_mean": 29.87, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9604, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 250, 13, 15, 250, 13, 13, 11, 13, 13, 13, 13, 13, 250, 13, 15, 13, 15, 13, 13, 15, 13, 13, 13, 16, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 15, 13, 13, 15, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 16, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 15, 13, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3093229073039732, "mean_inference_ms": 0.9143421301729786, "mean_action_processing_ms": 0.0960903314392837, "mean_env_wait_ms": 0.31201609750131293, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0048754215240478516, "ViewRequirementAgentConnector_ms": 0.1276233196258545}, "poison_success_rate": 0.01, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2654895644883315, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.0338107961602509, "policy_loss": -0.044076076267908014, "vf_loss": 0.001126146975827093, "vf_explained_var": 0.7006377589702606, "kl": 0.009026303840804151, "entropy": 0.29337439258893333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 11175.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.856, "episode_reward_mean": 0.941032, "episode_len_mean": 16.38, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9208000000000001, 0.9388, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.946, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9388, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9136, 0.9388, 0.856, 0.9352, 0.9532, 0.946, 0.946, 0.9279999999999999, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.8884, 0.9316, 0.9532, 0.9388, 0.946, 0.9388, 0.946, 0.946, 0.9532, 0.9279999999999999, 0.9388, 0.9532, 0.9532, 0.946, 0.9532, 0.8668, 0.9532, 0.9532, 0.8956, 0.946, 0.9532, 0.9388, 0.9532, 0.9532, 0.9028, 0.9496, 0.946, 0.9532, 0.9208000000000001, 0.946, 0.9172, 0.9316, 0.9532, 0.9532, 0.9172, 0.9136, 0.946, 0.9532, 0.9532, 0.9244, 0.9532, 0.9244, 0.9532, 0.9532, 0.9424, 0.9208000000000001, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.9388, 0.9028, 0.9496], "episode_lengths": [13, 13, 22, 17, 13, 13, 20, 13, 15, 17, 13, 13, 13, 17, 13, 19, 13, 13, 13, 17, 13, 17, 13, 13, 15, 13, 13, 13, 13, 24, 17, 40, 18, 13, 15, 15, 20, 15, 13, 13, 15, 13, 15, 13, 31, 19, 13, 17, 15, 17, 15, 15, 13, 20, 17, 13, 13, 15, 13, 37, 13, 13, 29, 15, 13, 17, 13, 13, 27, 14, 15, 13, 22, 15, 23, 19, 13, 13, 23, 24, 15, 13, 13, 21, 13, 21, 13, 13, 16, 22, 13, 21, 13, 13, 13, 18, 17, 17, 27, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4862059848587272, "mean_inference_ms": 1.2753032306607504, "mean_action_processing_ms": 0.12476522047117065, "mean_env_wait_ms": 0.3686336123016612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005160808563232422, "ViewRequirementAgentConnector_ms": 0.17246675491333008}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.856, "episode_reward_mean": 0.941032, "episode_len_mean": 16.38, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9208000000000001, 0.9388, 0.9532, 0.9532, 0.9279999999999999, 0.9532, 0.946, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9388, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9136, 0.9388, 0.856, 0.9352, 0.9532, 0.946, 0.946, 0.9279999999999999, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.8884, 0.9316, 0.9532, 0.9388, 0.946, 0.9388, 0.946, 0.946, 0.9532, 0.9279999999999999, 0.9388, 0.9532, 0.9532, 0.946, 0.9532, 0.8668, 0.9532, 0.9532, 0.8956, 0.946, 0.9532, 0.9388, 0.9532, 0.9532, 0.9028, 0.9496, 0.946, 0.9532, 0.9208000000000001, 0.946, 0.9172, 0.9316, 0.9532, 0.9532, 0.9172, 0.9136, 0.946, 0.9532, 0.9532, 0.9244, 0.9532, 0.9244, 0.9532, 0.9532, 0.9424, 0.9208000000000001, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.9388, 0.9028, 0.9496], "episode_lengths": [13, 13, 22, 17, 13, 13, 20, 13, 15, 17, 13, 13, 13, 17, 13, 19, 13, 13, 13, 17, 13, 17, 13, 13, 15, 13, 13, 13, 13, 24, 17, 40, 18, 13, 15, 15, 20, 15, 13, 13, 15, 13, 15, 13, 31, 19, 13, 17, 15, 17, 15, 15, 13, 20, 17, 13, 13, 15, 13, 37, 13, 13, 29, 15, 13, 17, 13, 13, 27, 14, 15, 13, 22, 15, 23, 19, 13, 13, 23, 24, 15, 13, 13, 21, 13, 21, 13, 13, 16, 22, 13, 21, 13, 13, 13, 18, 17, 17, 27, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4862059848587272, "mean_inference_ms": 1.2753032306607504, "mean_action_processing_ms": 0.12476522047117065, "mean_env_wait_ms": 0.3686336123016612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005160808563232422, "ViewRequirementAgentConnector_ms": 0.17246675491333008}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 96000, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2557.917, "sample_time_ms": 350.151, "load_time_ms": 0.637, "load_throughput": 2008420.605, "learn_time_ms": 2189.65, "learn_throughput": 584.568, "synch_weights_time_ms": 16.565}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 3676, "training_iteration": 75, "trial_id": "7d771_00000", "date": "2023-08-04_22-50-21", "timestamp": 1691203821, "time_this_iter_s": 5.688531875610352, "time_total_s": 978.1866507530212, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 978.1866507530212, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 69.8, "ram_util_percent": 19.6}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.893704, "episode_len_mean": 27.92, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9424, 0.946, 0.9532, 0.9532, 0.9424, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9424, 0.0, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9352, 0.9532, 0.9352, 0.0, 0.946, 0.9532, 0.9352], "episode_lengths": [14, 14, 16, 14, 14, 16, 13, 13, 13, 13, 13, 13, 250, 13, 13, 18, 13, 13, 13, 16, 15, 13, 13, 16, 13, 13, 250, 13, 13, 13, 15, 13, 13, 18, 13, 13, 15, 13, 13, 13, 13, 250, 16, 250, 15, 13, 13, 15, 13, 13, 15, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 18, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 18, 13, 18, 250, 15, 13, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3094761608113695, "mean_inference_ms": 0.9146100996768586, "mean_action_processing_ms": 0.09610824662438208, "mean_env_wait_ms": 0.31204879001740654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0048940181732177734, "ViewRequirementAgentConnector_ms": 0.145188570022583}, "clean_success_rate": 0.94, "poison_episode_reward_max": 0.9604, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.019208, "poison_episode_len_mean": 51.23, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9604, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9604, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 250, 13, 13, 13, 13, 11, 18, 13, 250, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 18, 250, 13, 13, 250, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 16, 13, 13, 13, 13, 13, 16, 13, 13, 13, 13, 13, 13, 13, 250, 16, 250, 250, 13, 13, 13, 13, 13, 13, 13, 18, 13, 18, 13, 13, 13, 250, 13, 13, 13, 250, 250, 13, 13, 11, 13, 13, 250, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30960592159781924, "mean_inference_ms": 0.9147733398392538, "mean_action_processing_ms": 0.09611730115140642, "mean_env_wait_ms": 0.3120801149647922, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004681825637817383, "ViewRequirementAgentConnector_ms": 0.15480804443359375}, "poison_success_rate": 0.02, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3080636332432429, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02652184521042121, "policy_loss": -0.038186347242444754, "vf_loss": 0.0013586919341469184, "vf_explained_var": 0.6618487906455993, "kl": 0.01017857957953917, "entropy": 0.26297550251086554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 11325.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.8452, "episode_reward_mean": 0.9413559999999999, "episode_len_mean": 16.29, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9244, 0.9532, 0.9244, 0.9532, 0.9532, 0.9424, 0.9208000000000001, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.9388, 0.9028, 0.9496, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.946, 0.9279999999999999, 0.9352, 0.9532, 0.9028, 0.946, 0.9532, 0.9532, 0.9172, 0.946, 0.874, 0.9388, 0.9208000000000001, 0.8452, 0.9028, 0.9532, 0.9532, 0.9532, 0.91, 0.8884, 0.9532, 0.9316, 0.9388, 0.9532, 0.9316, 0.9388, 0.9532, 0.9532, 0.946, 0.9244, 0.9532, 0.946, 0.9532, 0.9316, 0.9064, 0.9279999999999999, 0.9388, 0.9388, 0.9316, 0.9388, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [13, 13, 21, 13, 21, 13, 13, 16, 22, 13, 21, 13, 13, 13, 18, 17, 17, 27, 14, 13, 13, 13, 18, 13, 13, 13, 13, 18, 17, 15, 20, 18, 13, 27, 15, 13, 13, 23, 15, 35, 17, 22, 43, 27, 13, 13, 13, 25, 31, 13, 19, 17, 13, 19, 17, 13, 13, 15, 21, 13, 15, 13, 19, 26, 20, 17, 17, 19, 17, 15, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 23, 15, 13, 13, 13, 13, 13, 21, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4871860003835137, "mean_inference_ms": 1.2742338976753071, "mean_action_processing_ms": 0.12483172076752176, "mean_env_wait_ms": 0.36820878915376926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.010637760162353516, "ViewRequirementAgentConnector_ms": 0.1482245922088623}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.8452, "episode_reward_mean": 0.9413559999999999, "episode_len_mean": 16.29, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9244, 0.9532, 0.9244, 0.9532, 0.9532, 0.9424, 0.9208000000000001, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.9388, 0.9028, 0.9496, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.946, 0.9279999999999999, 0.9352, 0.9532, 0.9028, 0.946, 0.9532, 0.9532, 0.9172, 0.946, 0.874, 0.9388, 0.9208000000000001, 0.8452, 0.9028, 0.9532, 0.9532, 0.9532, 0.91, 0.8884, 0.9532, 0.9316, 0.9388, 0.9532, 0.9316, 0.9388, 0.9532, 0.9532, 0.946, 0.9244, 0.9532, 0.946, 0.9532, 0.9316, 0.9064, 0.9279999999999999, 0.9388, 0.9388, 0.9316, 0.9388, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [13, 13, 21, 13, 21, 13, 13, 16, 22, 13, 21, 13, 13, 13, 18, 17, 17, 27, 14, 13, 13, 13, 18, 13, 13, 13, 13, 18, 17, 15, 20, 18, 13, 27, 15, 13, 13, 23, 15, 35, 17, 22, 43, 27, 13, 13, 13, 25, 31, 13, 19, 17, 13, 19, 17, 13, 13, 15, 21, 13, 15, 13, 19, 26, 20, 17, 17, 19, 17, 15, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 23, 15, 13, 13, 13, 13, 13, 21, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4871860003835137, "mean_inference_ms": 1.2742338976753071, "mean_action_processing_ms": 0.12483172076752176, "mean_env_wait_ms": 0.36820878915376926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.010637760162353516, "ViewRequirementAgentConnector_ms": 0.1482245922088623}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 97280, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 97280, "timers": {"training_iteration_time_ms": 2542.1, "sample_time_ms": 348.848, "load_time_ms": 0.603, "load_throughput": 2121348.633, "learn_time_ms": 2173.427, "learn_throughput": 588.932, "synch_weights_time_ms": 18.302}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "done": false, "episodes_total": 3757, "training_iteration": 76, "trial_id": "7d771_00000", "date": "2023-08-04_22-50-30", "timestamp": 1691203830, "time_this_iter_s": 9.485050439834595, "time_total_s": 987.6717011928558, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 987.6717011928558, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 67.45714285714284, "ram_util_percent": 19.599999999999998}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.90428, "episode_len_mean": 25.26, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.0, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9424, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9424, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 18, 250, 15, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 16, 13, 13, 13, 13, 13, 250, 13, 13, 13, 18, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 16, 16, 13, 13, 13, 13, 13, 13, 13, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3097302153406312, "mean_inference_ms": 0.9149408206449485, "mean_action_processing_ms": 0.09613467394967248, "mean_env_wait_ms": 0.31212436907593666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004876136779785156, "ViewRequirementAgentConnector_ms": 0.1441488265991211}, "clean_success_rate": 0.95, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 86.79, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [16, 14, 14, 14, 14, 14, 13, 250, 13, 250, 250, 250, 13, 13, 13, 250, 250, 250, 250, 13, 250, 13, 13, 13, 13, 250, 13, 250, 13, 250, 250, 13, 13, 15, 250, 13, 250, 250, 13, 250, 250, 13, 13, 13, 13, 13, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 15, 13, 13, 250, 13, 13, 13, 13, 13, 250, 13, 13, 15, 250, 13, 13, 13, 13, 13, 13, 13, 19, 250, 13, 15, 250, 13, 250, 13, 250, 15, 13, 13, 13, 250, 15, 250, 13, 13, 250, 13, 13, 19, 13]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30971220788095954, "mean_inference_ms": 0.914760750971235, "mean_action_processing_ms": 0.09611573254948093, "mean_env_wait_ms": 0.3120842249402498, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0045888423919677734, "ViewRequirementAgentConnector_ms": 0.12491393089294434}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3335598536332448, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.011584940220539769, "policy_loss": -0.02801587207863728, "vf_loss": 0.008458459378064921, "vf_explained_var": 0.5532323245207469, "kl": 0.00787404703421392, "entropy": 0.2956726143757502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 11475.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 98560, "num_env_steps_trained": 98560, "num_agent_steps_sampled": 98560, "num_agent_steps_trained": 98560}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.89582, "episode_len_mean": 15.71, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9316, 0.9388, 0.9316, 0.91, 0.9532, 0.9532, 0.9532, 0.892, 0.9532, 0.946, 0.9388, 0.9136, 0.9388, 0.9172, 0.9244, 0.0, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9388, 0.9388, 0.946, 0.0, 0.9532, 0.946, 0.9208000000000001, 0.9532, 0.0, 0.9532, 0.9208000000000001, 0.9532, 0.8884, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9352, 0.9532, 0.946, 0.9316, 0.838, 0.0, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9172, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.0, 0.9244, 0.9352, 0.946, 0.9388, 0.9532, 0.9532, 0.9532, 0.9244], "episode_lengths": [13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 23, 15, 13, 13, 13, 13, 13, 21, 13, 13, 13, 13, 13, 13, 13, 17, 13, 13, 13, 17, 13, 13, 13, 13, 16, 19, 17, 19, 25, 13, 13, 13, 30, 13, 15, 17, 24, 17, 23, 21, 6, 13, 13, 17, 13, 13, 17, 17, 15, 13, 13, 15, 22, 13, 24, 13, 22, 13, 31, 13, 13, 13, 22, 18, 13, 15, 19, 45, 6, 13, 17, 15, 13, 13, 23, 13, 17, 13, 13, 13, 17, 21, 18, 15, 17, 13, 13, 13, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48716728892498556, "mean_inference_ms": 1.2729374735911057, "mean_action_processing_ms": 0.12501912946203525, "mean_env_wait_ms": 0.3678016269921227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.010604381561279297, "ViewRequirementAgentConnector_ms": 0.1675271987915039}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.89582, "episode_len_mean": 15.71, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9316, 0.9388, 0.9316, 0.91, 0.9532, 0.9532, 0.9532, 0.892, 0.9532, 0.946, 0.9388, 0.9136, 0.9388, 0.9172, 0.9244, 0.0, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9388, 0.9388, 0.946, 0.0, 0.9532, 0.946, 0.9208000000000001, 0.9532, 0.0, 0.9532, 0.9208000000000001, 0.9532, 0.8884, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9352, 0.9532, 0.946, 0.9316, 0.838, 0.0, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9172, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.0, 0.9244, 0.9352, 0.946, 0.9388, 0.9532, 0.9532, 0.9532, 0.9244], "episode_lengths": [13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 23, 15, 13, 13, 13, 13, 13, 21, 13, 13, 13, 13, 13, 13, 13, 17, 13, 13, 13, 17, 13, 13, 13, 13, 16, 19, 17, 19, 25, 13, 13, 13, 30, 13, 15, 17, 24, 17, 23, 21, 6, 13, 13, 17, 13, 13, 17, 17, 15, 13, 13, 15, 22, 13, 24, 13, 22, 13, 31, 13, 13, 13, 22, 18, 13, 15, 19, 45, 6, 13, 17, 15, 13, 13, 23, 13, 17, 13, 13, 13, 17, 21, 18, 15, 17, 13, 13, 13, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48716728892498556, "mean_inference_ms": 1.2729374735911057, "mean_action_processing_ms": 0.12501912946203525, "mean_env_wait_ms": 0.3678016269921227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.010604381561279297, "ViewRequirementAgentConnector_ms": 0.1675271987915039}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98560, "num_agent_steps_trained": 98560, "num_env_steps_sampled": 98560, "num_env_steps_trained": 98560, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 98560, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 98560, "timers": {"training_iteration_time_ms": 2516.804, "sample_time_ms": 356.758, "load_time_ms": 0.598, "load_throughput": 2141487.483, "learn_time_ms": 2142.179, "learn_throughput": 597.523, "synch_weights_time_ms": 16.537}, "counters": {"num_env_steps_sampled": 98560, "num_env_steps_trained": 98560, "num_agent_steps_sampled": 98560, "num_agent_steps_trained": 98560}, "done": false, "episodes_total": 3834, "training_iteration": 77, "trial_id": "7d771_00000", "date": "2023-08-04_22-50-41", "timestamp": 1691203841, "time_this_iter_s": 10.994438409805298, "time_total_s": 998.6661396026611, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 998.6661396026611, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 67.825, "ram_util_percent": 19.6}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.8659359999999999, "episode_len_mean": 34.8, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.946, 0.9532, 0.0, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.946, 0.9352, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.0, 0.9532, 0.9532, 0.946, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9424, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 18, 13, 18, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 250, 15, 13, 250, 15, 13, 250, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 250, 13, 15, 18, 13, 18, 13, 13, 13, 13, 13, 250, 250, 13, 13, 15, 13, 250, 13, 13, 13, 13, 13, 15, 13, 15, 13, 13, 16, 13, 13, 13, 13, 13, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3098254496501088, "mean_inference_ms": 0.9150627391101491, "mean_action_processing_ms": 0.09612891947545993, "mean_env_wait_ms": 0.3120739423460516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008335351943969727, "ViewRequirementAgentConnector_ms": 0.15964436531066895}, "clean_success_rate": 0.91, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 72.77, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 15, 13, 13, 15, 250, 13, 13, 250, 13, 13, 13, 250, 13, 15, 13, 250, 250, 15, 15, 13, 13, 13, 13, 250, 250, 250, 13, 250, 13, 250, 13, 250, 13, 13, 13, 13, 250, 250, 250, 19, 13, 13, 13, 15, 13, 250, 15, 13, 13, 250, 13, 250, 250, 13, 15, 13, 13, 13, 13, 13, 15, 15, 15, 13, 250, 13, 250, 250, 13, 13, 250, 19, 250, 13, 13, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 15, 250, 15, 13, 19, 15]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3099286082957233, "mean_inference_ms": 0.9152573998957533, "mean_action_processing_ms": 0.0961395282455317, "mean_env_wait_ms": 0.312092859114157, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0044634342193603516, "ViewRequirementAgentConnector_ms": 0.1337745189666748}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3015528166294098, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": 0.0022970026731491087, "policy_loss": -0.028853746751944225, "vf_loss": 0.021936919031043847, "vf_explained_var": 0.16004794518152873, "kl": 0.009100079387038326, "entropy": 0.3090705570578575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 99840, "num_env_steps_trained": 99840, "num_agent_steps_sampled": 99840, "num_agent_steps_trained": 99840}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.902148, "episode_len_mean": 16.93, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9316, 0.838, 0.0, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9172, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.0, 0.9244, 0.9352, 0.946, 0.9388, 0.9532, 0.9532, 0.9532, 0.9244, 0.9028, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9279999999999999, 0.9532, 0.9244, 0.8452, 0.9316, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.946, 0.946, 0.9424, 0.9136, 0.9532, 0.9136, 0.9532, 0.946, 0.9532, 0.946, 0.9388, 0.9388, 0.9279999999999999, 0.9388, 0.9279999999999999, 0.0, 0.9532, 0.9388, 0.8992, 0.9532, 0.9532, 0.8668, 0.9316, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.9532, 0.0, 0.9388, 0.91, 0.9532, 0.9532, 0.9532, 0.9388, 0.91, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9532, 0.9352, 0.9316, 0.946], "episode_lengths": [19, 45, 6, 13, 17, 15, 13, 13, 23, 13, 17, 13, 13, 13, 17, 21, 18, 15, 17, 13, 13, 13, 21, 27, 13, 13, 15, 15, 13, 20, 13, 21, 43, 19, 13, 21, 13, 13, 13, 18, 13, 13, 13, 20, 15, 15, 16, 24, 13, 24, 13, 15, 13, 15, 17, 17, 20, 17, 20, 25, 13, 17, 28, 13, 13, 37, 19, 13, 13, 13, 23, 15, 13, 38, 17, 25, 13, 13, 13, 17, 25, 13, 13, 13, 13, 17, 20, 13, 13, 13, 13, 13, 13, 22, 13, 13, 13, 18, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4869368793211487, "mean_inference_ms": 1.2727941019186526, "mean_action_processing_ms": 0.1251573310254407, "mean_env_wait_ms": 0.3678331648907695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004726409912109375, "ViewRequirementAgentConnector_ms": 0.18268942832946777}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.902148, "episode_len_mean": 16.93, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9316, 0.838, 0.0, 0.9532, 0.9388, 0.946, 0.9532, 0.9532, 0.9172, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.0, 0.9244, 0.9352, 0.946, 0.9388, 0.9532, 0.9532, 0.9532, 0.9244, 0.9028, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9279999999999999, 0.9532, 0.9244, 0.8452, 0.9316, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9279999999999999, 0.946, 0.946, 0.9424, 0.9136, 0.9532, 0.9136, 0.9532, 0.946, 0.9532, 0.946, 0.9388, 0.9388, 0.9279999999999999, 0.9388, 0.9279999999999999, 0.0, 0.9532, 0.9388, 0.8992, 0.9532, 0.9532, 0.8668, 0.9316, 0.9532, 0.9532, 0.9532, 0.9172, 0.946, 0.9532, 0.0, 0.9388, 0.91, 0.9532, 0.9532, 0.9532, 0.9388, 0.91, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9532, 0.9352, 0.9316, 0.946], "episode_lengths": [19, 45, 6, 13, 17, 15, 13, 13, 23, 13, 17, 13, 13, 13, 17, 21, 18, 15, 17, 13, 13, 13, 21, 27, 13, 13, 15, 15, 13, 20, 13, 21, 43, 19, 13, 21, 13, 13, 13, 18, 13, 13, 13, 20, 15, 15, 16, 24, 13, 24, 13, 15, 13, 15, 17, 17, 20, 17, 20, 25, 13, 17, 28, 13, 13, 37, 19, 13, 13, 13, 23, 15, 13, 38, 17, 25, 13, 13, 13, 17, 25, 13, 13, 13, 13, 17, 20, 13, 13, 13, 13, 13, 13, 22, 13, 13, 13, 18, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4869368793211487, "mean_inference_ms": 1.2727941019186526, "mean_action_processing_ms": 0.1251573310254407, "mean_env_wait_ms": 0.3678331648907695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004726409912109375, "ViewRequirementAgentConnector_ms": 0.18268942832946777}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99840, "num_agent_steps_trained": 99840, "num_env_steps_sampled": 99840, "num_env_steps_trained": 99840, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 99840, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 99840, "timers": {"training_iteration_time_ms": 2602.32, "sample_time_ms": 355.745, "load_time_ms": 0.565, "load_throughput": 2263845.296, "learn_time_ms": 2228.871, "learn_throughput": 574.282, "synch_weights_time_ms": 16.405}, "counters": {"num_env_steps_sampled": 99840, "num_env_steps_trained": 99840, "num_agent_steps_sampled": 99840, "num_agent_steps_trained": 99840}, "done": false, "episodes_total": 3911, "training_iteration": 78, "trial_id": "7d771_00000", "date": "2023-08-04_22-50-53", "timestamp": 1691203853, "time_this_iter_s": 11.503773927688599, "time_total_s": 1010.1699135303497, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1010.1699135303497, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 69.26875, "ram_util_percent": 19.6}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.942228, "episode_len_mean": 15.83, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.9496, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9352, 0.9496, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9532, 0.946, 0.9532, 0.946, 0.9424, 0.9532, 0.0, 0.9424, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 13, 13, 13, 13, 13, 13, 18, 13, 13, 18, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 16, 13, 15, 13, 15, 16, 13, 250, 16, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31006291397471375, "mean_inference_ms": 0.915501474438984, "mean_action_processing_ms": 0.09618597752465959, "mean_env_wait_ms": 0.3121888179591169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004912376403808594, "ViewRequirementAgentConnector_ms": 0.1479644775390625}, "clean_success_rate": 0.99, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 240.73, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 18, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 18, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 18, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 13, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3099607164929273, "mean_inference_ms": 0.9153418437446171, "mean_action_processing_ms": 0.09618350888302268, "mean_env_wait_ms": 0.3123641887540261, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004151344299316406, "ViewRequirementAgentConnector_ms": 0.11202096939086914}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.21420808700223765, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.02379690411190192, "policy_loss": -0.035521114245057106, "vf_loss": 0.004170384692843072, "vf_explained_var": 0.5672802670796713, "kl": 0.007460566436348018, "entropy": 0.3195443788170815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 11775.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 101120, "num_env_steps_trained": 101120, "num_agent_steps_sampled": 101120, "num_agent_steps_trained": 101120}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9331919999999999, "episode_len_mean": 15.88, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9388, 0.91, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9532, 0.9352, 0.9316, 0.946, 0.9388, 0.9532, 0.9316, 0.9532, 0.9172, 0.9316, 0.9424, 0.946, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9208000000000001, 0.9316, 0.9208000000000001, 0.9388, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.9388, 0.946, 0.8775999999999999, 0.9316, 0.0, 0.9316, 0.9532, 0.946, 0.9532, 0.9316, 0.9532, 0.9064, 0.9532, 0.9532, 0.8632, 0.9532, 0.9316, 0.9532, 0.9532, 0.9316, 0.9532, 0.946, 0.9532, 0.9244, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9172, 0.9424, 0.9424, 0.9532, 0.9532, 0.9532], "episode_lengths": [13, 13, 17, 25, 13, 13, 13, 13, 17, 20, 13, 13, 13, 13, 13, 13, 22, 13, 13, 13, 18, 19, 15, 17, 13, 19, 13, 23, 19, 16, 15, 20, 13, 13, 13, 13, 13, 13, 13, 30, 22, 19, 22, 17, 17, 20, 13, 13, 15, 13, 13, 13, 13, 22, 13, 15, 13, 13, 13, 13, 22, 13, 17, 15, 34, 19, 10, 19, 13, 15, 13, 19, 13, 26, 13, 13, 38, 13, 19, 13, 13, 19, 13, 15, 13, 21, 13, 13, 14, 13, 13, 13, 15, 13, 23, 16, 16, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48860761487965776, "mean_inference_ms": 1.2744254303247387, "mean_action_processing_ms": 0.12553109734745074, "mean_env_wait_ms": 0.3682871831614355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004666805267333984, "ViewRequirementAgentConnector_ms": 0.17412543296813965}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9331919999999999, "episode_len_mean": 15.88, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9388, 0.91, 0.9532, 0.9532, 0.9532, 0.9532, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.9532, 0.9532, 0.9352, 0.9316, 0.946, 0.9388, 0.9532, 0.9316, 0.9532, 0.9172, 0.9316, 0.9424, 0.946, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.892, 0.9208000000000001, 0.9316, 0.9208000000000001, 0.9388, 0.9388, 0.9279999999999999, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9208000000000001, 0.9532, 0.9388, 0.946, 0.8775999999999999, 0.9316, 0.0, 0.9316, 0.9532, 0.946, 0.9532, 0.9316, 0.9532, 0.9064, 0.9532, 0.9532, 0.8632, 0.9532, 0.9316, 0.9532, 0.9532, 0.9316, 0.9532, 0.946, 0.9532, 0.9244, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9172, 0.9424, 0.9424, 0.9532, 0.9532, 0.9532], "episode_lengths": [13, 13, 17, 25, 13, 13, 13, 13, 17, 20, 13, 13, 13, 13, 13, 13, 22, 13, 13, 13, 18, 19, 15, 17, 13, 19, 13, 23, 19, 16, 15, 20, 13, 13, 13, 13, 13, 13, 13, 30, 22, 19, 22, 17, 17, 20, 13, 13, 15, 13, 13, 13, 13, 22, 13, 15, 13, 13, 13, 13, 22, 13, 17, 15, 34, 19, 10, 19, 13, 15, 13, 19, 13, 26, 13, 13, 38, 13, 19, 13, 13, 19, 13, 15, 13, 21, 13, 13, 14, 13, 13, 13, 15, 13, 23, 16, 16, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48860761487965776, "mean_inference_ms": 1.2744254303247387, "mean_action_processing_ms": 0.12553109734745074, "mean_env_wait_ms": 0.3682871831614355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004666805267333984, "ViewRequirementAgentConnector_ms": 0.17412543296813965}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101120, "num_agent_steps_trained": 101120, "num_env_steps_sampled": 101120, "num_env_steps_trained": 101120, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 101120, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 101120, "timers": {"training_iteration_time_ms": 2643.25, "sample_time_ms": 354.642, "load_time_ms": 0.567, "load_throughput": 2259082.314, "learn_time_ms": 2270.683, "learn_throughput": 563.707, "synch_weights_time_ms": 16.616}, "counters": {"num_env_steps_sampled": 101120, "num_env_steps_trained": 101120, "num_agent_steps_sampled": 101120, "num_agent_steps_trained": 101120}, "done": false, "episodes_total": 3988, "training_iteration": 79, "trial_id": "7d771_00000", "date": "2023-08-04_22-51-09", "timestamp": 1691203869, "time_this_iter_s": 15.590165853500366, "time_total_s": 1025.76007938385, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1025.76007938385, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 67.47272727272728, "ram_util_percent": 19.60000000000001}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9232360000000002, "episode_len_mean": 20.55, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.0, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.946, 0.9532, 0.9424, 0.9352, 0.946], "episode_lengths": [14, 14, 16, 14, 14, 14, 13, 14, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 15, 13, 13, 13, 250, 13, 13, 13, 13, 250, 13, 13, 13, 13, 13, 13, 13, 13, 16, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 18, 13, 13, 15, 13, 16, 18, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3097804065054008, "mean_inference_ms": 0.9151424870133682, "mean_action_processing_ms": 0.09616654524159415, "mean_env_wait_ms": 0.3125546401340842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004868030548095703, "ViewRequirementAgentConnector_ms": 0.13591790199279785}, "clean_success_rate": 0.97, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 240.78, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 18, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 18, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 18, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 18, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.30962968284700776, "mean_inference_ms": 0.9152363599834671, "mean_action_processing_ms": 0.09616345004555268, "mean_env_wait_ms": 0.31266111552821324, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.004266977310180664, "ViewRequirementAgentConnector_ms": 0.11380600929260254}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2199935138473908, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.0219348381459713, "policy_loss": -0.03563668871919314, "vf_loss": 0.006190239126250769, "vf_explained_var": 0.41026245315869647, "kl": 0.007418875550162435, "entropy": 0.2938443998495738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 11925.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9247399999999999, "episode_len_mean": 15.56, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9316, 0.9532, 0.946, 0.9532, 0.9244, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9172, 0.9424, 0.9424, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.946, 0.9532, 0.8775999999999999, 0.946, 0.946, 0.91, 0.0, 0.0, 0.8775999999999999, 0.9279999999999999, 0.946, 0.892, 0.9532, 0.8956, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.946, 0.9424, 0.9244, 0.9172, 0.946, 0.9316, 0.946, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.946, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9244, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9064, 0.9244, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532], "episode_lengths": [19, 13, 15, 13, 21, 13, 13, 14, 13, 13, 13, 15, 13, 23, 16, 16, 13, 13, 13, 15, 15, 13, 15, 13, 34, 15, 15, 25, 16, 5, 34, 20, 15, 30, 13, 29, 20, 13, 13, 13, 15, 16, 21, 23, 15, 19, 15, 13, 13, 14, 13, 13, 13, 21, 13, 13, 13, 13, 15, 13, 15, 15, 15, 13, 13, 15, 13, 21, 13, 15, 13, 13, 13, 17, 13, 13, 26, 21, 13, 15, 13, 13, 15, 13, 15, 13, 15, 13, 13, 19, 13, 13, 13, 21, 13, 15, 13, 13, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48936748584246864, "mean_inference_ms": 1.2735841892130926, "mean_action_processing_ms": 0.12552489891582036, "mean_env_wait_ms": 0.36792450969408336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004573822021484375, "ViewRequirementAgentConnector_ms": 0.13689565658569336}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.0, "episode_reward_mean": 0.9247399999999999, "episode_len_mean": 15.56, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9316, 0.9532, 0.946, 0.9532, 0.9244, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9172, 0.9424, 0.9424, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.946, 0.9532, 0.8775999999999999, 0.946, 0.946, 0.91, 0.0, 0.0, 0.8775999999999999, 0.9279999999999999, 0.946, 0.892, 0.9532, 0.8956, 0.9279999999999999, 0.9532, 0.9532, 0.9532, 0.946, 0.9424, 0.9244, 0.9172, 0.946, 0.9316, 0.946, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.946, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9244, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9388, 0.9532, 0.9532, 0.9064, 0.9244, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532], "episode_lengths": [19, 13, 15, 13, 21, 13, 13, 14, 13, 13, 13, 15, 13, 23, 16, 16, 13, 13, 13, 15, 15, 13, 15, 13, 34, 15, 15, 25, 16, 5, 34, 20, 15, 30, 13, 29, 20, 13, 13, 13, 15, 16, 21, 23, 15, 19, 15, 13, 13, 14, 13, 13, 13, 21, 13, 13, 13, 13, 15, 13, 15, 15, 15, 13, 13, 15, 13, 21, 13, 15, 13, 13, 13, 17, 13, 13, 26, 21, 13, 15, 13, 13, 15, 13, 15, 13, 15, 13, 13, 19, 13, 13, 13, 21, 13, 15, 13, 13, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48936748584246864, "mean_inference_ms": 1.2735841892130926, "mean_action_processing_ms": 0.12552489891582036, "mean_env_wait_ms": 0.36792450969408336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004573822021484375, "ViewRequirementAgentConnector_ms": 0.13689565658569336}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 102400, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 102400, "timers": {"training_iteration_time_ms": 2662.717, "sample_time_ms": 351.579, "load_time_ms": 0.544, "load_throughput": 2353355.157, "learn_time_ms": 2285.83, "learn_throughput": 559.972, "synch_weights_time_ms": 24.023}, "counters": {"num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "done": false, "episodes_total": 4069, "training_iteration": 80, "trial_id": "7d771_00000", "date": "2023-08-04_22-51-25", "timestamp": 1691203885, "time_this_iter_s": 16.28862237930298, "time_total_s": 1042.048701763153, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1042.048701763153, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 68.51249999999999, "ram_util_percent": 19.6}}
{"evaluation": {"episode_reward_max": 0.9532, "episode_reward_min": 0.9352, "episode_reward_mean": 0.9515439999999998, "episode_len_mean": 13.52, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9496, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9496, 0.9532, 0.9532, 0.9532, 0.9532, 0.9496, 0.9496, 0.9532, 0.9352, 0.946, 0.9424, 0.9532, 0.946, 0.9532, 0.9532, 0.9496, 0.9532, 0.946, 0.9424, 0.9532, 0.9532, 0.9532, 0.9532, 0.9424, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9352, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532], "episode_lengths": [14, 14, 14, 14, 14, 14, 13, 13, 13, 14, 13, 13, 13, 13, 13, 18, 14, 15, 13, 13, 13, 13, 13, 13, 13, 15, 14, 13, 13, 13, 13, 14, 14, 13, 18, 15, 16, 13, 15, 13, 13, 14, 13, 15, 16, 13, 13, 13, 13, 16, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 15, 15, 13, 13, 13, 13, 13, 13, 13, 18, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3096035577627859, "mean_inference_ms": 0.915386493322271, "mean_action_processing_ms": 0.09616954197972712, "mean_env_wait_ms": 0.31283509554797023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.023429393768310547, "ViewRequirementAgentConnector_ms": 0.14160561561584473}, "clean_success_rate": 1.0, "poison_episode_reward_max": 0.0, "poison_episode_reward_min": 0.0, "poison_episode_reward_mean": 0.0, "poison_episode_len_mean": 250.06, "poison_episode_media": {}, "poison_episodes_this_iter": 100, "poison_policy_reward_min": {}, "poison_policy_reward_max": {}, "poison_policy_reward_mean": {}, "poison_custom_metrics": {}, "poison_hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [251, 251, 251, 251, 251, 251, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "poison_sampler_perf": {"mean_raw_obs_processing_ms": 0.3093707327171742, "mean_inference_ms": 0.9152558687718891, "mean_action_processing_ms": 0.09614954888252042, "mean_env_wait_ms": 0.3130009588103821, "mean_env_render_ms": 0.0}, "poison_num_faulty_episodes": 0, "poison_connector_metrics": {"StateBufferConnector_ms": 0.0040514469146728516, "ViewRequirementAgentConnector_ms": 0.10801863670349121}, "poison_success_rate": 0.0, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23560041124622028, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 0.0010000000000000002, "total_loss": -0.023230914001663525, "policy_loss": -0.032890468488136926, "vf_loss": 0.002133072628445613, "vf_explained_var": 0.6370561091105144, "kl": 0.00743356340030914, "entropy": 0.2807914933562279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 12075.5, "diff_num_grad_updates_vs_sampler_policy": 74.5}}, "num_env_steps_sampled": 103680, "num_env_steps_trained": 103680, "num_agent_steps_sampled": 103680, "num_agent_steps_trained": 103680}, "sampler_results": {"episode_reward_max": 0.9532, "episode_reward_min": 0.7552, "episode_reward_mean": 0.943012, "episode_len_mean": 15.83, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9244, 0.9136, 0.892, 0.9316, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.9532, 0.9352, 0.9388, 0.9388, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.946, 0.9316, 0.9532, 0.8848, 0.9532, 0.9244, 0.9388, 0.9388, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.8884, 0.9388, 0.946, 0.946, 0.9532, 0.9532, 0.946, 0.9279999999999999, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.946, 0.9352, 0.9424, 0.9532, 0.9244, 0.9279999999999999, 0.9352, 0.7552, 0.9532, 0.946, 0.9532, 0.9532, 0.946], "episode_lengths": [15, 13, 13, 15, 13, 15, 13, 15, 13, 13, 19, 13, 13, 13, 21, 13, 15, 13, 13, 15, 13, 21, 24, 30, 19, 13, 13, 13, 18, 17, 13, 18, 17, 17, 15, 13, 19, 13, 13, 15, 19, 13, 32, 13, 21, 17, 17, 13, 17, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 15, 13, 15, 13, 15, 13, 13, 13, 13, 13, 31, 17, 15, 15, 13, 13, 15, 20, 15, 13, 13, 13, 13, 13, 15, 13, 15, 15, 18, 16, 13, 21, 20, 18, 68, 13, 15, 13, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4889755759255163, "mean_inference_ms": 1.2726549822908222, "mean_action_processing_ms": 0.12500225766417436, "mean_env_wait_ms": 0.36790903730817115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.012093067169189453, "ViewRequirementAgentConnector_ms": 0.16120004653930664}}, "episode_reward_max": 0.9532, "episode_reward_min": 0.7552, "episode_reward_mean": 0.943012, "episode_len_mean": 15.83, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9316, 0.9532, 0.9532, 0.9532, 0.9244, 0.9532, 0.946, 0.9532, 0.9532, 0.946, 0.9532, 0.9244, 0.9136, 0.892, 0.9316, 0.9532, 0.9532, 0.9532, 0.9352, 0.9388, 0.9532, 0.9352, 0.9388, 0.9388, 0.946, 0.9532, 0.9316, 0.9532, 0.9532, 0.946, 0.9316, 0.9532, 0.8848, 0.9532, 0.9244, 0.9388, 0.9388, 0.9532, 0.9388, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.8884, 0.9388, 0.946, 0.946, 0.9532, 0.9532, 0.946, 0.9279999999999999, 0.946, 0.9532, 0.9532, 0.9532, 0.9532, 0.9532, 0.946, 0.9532, 0.946, 0.946, 0.9352, 0.9424, 0.9532, 0.9244, 0.9279999999999999, 0.9352, 0.7552, 0.9532, 0.946, 0.9532, 0.9532, 0.946], "episode_lengths": [15, 13, 13, 15, 13, 15, 13, 15, 13, 13, 19, 13, 13, 13, 21, 13, 15, 13, 13, 15, 13, 21, 24, 30, 19, 13, 13, 13, 18, 17, 13, 18, 17, 17, 15, 13, 19, 13, 13, 15, 19, 13, 32, 13, 21, 17, 17, 13, 17, 13, 13, 13, 13, 15, 13, 13, 13, 13, 13, 13, 15, 13, 15, 13, 15, 13, 13, 13, 13, 13, 31, 17, 15, 15, 13, 13, 15, 20, 15, 13, 13, 13, 13, 13, 15, 13, 15, 15, 18, 16, 13, 21, 20, 18, 68, 13, 15, 13, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4889755759255163, "mean_inference_ms": 1.2726549822908222, "mean_action_processing_ms": 0.12500225766417436, "mean_env_wait_ms": 0.36790903730817115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.012093067169189453, "ViewRequirementAgentConnector_ms": 0.16120004653930664}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103680, "num_agent_steps_trained": 103680, "num_env_steps_sampled": 103680, "num_env_steps_trained": 103680, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 103680, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 103680, "timers": {"training_iteration_time_ms": 2697.452, "sample_time_ms": 363.404, "load_time_ms": 0.565, "load_throughput": 2266808.445, "learn_time_ms": 2308.473, "learn_throughput": 554.479, "synch_weights_time_ms": 24.371}, "counters": {"num_env_steps_sampled": 103680, "num_env_steps_trained": 103680, "num_agent_steps_sampled": 103680, "num_agent_steps_trained": 103680}, "done": true, "episodes_total": 4148, "training_iteration": 81, "trial_id": "7d771_00000", "date": "2023-08-04_22-51-40", "timestamp": 1691203900, "time_this_iter_s": 15.337311029434204, "time_total_s": 1057.3860127925873, "pid": 3590313, "hostname": "pn125918.nist.gov", "node_ip": "129.6.18.110", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "RandomizedLavaWorld", "env_config": {"cfg": {"size": 9, "num_lava_squares": 1, "observation_mode": "simple", "trigger": "multiplier", "poisoned": false, "max_steps": 250}, "poison_cfg": {"size": 9, "max_steps": 250, "poisoned": true, "trigger": "multiplier", "num_lava_squares": 1, "force_trigger_pattern": true, "observation_mode": "simple", "simple_poison_constant": 14, "mod_by_constant": 256, "brighten_poison_percent": 0.2, "top_mid_box_value": 255, "top_left_corner_value": 128, "top_left_corner_size": 10}, "pretrain_cfg": {"size": 7, "num_lava_squares": 5, "observation_mode": "simple", "max_steps": 250}, "num_clean": 10, "no_transfer": true, "transfer_avg_reward_thresh": 0.95, "clean_only": true, "clean_success_threshold": 1.0, "poison_success_threshold": 0.9, "clean_avg_threshold": 0.9, "intentional_poison_success_threshold": 1.0, "max_timesteps": 50000000, "wrapper_obs_mode": "simple"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.001, "train_batch_size": 1280, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FCModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "linear_embedding_dims": [512, 256], "actor_linear_mid_dims": [64, 32], "critic_linear_mid_dims": [64, 32]}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.2, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=1.0, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 50, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 5, "always_attach_evaluation_results": true, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc8a3593250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'trojai_rlgen.modelgen.tools.lava_world_tools.MyRLLibCallback'>", "create_env_on_driver": true, "custom_eval_function": "<function custom_eval_func at 0x7fc8a3590550>", "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1057.3860127925873, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 68.58095238095237, "ram_util_percent": 19.600000000000005}}
